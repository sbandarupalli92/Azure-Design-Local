{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Nikhil Tripathi - v-ntripathi@microsoft.com",
    "comments": "Solution template for AtlassianJiraAudit"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Sentinel is setup"
      }
    },
    "formattedTimeNow": {
      "type": "string",
      "defaultValue": "[utcNow('g')]",
      "metadata": {
        "description": "Appended to workbook displayNames to make them unique"
      }
    },
    "workbook1-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the workbook"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "AtlassianJiraAudit",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "analytic1-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic2-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic3-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic4-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic5-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic6-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic7-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic8-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic9-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic10-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "connector1-name": {
      "type": "string",
      "defaultValue": "e1f832af-4409-4b22-a995-741e76471f32"
    }
  },
  "variables": {
    "AtlassianJiraAudit_workbook": "AtlassianJiraAudit_workbook",
    "_AtlassianJiraAudit_workbook": "[variables('AtlassianJiraAudit_workbook')]",
    "workbook-source": "[concat(resourceGroup().id, '/providers/Microsoft.OperationalInsights/workspaces/',parameters('workspace'))]",
    "_workbook-source": "[variables('workbook-source')]",
    "JiraGlobalPermissionAdded_AnalyticalRules": "JiraGlobalPermissionAdded_AnalyticalRules",
    "_JiraGlobalPermissionAdded_AnalyticalRules": "[variables('JiraGlobalPermissionAdded_AnalyticalRules')]",
    "JiraNewPrivilegedUser_AnalyticalRules": "JiraNewPrivilegedUser_AnalyticalRules",
    "_JiraNewPrivilegedUser_AnalyticalRules": "[variables('JiraNewPrivilegedUser_AnalyticalRules')]",
    "JiraNewUser_AnalyticalRules": "JiraNewUser_AnalyticalRules",
    "_JiraNewUser_AnalyticalRules": "[variables('JiraNewUser_AnalyticalRules')]",
    "JiraPermissionSchemeUpdated_AnalyticalRules": "JiraPermissionSchemeUpdated_AnalyticalRules",
    "_JiraPermissionSchemeUpdated_AnalyticalRules": "[variables('JiraPermissionSchemeUpdated_AnalyticalRules')]",
    "JiraPrivilegedUserPasswordChanged_AnalyticalRules": "JiraPrivilegedUserPasswordChanged_AnalyticalRules",
    "_JiraPrivilegedUserPasswordChanged_AnalyticalRules": "[variables('JiraPrivilegedUserPasswordChanged_AnalyticalRules')]",
    "JiraProjectRolesChanged_AnalyticalRules": "JiraProjectRolesChanged_AnalyticalRules",
    "_JiraProjectRolesChanged_AnalyticalRules": "[variables('JiraProjectRolesChanged_AnalyticalRules')]",
    "JiraUserPasswordChange_AnalyticalRules": "JiraUserPasswordChange_AnalyticalRules",
    "_JiraUserPasswordChange_AnalyticalRules": "[variables('JiraUserPasswordChange_AnalyticalRules')]",
    "JiraUserRemovedFromGroup_AnalyticalRules": "JiraUserRemovedFromGroup_AnalyticalRules",
    "_JiraUserRemovedFromGroup_AnalyticalRules": "[variables('JiraUserRemovedFromGroup_AnalyticalRules')]",
    "JiraUserRemovedFromProject_AnalyticalRules": "JiraUserRemovedFromProject_AnalyticalRules",
    "_JiraUserRemovedFromProject_AnalyticalRules": "[variables('JiraUserRemovedFromProject_AnalyticalRules')]",
    "JiraWorkflowSchemeCopied_AnalyticalRules": "JiraWorkflowSchemeCopied_AnalyticalRules",
    "_JiraWorkflowSchemeCopied_AnalyticalRules": "[variables('JiraWorkflowSchemeCopied_AnalyticalRules')]",
    "JiraBlockedTasks_HuntingQueries": "JiraBlockedTasks_HuntingQueries",
    "_JiraBlockedTasks_HuntingQueries": "[variables('JiraBlockedTasks_HuntingQueries')]",
    "workspace-dependency": "[concat('Microsoft.OperationalInsights/workspaces/', parameters('workspace'))]",
    "JiraNewUsers_HuntingQueries": "JiraNewUsers_HuntingQueries",
    "_JiraNewUsers_HuntingQueries": "[variables('JiraNewUsers_HuntingQueries')]",
    "JiraProjectVersionsReleased_HuntingQueries": "JiraProjectVersionsReleased_HuntingQueries",
    "_JiraProjectVersionsReleased_HuntingQueries": "[variables('JiraProjectVersionsReleased_HuntingQueries')]",
    "JiraUpdatedProjectVersions_HuntingQueries": "JiraUpdatedProjectVersions_HuntingQueries",
    "_JiraUpdatedProjectVersions_HuntingQueries": "[variables('JiraUpdatedProjectVersions_HuntingQueries')]",
    "JiraUpdatedProjects_HuntingQueries": "JiraUpdatedProjects_HuntingQueries",
    "_JiraUpdatedProjects_HuntingQueries": "[variables('JiraUpdatedProjects_HuntingQueries')]",
    "JiraUpdatedUsers_HuntingQueries": "JiraUpdatedUsers_HuntingQueries",
    "_JiraUpdatedUsers_HuntingQueries": "[variables('JiraUpdatedUsers_HuntingQueries')]",
    "JiraUpdatedWorkflowSchemes_HuntingQueries": "JiraUpdatedWorkflowSchemes_HuntingQueries",
    "_JiraUpdatedWorkflowSchemes_HuntingQueries": "[variables('JiraUpdatedWorkflowSchemes_HuntingQueries')]",
    "JiraUpdatedWorkflows_HuntingQueries": "JiraUpdatedWorkflows_HuntingQueries",
    "_JiraUpdatedWorkflows_HuntingQueries": "[variables('JiraUpdatedWorkflows_HuntingQueries')]",
    "JiraUserIPs_HuntingQueries": "JiraUserIPs_HuntingQueries",
    "_JiraUserIPs_HuntingQueries": "[variables('JiraUserIPs_HuntingQueries')]",
    "JiraWorkflowAddedToProject_HuntingQueries": "JiraWorkflowAddedToProject_HuntingQueries",
    "_JiraWorkflowAddedToProject_HuntingQueries": "[variables('JiraWorkflowAddedToProject_HuntingQueries')]",
    "connector1-source": "[concat('/subscriptions/',subscription().subscriptionId,'/resourceGroups/',resourceGroup().name,'/providers/Microsoft.OperationalInsights/workspaces/',parameters('workspace'),'/providers/Microsoft.SecurityInsights/dataConnectors/',parameters('connector1-name'))]",
    "_connector1-source": "[variables('connector1-source')]",
    "Connector": "Connector",
    "_Connector": "[variables('Connector')]",
    "sourceId": "azuresentinel.azure-sentinel-solution-atlassianjiraaudit",
    "_sourceId": "[variables('sourceId')]"
  },
  "resources": [
    {
      "type": "Microsoft.Insights/workbooks",
      "name": "[parameters('workbook1-id')]",
      "location": "[parameters('workspace-location')]",
      "kind": "shared",
      "apiVersion": "2020-02-12",
      "properties": {
        "displayName": "[concat(parameters('workbook1-name'), ' - ', parameters('formattedTimeNow'))]",
        "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"**NOTE**: This data connector depends on a parser based on Kusto Function **JiraAudit** to work as expected. [Follow steps to get this Kusto Function](https://aka.ms/sentinel-jiraauditapi-parser)\"},\"name\":\"text - 8\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"cd8447d9-b096-4673-92d8-2a1e8291a125\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"description\":\"Sets the time name for analysis\",\"value\":{\"durationMs\":2592000000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":900000},{\"durationMs\":3600000},{\"durationMs\":86400000},{\"durationMs\":604800000},{\"durationMs\":2592000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 11\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\r\\n| make-series TotalEvents = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain};\",\"size\":0,\"title\":\"Events Over Time\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\",\"graphSettings\":{\"type\":0}},\"customWidth\":\"55\",\"name\":\"query - 12\",\"styleSettings\":{\"maxWidth\":\"55\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\r\\n| where isnotempty(EventCategoryType) \\r\\n| summarize count() by EventCategoryType\\r\\n| join kind = inner (JiraAudit \\r\\n                    | make-series Trend = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain} by EventCategoryType) on EventCategoryType\\r\\n| project-away EventCategoryType1, TimeGenerated\\r\\n| project count_, EventCategory = case(EventCategoryType =~ 'user management', 'User Management',\\r\\n                                EventCategoryType =~ 'projects', 'Projects Management',\\r\\n                                EventCategoryType =~ 'group management', 'Group Management',\\r\\n                                EventCategoryType =~ 'workflows', 'Workflow Management',\\r\\n                                EventCategoryType =~ 'permissions', 'Permissions Management',\\r\\n                                EventCategoryType =~ 'status', 'Task Status',\\r\\n                                'Other'), Trend\\r\\n\",\"size\":3,\"title\":\"Event Categories\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"EventCategory\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"secondaryContent\":{\"columnMatch\":\"Trend\",\"formatter\":21,\"formatOptions\":{\"palette\":\"blue\"}},\"showBorder\":false}},\"customWidth\":\"30\",\"name\":\"query - 0\",\"styleSettings\":{\"maxWidth\":\"30\"}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\r\\n| where EventCategoryType =~ 'projects'\\r\\n| where ObjectItemTypeName =~ 'PROJECT'\\r\\n| summarize dcount(ObjectItemName)\",\"size\":3,\"title\":\"Projects\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"card\",\"tileSettings\":{\"showBorder\":false},\"graphSettings\":{\"type\":0},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"DstPortNumber\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"DstPortNumber\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"DstPortNumber\",\"heatmapPalette\":\"greenRed\"}},\"textSettings\":{\"style\":\"bignumber\"}},\"name\":\"query - 14\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\r\\n| where EventCategoryType =~ 'workflows'\\r\\n| where ObjectItemTypeName =~ 'WORKFLOW'\\r\\n| summarize dcount(ObjectItemName)\\r\\n\",\"size\":3,\"title\":\"Workflows\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"card\",\"textSettings\":{\"style\":\"bignumber\"}},\"name\":\"query - 12\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\n| where isnotempty(UserName)\\n| summarize dcount(UserName)\",\"size\":3,\"title\":\"Users\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"card\",\"textSettings\":{\"style\":\"bignumber\"}},\"name\":\"query - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\n| count\",\"size\":3,\"title\":\"Operations\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"card\",\"textSettings\":{\"style\":\"bignumber\"}},\"name\":\"query - 3\"}]},\"customWidth\":\"15\",\"name\":\"group - 13\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\r\\n| where isnotempty(EventMessage) \\r\\n| summarize count() by EventMessage\\r\\n\",\"size\":3,\"title\":\"Event types\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"EventMessage\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}}},\"customWidth\":\"27\",\"name\":\"query - 3\",\"styleSettings\":{\"margin\":\"10\",\"padding\":\"10\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"  JiraAudit\\r\\n  | where isnotempty(SrcIpAddr) \\r\\n  | summarize count() by SrcIpAddr\\r\\n  | top 10 by SrcIpAddr\",\"size\":3,\"title\":\"Top sources\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"27\",\"name\":\"query - 9\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\r\\n| where isnotempty(UserName) \\r\\n| summarize count() by UserName, EventMessage\\r\\n| project User=UserName, Operation=EventMessage, EventCount=count_\\r\\n\",\"size\":0,\"title\":\"User activity\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"customWidth\":\"46\",\"name\":\"query - 15\",\"styleSettings\":{\"maxWidth\":\"30\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\r\\n| where isnotempty(UserName)\\r\\n| where isnotempty(SrcIpAddr) \\r\\n| summarize IPAddresses = makeset(SrcIpAddr) by UserName\\r\\n\",\"size\":0,\"title\":\"Document types\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"customWidth\":\"35\",\"name\":\"query - 10\",\"styleSettings\":{\"maxWidth\":\"30\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\r\\n| where EventCategoryType =~ 'projects'\\r\\n| where ObjectItemTypeName =~ 'PROJECT'\\r\\n| summarize count() by ObjectItemName\",\"size\":0,\"title\":\"Top projects\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"customWidth\":\"55\",\"name\":\"query - 13\",\"styleSettings\":{\"maxWidth\":\"50\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\r\\n| where EventCategoryType =~ 'workflows'\\r\\n| where ObjectItemTypeName =~ 'WORKFLOW'\\r\\n| summarize count() by ObjectItemName\\r\\n\",\"size\":3,\"title\":\"Workflows by activity\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"gridSettings\":{\"rowLimit\":100,\"filter\":true}},\"customWidth\":\"30\",\"name\":\"query - 12\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\n| where isnotempty(UserName) \\n| summarize count() by UserName\",\"size\":3,\"title\":\"Users' activity\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"30\",\"name\":\"query - 11\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"JiraAudit\\n| where isnotempty(UserName) \\n| summarize count() by UserName\\n| order by count_\\n| project User=UserName, EventCount=count_\",\"size\":0,\"title\":\"Events by user\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"customWidth\":\"40\",\"name\":\"query - 12\"}],\"fromTemplateId\":\"sentinel-AtlasianJiraAuditWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
        "version": "1.0",
        "sourceId": "[variables('_workbook-source')]",
        "category": "sentinel"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic1-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when global permission added.",
        "displayName": "Jira - Global permission added",
        "enabled": false,
        "query": "JiraAudit\n| where EventMessage =~ 'Global permission added'\n| project EventCreationTime, ObjectItemName, UserName, SrcIpAddr, ChangedValues\n| extend AccountCustomEntity = UserName, IPCustomEntity = SrcIpAddr\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "PrivilegeEscalation"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          },
          {
            "entityType": "IP",
            "fieldMappings": [
              {
                "identifier": "Address",
                "columnName": "IPCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic2-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects new site admin user.",
        "displayName": "Jira - New site admin user",
        "enabled": false,
        "query": "JiraAudit\n| where EventMessage =~ 'User added to group'\n| where ObjectItemName =~ 'site-admins'\n| extend user = todynamic(AssociatedItems)[0]['name']\n| extend AccountCustomEntity = user\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "Persistence",
          "PrivilegeEscalation"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic3-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when new user was created.",
        "displayName": "Jira - New user created",
        "enabled": false,
        "query": "JiraAudit\n| where EventMessage =~ 'User created'\n| where ObjectItemTypeName =~ 'USER'\n| project EventCreationTime, UserName, SrcIpAddr, ObjectItemName, AssociatedItems\n| extend AccountCustomEntity = ObjectItemName\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "Persistence"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic4-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when permission scheme was updated.",
        "displayName": "Jira - Permission scheme updated",
        "enabled": false,
        "query": "JiraAudit\n| where EventMessage =~ 'Permission scheme updated'\n| project EventCreationTime, ObjectItemName, UserName, SrcIpAddr, ChangedValues\n| extend AccountCustomEntity = UserName, IPCustomEntity = SrcIpAddr\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "Impact"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          },
          {
            "entityType": "IP",
            "fieldMappings": [
              {
                "identifier": "Address",
                "columnName": "IPCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic5-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects new site admin user.",
        "displayName": "Jira - New site admin user",
        "enabled": false,
        "query": "let priv_users = JiraAudit\n| where EventMessage =~ 'User added to group'\n| where ObjectItemName =~ 'site-admins'\n| extend user = todynamic(AssociatedItems)[0]['name']\n| summarize makeset(user);\nJiraAudit\n| where EventMessage =~ \"User's password changed\"\n| extend user = todynamic(AssociatedItems)[0]['name']\n| where user in (priv_users)\n| extend AccountCustomEntity = user\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "P14D",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "InitialAccess"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic6-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when project roles were changed.",
        "displayName": "Jira - Project roles changed",
        "enabled": false,
        "query": "JiraAudit\n| where EventMessage =~ 'Project roles changed'\n| project EventCreationTime, ObjectItemName, UserName, SrcIpAddr, AssociatedItems\n| extend AccountCustomEntity = UserName, IPCustomEntity = SrcIpAddr\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "Impact"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          },
          {
            "entityType": "IP",
            "fieldMappings": [
              {
                "identifier": "Address",
                "columnName": "IPCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic7-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when user's password was changed.",
        "displayName": "Jira - User's password changed",
        "enabled": false,
        "query": "JiraAudit\n| where EventMessage =~ \"User's password changed\"\n| extend user = todynamic(AssociatedItems)[0]['name']\n| extend AccountCustomEntity = user, IPCustomEntity = SrcIpAddr\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "Persistence"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          },
          {
            "entityType": "IP",
            "fieldMappings": [
              {
                "identifier": "Address",
                "columnName": "IPCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic8-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when a user was removed from group.",
        "displayName": "Jira - User removed from group",
        "enabled": false,
        "query": "JiraAudit\n| where EventMessage =~ 'User removed from group'\n| extend user = todynamic(AssociatedItems)[0]['name']\n| project EventCreationTime, ObjectItemName, user\n| extend AccountCustomEntity = user\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "Impact"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic9-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when a user was removed from project.",
        "displayName": "Jira - User removed from project",
        "enabled": false,
        "query": "JiraAudit\n| where EventMessage =~ 'User removed from project'\n| extend user = todynamic(AssociatedItems)[0]['name']\n| project EventCreationTime, ObjectItemName, user\n| extend AccountCustomEntity = user\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "Impact"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic10-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when workflow scheme was copied.",
        "displayName": "Jira - Workflow scheme copied",
        "enabled": false,
        "query": "JiraAudit\n| where EventMessage =~ 'Workflow scheme copied'\n| extend workflow = todynamic(AssociatedItems)[0]['name']\n| project EventCreationTime, ObjectItemName, UserName, SrcIpAddr, workflow\n| extend AccountCustomEntity = UserName, IPCustomEntity = SrcIpAddr\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "Collection"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          },
          {
            "entityType": "IP",
            "fieldMappings": [
              {
                "identifier": "Address",
                "columnName": "IPCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces",
      "apiVersion": "2020-08-01",
      "name": "[parameters('workspace')]",
      "location": "[parameters('workspace-location')]",
      "resources": [
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "AtlassianJiraAudit Hunting Query 1",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Jira - Blocked tasks",
            "category": "Hunting Queries",
            "query": "JiraAudit\n| where TimeGenerated > ago(24h)\n| where EventMessage in ('Status updated', 'Status created')\n| where ObjectItemTypeName =~ 'STATUS'\n| where ObjectItemName =~ 'Blocked'\n| extend ProcessCustomEntity = ObjectItemName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for blocked tasks."
              },
              {
                "name": "tactics",
                "value": "Impact"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "AtlassianJiraAudit Hunting Query 2",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Jira - New users",
            "category": "Hunting Queries",
            "query": "JiraAudit\n| where TimeGenerated > ago(24h)\n| where EventMessage =~ 'User created'\n| where ObjectItemTypeName =~ 'USER'\n| project EventCreationTime, UserName, SrcIpAddr, ObjectItemName, AssociatedItems\n| extend AccountCustomEntity = ObjectItemName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for new users created."
              },
              {
                "name": "tactics",
                "value": "Persistence"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "AtlassianJiraAudit Hunting Query 3",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Jira - Project versions released",
            "category": "Hunting Queries",
            "query": "JiraAudit\n| where TimeGenerated > ago(24h)\n| where EventMessage =~ 'Project version released'\n| project EventCreationTime, UserName, ObjectItemName, AssociatedItems\n| extend AccountCustomEntity = UserName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for project versions released."
              },
              {
                "name": "tactics",
                "value": "Impact"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "AtlassianJiraAudit Hunting Query 4",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Jira - Project versions",
            "category": "Hunting Queries",
            "query": "JiraAudit\n| where TimeGenerated > ago(24h)\n| where EventMessage =~ 'Project version created'\n| project EventCreationTime, UserName, SrcIpAddr, ObjectItemName, ChangedValues, AssociatedItems\n| extend AccountCustomEntity = UserName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for project versions."
              },
              {
                "name": "tactics",
                "value": "Impact"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "AtlassianJiraAudit Hunting Query 5",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Jira - Updated projects",
            "category": "Hunting Queries",
            "query": "JiraAudit\n| where TimeGenerated > ago(24h)\n| where EventMessage =~ 'Project updated'\n| project EventCreationTime, UserName, SrcIpAddr, ObjectItemName, ChangedValues, AssociatedItems\n| extend AccountCustomEntity = UserName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for updated projects."
              },
              {
                "name": "tactics",
                "value": "Impact"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "AtlassianJiraAudit Hunting Query 6",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Jira - Updated users",
            "category": "Hunting Queries",
            "query": "JiraAudit\n| where TimeGenerated > ago(24h)\n| where EventMessage =~ 'User updated'\n| project EventCreationTime, ObjectItemName, ChangedValues, AssociatedItems\n| extend AccountCustomEntity = ObjectItemName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for updated users."
              },
              {
                "name": "tactics",
                "value": "PrivilegeEscalation,Impact"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "AtlassianJiraAudit Hunting Query 7",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Jira - Updated workflow schemes",
            "category": "Hunting Queries",
            "query": "JiraAudit\n| where TimeGenerated > ago(24h)\n| where EventMessage =~ 'Workflow scheme updated'\n| project EventCreationTime, UserName, SrcIpAddr, ObjectItemName\n| extend AccountCustomEntity = UserName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for updated workflow schemes."
              },
              {
                "name": "tactics",
                "value": "Impact"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "AtlassianJiraAudit Hunting Query 8",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Jira - Updated workflows",
            "category": "Hunting Queries",
            "query": "JiraAudit\n| where TimeGenerated > ago(24h)\n| where EventMessage =~ 'Workflow updated'\n| project EventCreationTime, UserName, SrcIpAddr, ObjectItemName, ChangedValues\n| extend AccountCustomEntity = UserName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for updated workflows."
              },
              {
                "name": "tactics",
                "value": "Impact"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "AtlassianJiraAudit Hunting Query 9",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Jira - Users' IP addresses",
            "category": "Hunting Queries",
            "query": "JiraAudit\n| where TimeGenerated > ago(24h)\n| where isnotempty(SrcIpAddr)\n| where isnotempty(USerName)\n| summarize ip_list = makeset(SrcIpAddr) by UserName\n| extend AccountCustomEntity = UserName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for users' IP addresses."
              },
              {
                "name": "tactics",
                "value": "Persistence"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "AtlassianJiraAudit Hunting Query 10",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Jira - Workflow schemes added to projects",
            "category": "Hunting Queries",
            "query": "JiraAudit\n| where TimeGenerated > ago(24h)\n| where EventMessage =~ 'Workflow scheme added to project'\n| project EventCreationTime, UserName, ObjectItemName, AssociatedItems\n| extend AccountCustomEntity = UserName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for workflow schemes added to projects."
              },
              {
                "name": "tactics",
                "value": "Impact"
              }
            ]
          }
        }
      ]
    },
    {
      "id": "[variables('_connector1-source')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('connector1-name'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "APIPolling",
      "properties": {
        "connectorUiConfig": {
          "title": "Atlassian Jira",
          "publisher": "Atlassian",
          "descriptionMarkdown": "The Atlassian Jira data connector provides the capability to ingest [Atlassian Jira audit logs](https://developer.atlassian.com/cloud/jira/platform/rest/v3/api-group-audit-records/) into Azure Sentinel.",
          "graphQueriesTableName": "AtlassianJiraNativePoller_CL",
          "graphQueries": [
            {
              "metricName": "Total data received",
              "legend": "Atlassian Jira audit logs",
              "baseQuery": "{{graphQueriesTableName}}"
            }
          ],
          "sampleQueries": [
            {
              "description": "All Atlassian Jira audit logs",
              "query": "{{graphQueriesTableName}}\n| sort by TimeGenerated desc"
            }
          ],
          "dataTypes": [
            {
              "name": "{{graphQueriesTableName}}",
              "lastDataReceivedQuery": "{{graphQueriesTableName}}\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriteria": [
            {
              "type": "SentinelKindsV2",
              "value": []
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": true
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key)",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Atlassian Jira API credentials",
                "description": "Jira Username and Jira Access Token are required. [See the documentation to learn more about Atlassian Jira API](https://developer.atlassian.com/cloud/jira/platform/rest/v3/intro/#about). Jira domain must be provided as well."
              }
            ]
          },
          "instructionSteps": [
            {
              "title": "Connect Atlassian Jira",
              "description": "Please insert your credentials",
              "instructions": [
                {
                  "parameters": {
                    "enable": "true",
                    "userRequestPlaceHoldersInput": [
                      {
                        "displayText": "Domain Name",
                        "requestObjectKey": "apiEndpoint",
                        "placeHolderName": "{{domain}}",
                        "placeHolderValue": "<<Domain Name>>"
                      }
                    ]
                  },
                  "type": "BasicAuth"
                }
              ]
            }
          ]
        },
        "pollingConfig": {
          "auth": {
            "authType": "Basic"
          },
          "request": {
            "apiEndpoint": "https://{{domain}}/rest/api/3/auditing/record",
            "httpMethod": "Get",
            "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
            "startTimeAttributeName": "from",
            "endTimeAttributeName": "to",
            "queryWindowInMin": 5
          },
          "paging": {
            "pagingType": "Offset",
            "offsetParaName": "offset",
            "pageSizeParaName": "limit",
            "pageSize": 1000
          },
          "response": {
            "eventsJsonPaths": [
              "$..records"
            ]
          }
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2021-03-01-preview",
      "properties": {
        "version": "1.0.1",
        "kind": "Solution",
        "contentId": "[variables('_sourceId')]",
        "parentId": "[variables('_sourceId')]",
        "source": {
          "kind": "Solution",
          "name": "AtlassianJiraAudit",
          "sourceId": "[variables('_sourceId')]"
        },
        "author": {
          "name": "Nikhil Tripathi",
          "email": "v-ntripathi@microsoft.com"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "Workbook",
              "contentId": "[variables('_AtlassianJiraAudit_workbook')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_JiraGlobalPermissionAdded_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_JiraNewPrivilegedUser_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_JiraNewUser_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_JiraPermissionSchemeUpdated_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_JiraPrivilegedUserPasswordChanged_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_JiraProjectRolesChanged_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_JiraUserPasswordChange_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_JiraUserRemovedFromGroup_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_JiraUserRemovedFromProject_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_JiraWorkflowSchemeCopied_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_JiraBlockedTasks_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_JiraNewUsers_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_JiraProjectVersionsReleased_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_JiraUpdatedProjectVersions_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_JiraUpdatedProjects_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_JiraUpdatedUsers_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_JiraUpdatedWorkflowSchemes_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_JiraUpdatedWorkflows_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_JiraUserIPs_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_JiraWorkflowAddedToProject_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_Connector')]",
              "version": "1.0.1"
            }
          ]
        },
        "firstPublishDate": "2022-01-10",
        "providers": [
          "Application"
        ],
        "categories": {
          "domains": [
            "DevOps"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_sourceId'))]"
    }
  ],
  "outputs": {}
}
