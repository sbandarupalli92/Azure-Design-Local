{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Sanmit Biraj - v-sabiraj@microsoft.com",
    "comments": "Solution template for SentinelOne"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Sentinel is setup"
      }
    },
    "formattedTimeNow": {
      "type": "string",
      "defaultValue": "[utcNow('g')]",
      "metadata": {
        "description": "Appended to workbook displayNames to make them unique"
      }
    },
    "workbook1-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the workbook"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "SentinelOne",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "analytic1-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic2-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic3-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic4-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic5-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic6-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic7-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic8-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic9-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic10-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    },
    "analytic11-id": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "minLength": 1,
      "metadata": {
        "description": "Unique id for the scheduled alert rule"
      }
    }
  },
  "variables": {
    "SentinelOne_workbook": "SentinelOne_workbook",
    "_SentinelOne_workbook": "[variables('SentinelOne_workbook')]",
    "workbook-source": "[concat(resourceGroup().id, '/providers/Microsoft.OperationalInsights/workspaces/',parameters('workspace'))]",
    "_workbook-source": "[variables('workbook-source')]",
    "SentinelOneAdminLoginNewIP_AnalyticalRules": "SentinelOneAdminLoginNewIP_AnalyticalRules",
    "_SentinelOneAdminLoginNewIP_AnalyticalRules": "[variables('SentinelOneAdminLoginNewIP_AnalyticalRules')]",
    "SentinelOneAgentUninstalled_AnalyticalRules": "SentinelOneAgentUninstalled_AnalyticalRules",
    "_SentinelOneAgentUninstalled_AnalyticalRules": "[variables('SentinelOneAgentUninstalled_AnalyticalRules')]",
    "SentinelOneAlertFromCustomRule_AnalyticalRules": "SentinelOneAlertFromCustomRule_AnalyticalRules",
    "_SentinelOneAlertFromCustomRule_AnalyticalRules": "[variables('SentinelOneAlertFromCustomRule_AnalyticalRules')]",
    "SentinelOneBlacklistHashDeleted_AnalyticalRules": "SentinelOneBlacklistHashDeleted_AnalyticalRules",
    "_SentinelOneBlacklistHashDeleted_AnalyticalRules": "[variables('SentinelOneBlacklistHashDeleted_AnalyticalRules')]",
    "SentinelOneExclusionAdded_AnalyticalRules": "SentinelOneExclusionAdded_AnalyticalRules",
    "_SentinelOneExclusionAdded_AnalyticalRules": "[variables('SentinelOneExclusionAdded_AnalyticalRules')]",
    "SentinelOneMultipleAlertsOnHost_AnalyticalRules": "SentinelOneMultipleAlertsOnHost_AnalyticalRules",
    "_SentinelOneMultipleAlertsOnHost_AnalyticalRules": "[variables('SentinelOneMultipleAlertsOnHost_AnalyticalRules')]",
    "SentinelOneNewAdmin_AnalyticalRules": "SentinelOneNewAdmin_AnalyticalRules",
    "_SentinelOneNewAdmin_AnalyticalRules": "[variables('SentinelOneNewAdmin_AnalyticalRules')]",
    "SentinelOneRuleDeleted_AnalyticalRules": "SentinelOneRuleDeleted_AnalyticalRules",
    "_SentinelOneRuleDeleted_AnalyticalRules": "[variables('SentinelOneRuleDeleted_AnalyticalRules')]",
    "SentinelOneRuleDisabled_AnalyticalRules": "SentinelOneRuleDisabled_AnalyticalRules",
    "_SentinelOneRuleDisabled_AnalyticalRules": "[variables('SentinelOneRuleDisabled_AnalyticalRules')]",
    "SentinelOneSameCustomRuleHitOnDiffHosts_AnalyticalRules": "SentinelOneSameCustomRuleHitOnDiffHosts_AnalyticalRules",
    "_SentinelOneSameCustomRuleHitOnDiffHosts_AnalyticalRules": "[variables('SentinelOneSameCustomRuleHitOnDiffHosts_AnalyticalRules')]",
    "SentinelOneViewAgentPassphrase_AnalyticalRules": "SentinelOneViewAgentPassphrase_AnalyticalRules",
    "_SentinelOneViewAgentPassphrase_AnalyticalRules": "[variables('SentinelOneViewAgentPassphrase_AnalyticalRules')]",
    "SentinelOneAgentNotUpdated_HuntingQueries": "SentinelOneAgentNotUpdated_HuntingQueries",
    "_SentinelOneAgentNotUpdated_HuntingQueries": "[variables('SentinelOneAgentNotUpdated_HuntingQueries')]",
    "workspace-dependency": "[concat('Microsoft.OperationalInsights/workspaces/', parameters('workspace'))]",
    "SentinelOneAgentStatus_HuntingQueries": "SentinelOneAgentStatus_HuntingQueries",
    "_SentinelOneAgentStatus_HuntingQueries": "[variables('SentinelOneAgentStatus_HuntingQueries')]",
    "SentinelOneAlertTriggers_HuntingQueries": "SentinelOneAlertTriggers_HuntingQueries",
    "_SentinelOneAlertTriggers_HuntingQueries": "[variables('SentinelOneAlertTriggers_HuntingQueries')]",
    "SentinelOneHostNotScanned_HuntingQueries": "SentinelOneHostNotScanned_HuntingQueries",
    "_SentinelOneHostNotScanned_HuntingQueries": "[variables('SentinelOneHostNotScanned_HuntingQueries')]",
    "SentinelOneNewRules_HuntingQueries": "SentinelOneNewRules_HuntingQueries",
    "_SentinelOneNewRules_HuntingQueries": "[variables('SentinelOneNewRules_HuntingQueries')]",
    "SentinelOneRulesDeleted_HuntingQueries": "SentinelOneRulesDeleted_HuntingQueries",
    "_SentinelOneRulesDeleted_HuntingQueries": "[variables('SentinelOneRulesDeleted_HuntingQueries')]",
    "SentinelOneScannedHosts_HuntingQueries": "SentinelOneScannedHosts_HuntingQueries",
    "_SentinelOneScannedHosts_HuntingQueries": "[variables('SentinelOneScannedHosts_HuntingQueries')]",
    "SentinelOneSourcesByAlertCount_HuntingQueries": "SentinelOneSourcesByAlertCount_HuntingQueries",
    "_SentinelOneSourcesByAlertCount_HuntingQueries": "[variables('SentinelOneSourcesByAlertCount_HuntingQueries')]",
    "SentinelOneUninstalledAgents_HuntingQueries": "SentinelOneUninstalledAgents_HuntingQueries",
    "_SentinelOneUninstalledAgents_HuntingQueries": "[variables('SentinelOneUninstalledAgents_HuntingQueries')]",
    "SentinelOneUsersByAlertCount_HuntingQueries": "SentinelOneUsersByAlertCount_HuntingQueries",
    "_SentinelOneUsersByAlertCount_HuntingQueries": "[variables('SentinelOneUsersByAlertCount_HuntingQueries')]",
    "sourceId": "azuresentinel.azure-sentinel-solution-sentinelone",
    "_sourceId": "[variables('sourceId')]"
  },
  "resources": [
    {
      "type": "Microsoft.Insights/workbooks",
      "name": "[parameters('workbook1-id')]",
      "location": "[parameters('workspace-location')]",
      "kind": "shared",
      "apiVersion": "2020-02-12",
      "properties": {
        "displayName": "[concat(parameters('workbook1-name'), ' - ', parameters('formattedTimeNow'))]",
        "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"**NOTE**: This data connector depends on a parser based on Kusto Function **SentinelOne** to work as expected. [Follow steps to get this Kusto Function](https://aka.ms/sentinel-sentinelone-parser)\"},\"name\":\"text - 8\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"cd8447d9-b096-4673-92d8-2a1e8291a125\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"description\":\"Sets the time name for analysis\",\"value\":{\"durationMs\":604800000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":900000},{\"durationMs\":3600000},{\"durationMs\":86400000},{\"durationMs\":604800000},{\"durationMs\":2592000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 11\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SentinelOne\\r\\n| make-series TotalEvents = count() default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step {TimeRange:grain};\",\"size\":0,\"title\":\"Events over time\",\"color\":\"orange\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\",\"graphSettings\":{\"type\":0}},\"customWidth\":\"50\",\"name\":\"query - 12\",\"styleSettings\":{\"maxWidth\":\"55\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SentinelOne\\r\\n| where EventType =~ 'Agents.'\\r\\n| summarize count() by AgentVersion\\r\\n\\r\\n\",\"size\":3,\"title\":\"Agents by version\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Title\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"e_count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"secondaryContent\":{\"columnMatch\":\"Trend\",\"formatter\":9,\"formatOptions\":{\"palette\":\"purple\"}},\"showBorder\":false}},\"customWidth\":\"35\",\"name\":\"query - 0\",\"styleSettings\":{\"maxWidth\":\"30\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let usr1 = SentinelOne\\n| where isnotempty(SrcUserName)\\n| project usr=SrcUserName;\\nlet usr2 = SentinelOne\\n| where isnotempty(DataUserName)\\n| project usr=DataUserName;\\nlet all_usr =\\nunion isfuzzy=true usr1, usr2\\n| summarize cnt = dcount(usr)\\n| extend title = 'Users';\\nlet agnt = SentinelOne\\n| where isnotempty(AgentId)\\n| summarize cnt = dcount(AgentId)\\n| extend title = 'Agents';\\nlet alerts = SentinelOne\\n| where ActivityType == 3608\\n| summarize cnt = count()\\n| extend title = 'Alerts';\\nunion isfuzzy=true all_usr, agnt, alerts\",\"size\":3,\"title\":\"SentinelOne Summary\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"title\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"cnt\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false}},\"customWidth\":\"15\",\"name\":\"query - 10\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SentinelOne\\r\\n  | where ActivityType == 27\\r\\n  | where DataRole =~ 'Admin'\\r\\n  | extend SrcIpAddr = extract(@'Address\\\\s(\\\\d{1,3}\\\\.\\\\d{1,3}\\\\.\\\\d{1,3}\\\\.\\\\d{1,3})', 1, EventOriginalMessage)\\r\\n  | where isnotempty(SrcIpAddr)\\r\\n  | summarize Events=count() by SrcIpAddr\",\"size\":3,\"title\":\"Admin Sources\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"35\",\"name\":\"query - 3\",\"styleSettings\":{\"margin\":\"10\",\"padding\":\"10\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SentinelOne\\r\\n| where isnotempty(DataRole)\\r\\n| where DataRole =~ 'Admin'\\r\\n| order by EventCreationTime\\r\\n| limit 100\\r\\n| project EventCreationTime, User=case(isnotempty(SrcUserName), SrcUserName, DataUserName), Action=EventOriginalMessage\",\"size\":1,\"title\":\"Admin activities\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"filter\":true}},\"customWidth\":\"55\",\"name\":\"query - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SentinelOne\\r\\n| where ActivityType == 3608\\r\\n| extend RuleName = extract(@'Custom Rule:\\\\s(.*?)\\\\sin Group', 1, EventOriginalMessage)\\r\\n| summarize Hits=count() by RuleName\\r\\n| top 10 by Hits\\r\\n\",\"size\":1,\"title\":\"Top rules fired\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Hits\",\"formatter\":8,\"formatOptions\":{\"palette\":\"redGreen\"}}],\"rowLimit\":50}},\"customWidth\":\"40\",\"name\":\"query - 8\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SentinelOne\\r\\n| where ActivityType == 3608\\r\\n| extend AlertTrigger = extract(@'Alert created for\\\\s+(.*?)\\\\sfrom Custom', 1, EventOriginalMessage)\\r\\n| summarize Events=count() by AlertTrigger\\r\\n\",\"size\":3,\"title\":\"Alert triggers\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"30\",\"name\":\"query - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SentinelOne\\n| where ActivityType == 3608\\n| extend Host = extract(@'detected on\\\\s(\\\\S+)\\\\.', 1, EventOriginalMessage)\\n| summarize AlertCount=count() by Host\\n\",\"size\":1,\"title\":\"Hosts by alert count\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"customWidth\":\"30\",\"name\":\"query - 10\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SentinelOne\\r\\n| where ActivityType == 3002\\r\\n| order by EventCreationTime\\r\\n| project Hash=EventSubStatus\",\"size\":1,\"title\":\"Recent black hashes\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Hash\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"100%\"}}],\"rowLimit\":100,\"filter\":true}},\"customWidth\":\"30\",\"name\":\"query - 12\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SentinelOne\\n| where ActivityType == 3608\\n| order by EventCreationTime\\n| extend AlertRule = extract(@'Custom Rule:\\\\s(.*?)\\\\sin Group', 1, EventOriginalMessage)\\n| extend AffectedHost = extract(@'detected on\\\\s(\\\\S+)\\\\.', 1, EventOriginalMessage)\\n| project EventCreationTime, AffectedHost, AlertRule\",\"size\":1,\"title\":\"Latest alerts\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"customWidth\":\"70\",\"name\":\"query - 11\"}],\"fromTemplateId\":\"sentinel-SentinelOneWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
        "version": "1.0",
        "sourceId": "[variables('_workbook-source')]",
        "category": "sentinel"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic1-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects admin user login from new location (IP address).",
        "displayName": "Sentinel One - Admin login from new location",
        "enabled": false,
        "query": "SentinelOne\n| where ActivityType == 27\n| where DataRole =~ 'Admin'\n| extend SrcIpAddr = extract(@'Address\\s(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})', 1, EventOriginalMessage)\n| where isnotempty(SrcIpAddr)\n| summarize ip_lst = makeset(SrcIpAddr) by SrcUserName\n| join (SentinelOne\n        | where ActivityType == 27\n        | where DataRole =~ 'Admin'\n        | extend SrcIpAddr = extract(@'Address\\s(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})', 1, EventOriginalMessage)\n        | where isnotempty(SrcIpAddr)) on SrcUserName\n| where ip_lst !has SrcIpAddr\n| extend AccountCustomEntity = SrcUserName, IPCustomEntity = SrcIpAddr\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "P14D",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "InitialAccess",
          "PrivilegeEscalation"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          },
          {
            "entityType": "IP",
            "fieldMappings": [
              {
                "identifier": "Address",
                "columnName": "IPCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic2-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when agent was uninstalled from host.",
        "displayName": "Sentinel One - Agent uninstalled from host",
        "enabled": false,
        "query": "SentinelOne\n| where ActivityType == 31\n| extend HostCustomEntity = DataComputerName\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "DefenseEvasion"
        ],
        "entityMappings": [
          {
            "entityType": "Host",
            "fieldMappings": [
              {
                "identifier": "HostName",
                "columnName": "HostCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic3-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when alert from custom rule received.",
        "displayName": "Sentinel One - Alert from custom rule",
        "enabled": false,
        "query": "SentinelOne\n| where ActivityType == 3608\n| extend RuleName = extract(@'Custom Rule:\\s(.*?)\\sin Group', 1, EventOriginalMessage)\n| extend DstHostname = extract(@'detected on\\s(\\S+)\\.', 1, EventOriginalMessage)\n| extend HostCustomEntity = DstHostname\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "InitialAccess"
        ],
        "entityMappings": [
          {
            "entityType": "Host",
            "fieldMappings": [
              {
                "identifier": "HostName",
                "columnName": "HostCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic4-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when blacklist hash was deleted.",
        "displayName": "Sentinel One - Blacklist hash deleted",
        "enabled": false,
        "query": "SentinelOne\n| where ActivityType == 3020\n| project EventCreationTime, SrcUserName, Hash=EventSubStatus\n| extend AccountCustomEntity = SrcUserName, HashCustomEntity = Hash, HashAlgorithmCustomEntity = \"SHA1\"\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "DefenseEvasion"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          },
          {
            "entityType": "FileHash",
            "fieldMappings": [
              {
                "identifier": "Value",
                "columnName": "HashCustomEntity"
              },
              {
                "identifier": "Algorithm",
                "columnName": "HashAlgorithmCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic5-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when new exclusion added.",
        "displayName": "Sentinel One - Exclusion added",
        "enabled": false,
        "query": "SentinelOne\n| where EventOriginalMessage has_all ('added', 'exclusion')\n| project EventCreationTime, SrcUserName, EventOriginalMessage\n| extend AccountCustomEntity = SrcUserName\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "DefenseEvasion"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic6-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when multiple alerts received from same host.",
        "displayName": "Sentinel One - Multipl alerts on host",
        "enabled": false,
        "query": "SentinelOne\n| where ActivityType == 3608\n| extend RuleName = extract(@'Custom Rule:\\s(.*?)\\sin Group', 1, EventOriginalMessage)\n| extend DstHostname = extract(@'detected on\\s(\\S+)\\.', 1, EventOriginalMessage)\n| summarize count() by DstHostname, bin(TimeGenerated, 15m)\n| where count_ > 1\n| extend HostCustomEntity = DstHostname\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "InitialAccess"
        ],
        "entityMappings": [
          {
            "entityType": "Host",
            "fieldMappings": [
              {
                "identifier": "HostName",
                "columnName": "HostCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic7-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when new admin user is created.",
        "displayName": "Sentinel One - New admin created",
        "enabled": false,
        "query": "SentinelOne\n| where ActivityType == 23\n| extend AccountCustomEntity = SrcUserName\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "PrivilegeEscalation"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic8-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when a rule was deleted.",
        "displayName": "Sentinel One - Rule deleted",
        "enabled": false,
        "query": "SentinelOne\n| where ActivityType == 3602\n| project EventCreationTime, DataRuleName, DataRuleQueryDetails, DataUserName\n| extend AccountCustomEntity = DataUserName\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "DefenseEvasion"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic9-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when a rule was disabled.",
        "displayName": "Sentinel One - Rule disabled",
        "enabled": false,
        "query": "SentinelOne\n| where ActivityType == 3603\n| project EventCreationTime, DataRuleName, DataRuleQueryDetails, DataUserName\n| extend AccountCustomEntity = DataUserName\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "DefenseEvasion"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic10-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when same custom rule was triggered on different hosts.",
        "displayName": "Sentinel One - Same custom rule triggered on different hosts",
        "enabled": false,
        "query": "SentinelOne\n| where ActivityType == 3608\n| extend RuleName = extract(@'Custom Rule:\\s(.*?)\\sin Group', 1, EventOriginalMessage)\n| extend DstHostname = extract(@'detected on\\s(\\S+)\\.', 1, EventOriginalMessage)\n| summarize hosts = makeset(DstHostname) by RuleName, bin(TimeGenerated, 15m)\n| where array_length(hosts) > 1\n| extend HostCustomEntity = hosts\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "InitialAccess"
        ],
        "entityMappings": [
          {
            "entityType": "Host",
            "fieldMappings": [
              {
                "identifier": "HostName",
                "columnName": "HostCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',parameters('analytic11-id'))]",
      "apiVersion": "2021-03-01-preview",
      "kind": "Scheduled",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "description": "Detects when a user viewed agent's passphrase.",
        "displayName": "Sentinel One - User viewed agent's passphrase",
        "enabled": false,
        "query": "SentinelOne\n| where ActivityType == 64\n| extend AccountCustomEntity = SrcUserName, HostCustomEntity = DataComputerName\n",
        "queryFrequency": "PT1H",
        "queryPeriod": "PT1H",
        "severity": "Medium",
        "suppressionDuration": "PT1H",
        "suppressionEnabled": false,
        "triggerOperator": "GreaterThan",
        "triggerThreshold": 0,
        "tactics": [
          "CredentialAccess"
        ],
        "entityMappings": [
          {
            "entityType": "Account",
            "fieldMappings": [
              {
                "identifier": "Name",
                "columnName": "AccountCustomEntity"
              }
            ]
          },
          {
            "entityType": "Host",
            "fieldMappings": [
              {
                "identifier": "HostName",
                "columnName": "HostCustomEntity"
              }
            ]
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces",
      "apiVersion": "2020-08-01",
      "name": "[parameters('workspace')]",
      "location": "[parameters('workspace-location')]",
      "resources": [
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "SentinelOne Hunting Query 1",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Sentinel One - Agent not updated",
            "category": "Hunting Queries",
            "query": "//Latest agent version can be checked in Management Console>Sentinels>Packages\nlet upd_ver = dynamic(['21.7.4.1043', '21.7.4.5853', '21.10.3.3', '21.12.1.5913']);\nSentinelOne\n| where TimeGenerated > ago(24h)\n| where EventType =~ 'Agents.'\n| where AgentVersion !in (upd_ver)\n| extend HostCustomEntity = ComputerName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query shows agent which are not updated to the latest version."
              },
              {
                "name": "tactics",
                "value": "DefenseEvasion"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "SentinelOne Hunting Query 2",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Sentinel One - Agent status",
            "category": "Hunting Queries",
            "query": "SentinelOne\n| where TimeGenerated > ago(24h)\n| where EventType =~ 'Agents.'\n| extend Properties = pack('IsActive', IsActive,'ActiveThreats',ActiveThreats,'FirewallEnabled',FirewallEnabled,'Infected',Infected,'IsUpToDate',IsUpToDate,'MitigationMode',MitigationMode,'MitigationModeSuspicious',MitigationModeSuspicious,'NetworkStatus',NetworkStatus)\n| summarize max(TimeGenerated) by ComputerName, tostring(Properties)\n| extend HostCustomEntity = ComputerName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query shows agent properties."
              },
              {
                "name": "tactics",
                "value": "DefenseEvasion"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "SentinelOne Hunting Query 3",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Sentinel One - Alert triggers (files, processes, strings)",
            "category": "Hunting Queries",
            "query": "SentinelOne\n| where TimeGenerated > ago(24h)\n| where ActivityType == 3608\n| order by EventCreationTime\n| extend trigger = extract(@'Alert created for\\s+(.*?)\\sfrom Custom', 1, EventOriginalMessage)\n| extend MalwareCustomEntity = trigger\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query shows alert triggers (e.g. files, processes, etc.)."
              },
              {
                "name": "tactics",
                "value": "InitialAccess"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "SentinelOne Hunting Query 4",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Sentinel One - Hosts not scanned recently",
            "category": "Hunting Queries",
            "query": "let scanned_agents = SentinelOne\n| where TimeGenerated > ago(24h)\n| where ActivityType == 92\n| order by TimeGenerated\n| summarize makeset(DataComputerName);\nSentinelOne\n| where TimeGenerated > ago(24h)\n| where EventType =~ 'Agents.'\n| where ComputerName !in (scanned_agents)\n| extend HostCustomEntity = ComputerName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for hosts wich were not scanned recently."
              },
              {
                "name": "tactics",
                "value": "DefenseEvasion"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "SentinelOne Hunting Query 5",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Sentinel One - New rules",
            "category": "Hunting Queries",
            "query": "SentinelOne\n| where TimeGenerated > ago(24h)\n| where ActivityType == 3600\n| order by EventCreationTime\n| project EventCreationTime, DataRuleName, DataRuleQueryDetails, DataStatus, DataUserName\n| extend AccountCustomEntity = DataUserName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query shows new rules."
              },
              {
                "name": "tactics",
                "value": "DefenseEvasion"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "SentinelOne Hunting Query 6",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Sentinel One - Deleted rules",
            "category": "Hunting Queries",
            "query": "SentinelOne\n| where TimeGenerated > ago(24h)\n| where ActivityType == 3602\n| order by EventCreationTime\n| project EventCreationTime, DataRuleName, DataRuleQueryDetails, DataStatus, DataUserName\n| extend AccountCustomEntity = DataUserName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query shows deleted rules."
              },
              {
                "name": "tactics",
                "value": "DefenseEvasion"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "SentinelOne Hunting Query 7",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Sentinel One - Scanned hosts",
            "category": "Hunting Queries",
            "query": "SentinelOne\n| where TimeGenerated > ago(24h)\n| where ActivityType == 92\n| order by TimeGenerated\n| project EventCreationTime, DataComputerName\n| extend HostCustomEntity = DataComputerName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query searches for hosts with completed full scan."
              },
              {
                "name": "tactics",
                "value": "DefenseEvasion"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "SentinelOne Hunting Query 8",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Sentinel One - Sources by alert count",
            "category": "Hunting Queries",
            "query": "SentinelOne\n| where TimeGenerated > ago(24h)\n| where ActivityType == 3608\n| extend DstHostname = extract(@'detected on\\s(\\S+)\\.', 1, EventOriginalMessage)\n| summarize count() by DstHostname\n| extend HostCustomEntity = DstHostname\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query shows sources (hosts) by alert count."
              },
              {
                "name": "tactics",
                "value": "InitialAccess"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "SentinelOne Hunting Query 9",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Sentinel One - Uninstalled agents",
            "category": "Hunting Queries",
            "query": "SentinelOne\n| where TimeGenerated > ago(24h)\n| where ActivityType == 31\n| extend HostCustomEntity = DataComputerName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query shows uninstalled agents."
              },
              {
                "name": "tactics",
                "value": "DefenseEvasion"
              }
            ]
          }
        },
        {
          "type": "savedSearches",
          "apiVersion": "2020-08-01",
          "name": "SentinelOne Hunting Query 10",
          "dependsOn": [
            "[variables('workspace-dependency')]"
          ],
          "properties": {
            "eTag": "*",
            "displayName": "Sentinel One - Users by alert count",
            "category": "Hunting Queries",
            "query": "SentinelOne\n| where TimeGenerated > ago(24h)\n| where ActivityType == 3608\n| extend DstHostname = extract(@'detected on\\s(\\S+)\\.', 1, EventOriginalMessage)\n| join (SentinelOne \n      | where EventType =~ 'Agents.'\n      | where isnotempty(LastLoggedInUserName)\n      | project DstHostname=ComputerName, LastLoggedInUserName) on DstHostname\n| summarize count() by LastLoggedInUserName\n| extend AccountCustomEntity = LastLoggedInUserName\n",
            "version": 1,
            "tags": [
              {
                "name": "description",
                "value": "Query shows users by alert count."
              },
              {
                "name": "tactics",
                "value": "InitialAccess"
              }
            ]
          }
        }
      ]
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2021-03-01-preview",
      "properties": {
        "version": "1.0.1",
        "kind": "Solution",
        "contentId": "[variables('_sourceId')]",
        "parentId": "[variables('_sourceId')]",
        "source": {
          "kind": "Solution",
          "name": "SentinelOne",
          "sourceId": "[variables('_sourceId')]"
        },
        "author": {
          "name": "Sanmit Biraj",
          "email": "v-sabiraj@microsoft.com"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "Workbook",
              "contentId": "[variables('_SentinelOne_workbook')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_SentinelOneAdminLoginNewIP_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_SentinelOneAgentUninstalled_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_SentinelOneAlertFromCustomRule_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_SentinelOneBlacklistHashDeleted_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_SentinelOneExclusionAdded_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_SentinelOneMultipleAlertsOnHost_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_SentinelOneNewAdmin_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_SentinelOneRuleDeleted_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_SentinelOneRuleDisabled_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_SentinelOneSameCustomRuleHitOnDiffHosts_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('_SentinelOneViewAgentPassphrase_AnalyticalRules')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_SentinelOneAgentNotUpdated_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_SentinelOneAgentStatus_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_SentinelOneAlertTriggers_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_SentinelOneHostNotScanned_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_SentinelOneNewRules_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_SentinelOneRulesDeleted_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_SentinelOneScannedHosts_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_SentinelOneSourcesByAlertCount_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_SentinelOneUninstalledAgents_HuntingQueries')]",
              "version": "1.0.1"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_SentinelOneUsersByAlertCount_HuntingQueries')]",
              "version": "1.0.1"
            }
          ]
        },
        "firstPublishDate": "2021-12-30",
        "providers": [
          "Microsoft"
        ],
        "categories": {
          "domains": [
            "Security – Endpoint Protection"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_sourceId'))]"
    }
  ],
  "outputs": {}
}
