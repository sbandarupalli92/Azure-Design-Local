{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
  "handler": "Microsoft.Azure.CreateUIDef",
  "version": "0.1.2-preview",
  "parameters": {
    "config": {
      "isWizard": false,
      "basics": {
        "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/Joshua-Cyberiskvision-logo.svg\" width=\"75px\" height=\"75px\">\n\n**Important:** _This Microsoft Sentinel Solution is currently in public preview. This feature is provided without a service level agreement, and it's not recommended for production workloads. Certain features might not be supported or might have constrained capabilities. For more information, see [Supplemental Terms of Use for Microsoft Azure Previews](https://azure.microsoft.com/support/legal/preview-supplemental-terms/)._\n\n**Note:** _There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing._\n\nJoshua Cyberiskvision(https://www.cyberiskvision.com/) enables organizations to define, monitor, analyze and improve their level of Global Cybersecurity following a predictive and context-aware approach that uses a broad spectrum cyber intelligence-driven logic.  The Joshua Solution automates the ingest of Joshua Cyberiskvision threat indicators into the ThreatIntelligenceIndicator table of Microsoft Sentinel workspace. This Solution also contains playbooks that use the Joshua Cyberiskvision threat intelligence to automatically or manually enrich incidents generated by Microsoft Sentinel and the enriched data will be added in the incident comments.\n\nMicrosoft Sentinel Solutions provide a consolidated way to acquire Microsoft Sentinel content like data connectors, workbooks, analytics, and automations in your workspace with a single deployment step.\n\n**Playbooks:** 9\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
        "subscription": {
          "resourceProviders": [
            "Microsoft.OperationsManagement/solutions",
            "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "Microsoft.Insights/workbooks",
            "Microsoft.Logic/workflows"
          ]
        },
        "location": {
          "metadata": {
            "hidden": "Hiding location, we get it from the log analytics workspace"
          },
          "visible": false
        },
        "resourceGroup": {
          "allowExisting": true
        }
      }
    },
    "basics": [
      {
        "name": "getLAWorkspace",
        "type": "Microsoft.Solutions.ArmApiControl",
        "toolTip": "This filters by workspaces that exist in the Resource Group selected",
        "condition": "[greater(length(resourceGroup().name),0)]",
        "request": {
          "method": "GET",
          "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
        }
      },
      {
        "name": "workspace",
        "type": "Microsoft.Common.DropDown",
        "label": "Workspace",
        "placeholder": "Select a workspace",
        "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
        "constraints": {
          "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(filter.id, toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
          "required": true
        },
        "visible": true
      }
    ],
    "steps": [
      {
        "name": "playbooks",
        "label": "Playbooks",
        "subLabel": {
          "preValidation": "Configure the playbooks",
          "postValidation": "Done"
        },
        "bladeTitle": "Playbooks",
        "elements": [
          {
            "name": "playbooks-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This solution installs playbook resources.  A security playbook is a collection of procedures that can be run from Azure Sentinel in response to an alert. A security playbook can help automate and orchestrate your response, and can be run manually or set to run automatically when specific alerts are triggered. Security playbooks in Azure Sentinel are based on Azure Logic Apps, which means that you get all the power, customizability, and built-in templates of Logic Apps. Each playbook is created for the specific subscription you choose, but when you look at the Playbooks page, you will see all the playbooks across any selected subscriptions.",
              "link": {
                "label": "Learn more",
                "uri": "https://docs.microsoft.com/azure/sentinel/tutorial-respond-threats-playbook?WT.mc_id=Portal-Microsoft_Azure_CreateUIDef"
              }
            }
          },
          {
            "name": "playbook1",
            "type": "Microsoft.Common.Section",
            "elements": [
              {
                "name": "playbook1-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This playbook ingests events from Joshua-Cyberiskvision into Log Analytics using the API."
                }
              },
              {
                "name": "playbook1-logicAppName",
                "type": "Microsoft.Common.TextBox",
                "label": "logic App Name",
                "defaultValue": "Joshua-Intel-Enrichment-FILE",
                "toolTip": "Please enter logic App Name",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the logic App Name"
                }
              },
              {
                "name": "playbook1-LogicAppsCategory_Tag",
                "type": "Microsoft.Common.TextBox",
                "label": "Logic Apps Category_ Tag",
                "defaultValue": "security",
                "toolTip": "Please enter Logic Apps Category_ Tag",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Logic Apps Category_ Tag"
                }
              },
              {
                "name": "playbook1-azuresentinel_name",
                "type": "Microsoft.Common.TextBox",
                "label": "azuresentinel_name",
                "defaultValue": "azuresentinel-Playbook1",
                "toolTip": "Please enter azuresentinel_name",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the azuresentinel_name"
                }
              },
              {
                "name": "playbook1-UserName",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua-Cyberiskvision Username",
                "defaultValue": "<username>@<domain>",
                "toolTip": "Username to connect to Joshua-Cyberiskvision API",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook username"
                }
              },
              {
                "name": "playbook1-Joshua_Alert_Enrichment-URI",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua_ Alert_ Enrichment- U R I",
                "defaultValue": "https://api.cyberiskvision.com/external/azure-sentinel/ioc-search",
                "toolTip": "Please enter Joshua_Alert_Enrichment-URI",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Joshua_ Alert_ Enrichment- U R I"
                }
              }
            ]
          },
          {
            "name": "playbook2",
            "type": "Microsoft.Common.Section",
            "elements": [
              {
                "name": "playbook2-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This playbook ingests events from Joshua-Cyberiskvision into Log Analytics using the API."
                }
              },
              {
                "name": "playbook2-logicAppName",
                "type": "Microsoft.Common.TextBox",
                "label": "logic App Name",
                "defaultValue": "Joshua-Intel-Enrichment-IP",
                "toolTip": "Please enter logic App Name",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the logic App Name"
                }
              },
              {
                "name": "playbook2-LogicAppsCategory_Tag",
                "type": "Microsoft.Common.TextBox",
                "label": "Logic Apps Category_ Tag",
                "defaultValue": "security",
                "toolTip": "Please enter Logic Apps Category_ Tag",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Logic Apps Category_ Tag"
                }
              },
              {
                "name": "playbook2-azuresentinel_name",
                "type": "Microsoft.Common.TextBox",
                "label": "azuresentinel_name",
                "defaultValue": "azuresentinel-Playbook2",
                "toolTip": "Please enter azuresentinel_name",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the azuresentinel_name"
                }
              },
              {
                "name": "playbook2-UserName",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua-Cyberiskvision Username",
                "defaultValue": "<username>@<domain>",
                "toolTip": "Username to connect to Joshua-Cyberiskvision API",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook username"
                }
              },
              {
                "name": "playbook2-Joshua_Alert_Enrichment-URI",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua_ Alert_ Enrichment- U R I",
                "defaultValue": "https://api.cyberiskvision.com/external/azure-sentinel/ioc-search",
                "toolTip": "Please enter Joshua_Alert_Enrichment-URI",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Joshua_ Alert_ Enrichment- U R I"
                }
              }
            ]
          },
          {
            "name": "playbook3",
            "type": "Microsoft.Common.Section",
            "elements": [
              {
                "name": "playbook3-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This playbook ingests events from Joshua-Cyberiskvision into Log Analytics using the API."
                }
              },
              {
                "name": "playbook3-logicAppName",
                "type": "Microsoft.Common.TextBox",
                "label": "logic App Name",
                "defaultValue": "Joshua-Intel-Enrichment-URL",
                "toolTip": "Please enter logic App Name",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the logic App Name"
                }
              },
              {
                "name": "playbook3-LogicAppsCategory_Tag",
                "type": "Microsoft.Common.TextBox",
                "label": "Logic Apps Category_ Tag",
                "defaultValue": "security",
                "toolTip": "Please enter Logic Apps Category_ Tag",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Logic Apps Category_ Tag"
                }
              },
              {
                "name": "playbook3-azuresentinel_name",
                "type": "Microsoft.Common.TextBox",
                "label": "azuresentinel_name",
                "defaultValue": "azuresentinel-Playbook3",
                "toolTip": "Please enter azuresentinel_name",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the azuresentinel_name"
                }
              },
              {
                "name": "playbook3-UserName",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua-Cyberiskvision Username",
                "defaultValue": "<username>@<domain>",
                "toolTip": "Username to connect to Joshua-Cyberiskvision API",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook username"
                }
              },
              {
                "name": "playbook3-Joshua_Alert_Enrichment-URI",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua_ Alert_ Enrichment- U R I",
                "defaultValue": "https://api.cyberiskvision.com/external/azure-sentinel/ioc-search",
                "toolTip": "Please enter Joshua_Alert_Enrichment-URI",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Joshua_ Alert_ Enrichment- U R I"
                }
              }
            ]
          },
          {
            "name": "playbook4",
            "type": "Microsoft.Common.Section",
            "label": "Joshua-Import-To-Sentinel",
            "elements": [
              {
                "name": "playbook4-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This playbook ingests events from Joshua-Cyberiskvision into Log Analytics using the API."
                }
              },
              {
                "name": "playbook4-PlaybookName",
                "type": "Microsoft.Common.TextBox",
                "label": "Playbook Name",
                "defaultValue": "Joshua-Import-To-Sentinel",
                "toolTip": "Resource name for the logic app playbook.  No spaces are allowed",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook resource name"
                }
              },
              {
                "name": "playbook4-UserName",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua-Cyberiskvision Username",
                "defaultValue": "<username>@<domain>",
                "toolTip": "Username to connect to Joshua-Cyberiskvision API",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook username"
                }
              }
            ]
          },
          {
            "name": "playbook5",
            "type": "Microsoft.Common.Section",
            "label": "Joshua-Indicators-Processor-DOMAIN",
            "elements": [
              {
                "name": "playbook5-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This playbook ingests events from Joshua-Cyberiskvision into Log Analytics using the API."
                }
              },
              {
                "name": "playbook5-PlaybookName",
                "type": "Microsoft.Common.TextBox",
                "label": "Playbook Name",
                "defaultValue": "Joshua-Indicators-Processor-DOMAIN",
                "toolTip": "Resource name for the logic app playbook.  No spaces are allowed",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook resource name"
                }
              },
              {
                "name": "playbook5-Import2SentinelPlaybookName",
                "type": "Microsoft.Common.TextBox",
                "label": "Playbook Name",
                "defaultValue": "Joshua-Import-To-Sentinel",
                "toolTip": "Resource name for the logic app playbook.  No spaces are allowed",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook resource name"
                }
              },
              {
                "name": "playbook5-LogicAppsCategory_Tag",
                "type": "Microsoft.Common.TextBox",
                "label": "Logic Apps Category_ Tag",
                "defaultValue": "security",
                "toolTip": "Please enter Logic Apps Category_ Tag",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Logic Apps Category_ Tag"
                }
              },
              {
                "name": "playbook5-Joshua_API_URI",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua_ A P I_ U R I",
                "defaultValue": "https://api.cyberiskvision.com/external/azure-sentinel/ioc-feed",
                "toolTip": "Please enter Joshua_ A P I_ U R I",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Joshua_ A P I_ U R I"
                }
              },
              {
                "name": "playbook5-RecurrenceFrequency",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Frequency",
                "defaultValue": "Hour",
                "toolTip": "Please enter Recurrence Frequency",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Frequency"
                }
              },
              {
                "name": "playbook5-RecurrenceInterval",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Interval",
                "defaultValue": "24",
                "toolTip": "Please enter Recurrence Interval",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Interval"
                }
              },
              {
                "name": "playbook5-RecurrenceStartTime",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Start Time",
                "defaultValue": "2021-12-16T06:00:00Z",
                "toolTip": "Please enter Recurrence Start Time",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Start Time"
                }
              }
            ]
          },
          {
            "name": "playbook6",
            "type": "Microsoft.Common.Section",
            "label": "Joshua-Indicators-Processor-EMAIL",
            "elements": [
              {
                "name": "playbook6-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This playbook ingests events from Joshua-Cyberiskvision into Log Analytics using the API."
                }
              },
              {
                "name": "playbook6-PlaybookName",
                "type": "Microsoft.Common.TextBox",
                "label": "Playbook Name",
                "defaultValue": "Joshua-Indicators-Processor-EMAIL",
                "toolTip": "Resource name for the logic app playbook.  No spaces are allowed",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook resource name"
                }
              },
              {
                "name": "playbook6-Import2SentinelPlaybookName",
                "type": "Microsoft.Common.TextBox",
                "label": "Playbook Name",
                "defaultValue": "Joshua-Import-To-Sentinel",
                "toolTip": "Resource name for the logic app playbook.  No spaces are allowed",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook resource name"
                }
              },
              {
                "name": "playbook6-LogicAppsCategory_Tag",
                "type": "Microsoft.Common.TextBox",
                "label": "Logic Apps Category_ Tag",
                "defaultValue": "security",
                "toolTip": "Please enter Logic Apps Category_ Tag",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Logic Apps Category_ Tag"
                }
              },
              {
                "name": "playbook6-Joshua_API_URI",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua_ A P I_ U R I",
                "defaultValue": "https://api.cyberiskvision.com/external/azure-sentinel/ioc-feed",
                "toolTip": "Please enter Joshua_ A P I_ U R I",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Joshua_ A P I_ U R I"
                }
              },
              {
                "name": "playbook6-RecurrenceFrequency",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Frequency",
                "defaultValue": "Hour",
                "toolTip": "Please enter Recurrence Frequency",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Frequency"
                }
              },
              {
                "name": "playbook6-RecurrenceInterval",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Interval",
                "defaultValue": "24",
                "toolTip": "Please enter Recurrence Interval",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Interval"
                }
              },
              {
                "name": "playbook6-RecurrenceStartTime",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Start Time",
                "defaultValue": "2021-12-16T06:00:00Z",
                "toolTip": "Please enter Recurrence Start Time",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Start Time"
                }
              }
            ]
          },
          {
            "name": "playbook7",
            "type": "Microsoft.Common.Section",
            "label": "Joshua-Indicators-Processor-FILE",
            "elements": [
              {
                "name": "playbook7-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This playbook ingests events from Joshua-Cyberiskvision into Log Analytics using the API."
                }
              },
              {
                "name": "playbook7-PlaybookName",
                "type": "Microsoft.Common.TextBox",
                "label": "Playbook Name",
                "defaultValue": "Joshua-Indicators-Processor-FILE",
                "toolTip": "Resource name for the logic app playbook.  No spaces are allowed",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook resource name"
                }
              },
              {
                "name": "playbook7-Import2SentinelPlaybookName",
                "type": "Microsoft.Common.TextBox",
                "label": "Playbook Name",
                "defaultValue": "Joshua-Import-To-Sentinel",
                "toolTip": "Resource name for the logic app playbook.  No spaces are allowed",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook resource name"
                }
              },
              {
                "name": "playbook7-LogicAppsCategory_Tag",
                "type": "Microsoft.Common.TextBox",
                "label": "Logic Apps Category_ Tag",
                "defaultValue": "security",
                "toolTip": "Please enter Logic Apps Category_ Tag",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Logic Apps Category_ Tag"
                }
              },
              {
                "name": "playbook7-Joshua_API_URI",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua_ A P I_ U R I",
                "defaultValue": "https://api.cyberiskvision.com/external/azure-sentinel/ioc-feed",
                "toolTip": "Please enter Joshua_ A P I_ U R I",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Joshua_ A P I_ U R I"
                }
              },
              {
                "name": "playbook7-RecurrenceFrequency",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Frequency",
                "defaultValue": "Hour",
                "toolTip": "Please enter Recurrence Frequency",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Frequency"
                }
              },
              {
                "name": "playbook7-RecurrenceInterval",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Interval",
                "defaultValue": "24",
                "toolTip": "Please enter Recurrence Interval",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Interval"
                }
              },
              {
                "name": "playbook7-RecurrenceStartTime",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Start Time",
                "defaultValue": "2021-12-16T06:00:00Z",
                "toolTip": "Please enter Recurrence Start Time",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Start Time"
                }
              }
            ]
          },
          {
            "name": "playbook8",
            "type": "Microsoft.Common.Section",
            "label": "Joshua-Indicators-Processor-IP",
            "elements": [
              {
                "name": "playbook8-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This playbook ingests events from Joshua-Cyberiskvision into Log Analytics using the API."
                }
              },
              {
                "name": "playbook8-PlaybookName",
                "type": "Microsoft.Common.TextBox",
                "label": "Playbook Name",
                "defaultValue": "Joshua-Indicators-Processor-IP",
                "toolTip": "Resource name for the logic app playbook.  No spaces are allowed",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook resource name"
                }
              },
              {
                "name": "playbook8-Import2SentinelPlaybookName",
                "type": "Microsoft.Common.TextBox",
                "label": "Playbook Name",
                "defaultValue": "Joshua-Import-To-Sentinel",
                "toolTip": "Resource name for the logic app playbook.  No spaces are allowed",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook resource name"
                }
              },
              {
                "name": "playbook8-LogicAppsCategory_Tag",
                "type": "Microsoft.Common.TextBox",
                "label": "Logic Apps Category_ Tag",
                "defaultValue": "security",
                "toolTip": "Please enter Logic Apps Category_ Tag",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Logic Apps Category_ Tag"
                }
              },
              {
                "name": "playbook8-Joshua_API_URI",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua_ A P I_ U R I",
                "defaultValue": "https://api.cyberiskvision.com/external/azure-sentinel/ioc-feed",
                "toolTip": "Please enter Joshua_ A P I_ U R I",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Joshua_ A P I_ U R I"
                }
              },
              {
                "name": "playbook8-RecurrenceFrequency",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Frequency",
                "defaultValue": "Hour",
                "toolTip": "Please enter Recurrence Frequency",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Frequency"
                }
              },
              {
                "name": "playbook8-RecurrenceInterval",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Interval",
                "defaultValue": "24",
                "toolTip": "Please enter Recurrence Interval",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Interval"
                }
              },
              {
                "name": "playbook8-RecurrenceStartTime",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Start Time",
                "defaultValue": "2021-12-16T06:00:00Z",
                "toolTip": "Please enter Recurrence Start Time",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Start Time"
                }
              }
            ]
          },
          {
            "name": "playbook9",
            "type": "Microsoft.Common.Section",
            "label": "Joshua-Indicators-Processor-URL",
            "elements": [
              {
                "name": "playbook9-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This playbook ingests events from Joshua-Cyberiskvision into Log Analytics using the API."
                }
              },
              {
                "name": "playbook9-PlaybookName",
                "type": "Microsoft.Common.TextBox",
                "label": "Playbook Name",
                "defaultValue": "Joshua-Indicators-Processor-URL",
                "toolTip": "Resource name for the logic app playbook.  No spaces are allowed",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook resource name"
                }
              },
              {
                "name": "playbook9-Import2SentinelPlaybookName",
                "type": "Microsoft.Common.TextBox",
                "label": "Playbook Name",
                "defaultValue": "Joshua-Import-To-Sentinel",
                "toolTip": "Resource name for the logic app playbook.  No spaces are allowed",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter a playbook resource name"
                }
              },
              {
                "name": "playbook9-LogicAppsCategory_Tag",
                "type": "Microsoft.Common.TextBox",
                "label": "Logic Apps Category_ Tag",
                "defaultValue": "security",
                "toolTip": "Please enter Logic Apps Category_ Tag",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Logic Apps Category_ Tag"
                }
              },
              {
                "name": "playbook9-Joshua_API_URI",
                "type": "Microsoft.Common.TextBox",
                "label": "Joshua_ A P I_ U R I",
                "defaultValue": "https://api.cyberiskvision.com/external/azure-sentinel/ioc-feed",
                "toolTip": "Please enter Joshua_ A P I_ U R I",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Joshua_ A P I_ U R I"
                }
              },
              {
                "name": "playbook9-RecurrenceFrequency",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Frequency",
                "defaultValue": "Hour",
                "toolTip": "Please enter Recurrence Frequency",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Frequency"
                }
              },
              {
                "name": "playbook9-RecurrenceInterval",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Interval",
                "defaultValue": "24",
                "toolTip": "Please enter Recurrence Interval",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Interval"
                }
              },
              {
                "name": "playbook9-RecurrenceStartTime",
                "type": "Microsoft.Common.TextBox",
                "label": "Recurrence Start Time",
                "defaultValue": "2021-12-16T06:00:00Z",
                "toolTip": "Please enter Recurrence Start Time",
                "constraints": {
                  "required": true,
                  "regex": "[a-z0-9A-Z]{1,256}$",
                  "validationMessage": "Please enter the Recurrence Start Time"
                }
              }
            ]
          }
        ]
      }
    ],
    "outputs": {
      "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(filter.id, toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
      "location": "[location()]",
      "workspace": "[basics('workspace')]",
      "playbook1-logicAppName": "[steps('playbooks').playbook1.playbook1-logicAppName]",
      "playbook1-LogicAppsCategory_Tag": "[steps('playbooks').playbook1.playbook1-LogicAppsCategory_Tag]",
      "playbook1-azuresentinel_name": "[steps('playbooks').playbook1.playbook1-azuresentinel_name]",
      "playbook1-UserName": "[steps('playbooks').playbook1.playbook1-UserName]",
      "playbook1-Joshua_Alert_Enrichment-URI": "[steps('playbooks').playbook1.playbook1-Joshua_Alert_Enrichment-URI]",
      "playbook2-logicAppName": "[steps('playbooks').playbook2.playbook2-logicAppName]",
      "playbook2-LogicAppsCategory_Tag": "[steps('playbooks').playbook2.playbook2-LogicAppsCategory_Tag]",
      "playbook2-azuresentinel_name": "[steps('playbooks').playbook2.playbook2-azuresentinel_name]",
      "playbook2-UserName": "[steps('playbooks').playbook2.playbook2-UserName]",
      "playbook2-Joshua_Alert_Enrichment-URI": "[steps('playbooks').playbook2.playbook2-Joshua_Alert_Enrichment-URI]",
      "playbook3-logicAppName": "[steps('playbooks').playbook3.playbook3-logicAppName]",
      "playbook3-LogicAppsCategory_Tag": "[steps('playbooks').playbook3.playbook3-LogicAppsCategory_Tag]",
      "playbook3-azuresentinel_name": "[steps('playbooks').playbook3.playbook3-azuresentinel_name]",
      "playbook3-UserName": "[steps('playbooks').playbook3.playbook3-UserName]",
      "playbook3-Joshua_Alert_Enrichment-URI": "[steps('playbooks').playbook3.playbook3-Joshua_Alert_Enrichment-URI]",
      "playbook4-PlaybookName": "[steps('playbooks').playbook4.playbook4-PlaybookName]",
      "playbook4-UserName": "[steps('playbooks').playbook4.playbook4-UserName]",
      "playbook5-PlaybookName": "[steps('playbooks').playbook5.playbook5-PlaybookName]",
      "playbook5-Import2SentinelPlaybookName": "[steps('playbooks').playbook5.playbook5-Import2SentinelPlaybookName]",
      "playbook5-LogicAppsCategory_Tag": "[steps('playbooks').playbook5.playbook5-LogicAppsCategory_Tag]",
      "playbook5-Joshua_API_URI": "[steps('playbooks').playbook5.playbook5-Joshua_API_URI]",
      "playbook5-RecurrenceFrequency": "[steps('playbooks').playbook5.playbook5-RecurrenceFrequency]",
      "playbook5-RecurrenceInterval": "[steps('playbooks').playbook5.playbook5-RecurrenceInterval]",
      "playbook5-RecurrenceStartTime": "[steps('playbooks').playbook5.playbook5-RecurrenceStartTime]",
      "playbook6-PlaybookName": "[steps('playbooks').playbook6.playbook6-PlaybookName]",
      "playbook6-Import2SentinelPlaybookName": "[steps('playbooks').playbook6.playbook6-Import2SentinelPlaybookName]",
      "playbook6-LogicAppsCategory_Tag": "[steps('playbooks').playbook6.playbook6-LogicAppsCategory_Tag]",
      "playbook6-Joshua_API_URI": "[steps('playbooks').playbook6.playbook6-Joshua_API_URI]",
      "playbook6-RecurrenceFrequency": "[steps('playbooks').playbook6.playbook6-RecurrenceFrequency]",
      "playbook6-RecurrenceInterval": "[steps('playbooks').playbook6.playbook6-RecurrenceInterval]",
      "playbook6-RecurrenceStartTime": "[steps('playbooks').playbook6.playbook6-RecurrenceStartTime]",
      "playbook7-PlaybookName": "[steps('playbooks').playbook7.playbook7-PlaybookName]",
      "playbook7-Import2SentinelPlaybookName": "[steps('playbooks').playbook7.playbook7-Import2SentinelPlaybookName]",
      "playbook7-LogicAppsCategory_Tag": "[steps('playbooks').playbook7.playbook7-LogicAppsCategory_Tag]",
      "playbook7-Joshua_API_URI": "[steps('playbooks').playbook7.playbook7-Joshua_API_URI]",
      "playbook7-RecurrenceFrequency": "[steps('playbooks').playbook7.playbook7-RecurrenceFrequency]",
      "playbook7-RecurrenceInterval": "[steps('playbooks').playbook7.playbook7-RecurrenceInterval]",
      "playbook7-RecurrenceStartTime": "[steps('playbooks').playbook7.playbook7-RecurrenceStartTime]",
      "playbook8-PlaybookName": "[steps('playbooks').playbook8.playbook8-PlaybookName]",
      "playbook8-Import2SentinelPlaybookName": "[steps('playbooks').playbook8.playbook8-Import2SentinelPlaybookName]",
      "playbook8-LogicAppsCategory_Tag": "[steps('playbooks').playbook8.playbook8-LogicAppsCategory_Tag]",
      "playbook8-Joshua_API_URI": "[steps('playbooks').playbook8.playbook8-Joshua_API_URI]",
      "playbook8-RecurrenceFrequency": "[steps('playbooks').playbook8.playbook8-RecurrenceFrequency]",
      "playbook8-RecurrenceInterval": "[steps('playbooks').playbook8.playbook8-RecurrenceInterval]",
      "playbook8-RecurrenceStartTime": "[steps('playbooks').playbook8.playbook8-RecurrenceStartTime]",
      "playbook9-PlaybookName": "[steps('playbooks').playbook9.playbook9-PlaybookName]",
      "playbook9-Import2SentinelPlaybookName": "[steps('playbooks').playbook9.playbook9-Import2SentinelPlaybookName]",
      "playbook9-LogicAppsCategory_Tag": "[steps('playbooks').playbook9.playbook9-LogicAppsCategory_Tag]",
      "playbook9-Joshua_API_URI": "[steps('playbooks').playbook9.playbook9-Joshua_API_URI]",
      "playbook9-RecurrenceFrequency": "[steps('playbooks').playbook9.playbook9-RecurrenceFrequency]",
      "playbook9-RecurrenceInterval": "[steps('playbooks').playbook9.playbook9-RecurrenceInterval]",
      "playbook9-RecurrenceStartTime": "[steps('playbooks').playbook9.playbook9-RecurrenceStartTime]"
    }
  }
}