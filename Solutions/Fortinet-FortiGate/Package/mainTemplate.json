{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Eli Forbes - v-eliforbes@microsoft.com",
    "comments": "Solution template for Fortinet FortiGate"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[parameters('location')]",
      "metadata": {
        "description": "Region to deploy solution resources"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Sentinel is setup"
      }
    },
    "playbook1-service_EndPoint": {
      "defaultValue": "https://{yourfortinetDomain}",
      "type": "string",
      "minLength": 1
    },
    "playbook2-Function App Name": {
      "defaultValue": "",
      "type": "string"
    },
    "playbook2-Identifier of Keyvalut": {
      "defaultValue": "",
      "type": "string"
    },
    "playbook2-service_EndPoint": {
      "defaultValue": "",
      "type": "string"
    },
    "playbook3-Playbook Name": {
      "defaultValue": "Fortinet-FortiGate-IPEnrichment",
      "type": "string",
      "minLength": 1
    },
    "playbook3-Function app Name": {
      "defaultValue": "",
      "type": "string"
    },
    "playbook3-User Identifier Name": {
      "defaultValue": "fortinetuseridentity",
      "type": "string",
      "minLength": 1
    },
    "playbook4-playbook Name": {
      "defaultValue": "Fortinet-FortiGate-ResponseOnBlockIP",
      "type": "string",
      "minLength": 1
    },
    "playbook4-Function app Name": {
      "defaultValue": "",
      "type": "string"
    },
    "playbook4-User Identifier Name": {
      "defaultValue": "fortinetuseridentity",
      "type": "string",
      "minLength": 1
    },
    "playbook5-playbook Name": {
      "defaultValue": "Fortinet-FortiGate-ResponseOnBlockURL",
      "type": "string",
      "minLength": 1
    },
    "playbook5-Function App Name": {
      "defaultValue": "",
      "type": "string"
    },
    "playbook5-User Identifier Name": {
      "defaultValue": "fortinetuseridentity",
      "type": "string",
      "minLength": 1
    },
    "playbook6-PlaybookName": {
      "defaultValue": "Fortinet-Block-IP-Nested-Remediation",
      "type": "string",
      "minLength": 1,
      "metadata": {
        "description": "Resource name for the logic app playbook.  No spaces are allowed"
      }
    },
    "playbook6-ConnectorName": {
      "defaultValue": "FortinetConnector",
      "type": "string",
      "minLength": 1
    },
    "playbook6-AddressGroup": {
      "defaultValue": "AddressGroup",
      "type": "string",
      "minLength": 1
    },
    "playbook6-FunctionAppName": {
      "defaultValue": "",
      "type": "string"
    },
    "playbook6-UserIdentifierName": {
      "defaultValue": "fortinetuseridentity",
      "type": "string",
      "minLength": 1
    },
    "playbook6-CreateIdentity": {
      "defaultValue": "false",
      "type": "string",
      "minLength": 1
    }
  },
  "variables": {
    "playbook1-FortinetConnectorname": "FortinetConnector",
    "operationId-Listaddressobjects": "Listaddressobjects",
    "_operationId-Listaddressobjects": "[variables('operationId-Listaddressobjects')]",
    "operationId-CreateaddressObject": "CreateaddressObject",
    "_operationId-CreateaddressObject": "[variables('operationId-CreateaddressObject')]",
    "operationId-Listaddressgroups": "Listaddressgroups",
    "_operationId-Listaddressgroups": "[variables('operationId-Listaddressgroups')]",
    "operationId-Updateaddressgroup": "Updateaddressgroup",
    "_operationId-Updateaddressgroup": "[variables('operationId-Updateaddressgroup')]",
    "operationId-AddURLtoaddressGroup": "AddURLtoaddressGroup",
    "_operationId-AddURLtoaddressGroup": "[variables('operationId-AddURLtoaddressGroup')]",
    "operationId-CheckIFIP_URLBlocked": "CheckIFIP_URLBlocked",
    "_operationId-CheckIFIP_URLBlocked": "[variables('operationId-CheckIFIP_URLBlocked')]",
    "operationId-GetAddressObject": "GetAddressObject",
    "_operationId-GetAddressObject": "[variables('operationId-GetAddressObject')]",
    "playbook2-functionAppName": "[parameters('playbook2-Function App Name')]",
    "playbook2-hostingPlanName": "[parameters('playbook2-Function App Name')]",
    "playbook2-applicationInsightsName": "[parameters('playbook2-Function App Name')]",
    "playbook2-storageAccountName": "[concat(uniquestring(resourceGroup().id), 'azfunctions')]",
    "playbook2-StorageAccount": "Standard_LRS",
    "playbook2-functionWorkerRuntime": "dotnet",
    "playbook2-SecretIdentifierofKeyvalut": "[parameters('playbook2-Identifier of Keyvalut')]",
    "playbook2-location": "[parameters('workspace-location')]",
    "playbook2-appInsightsLocation": "[parameters('workspace-location')]",
    "playbook2-Endpoint": "[parameters('playbook2-service_EndPoint')]",
    "playbook2-functionName": "Fortinet-GetEntityDetails",
    "playbook3-AzureSentinelConnectionName": "[concat('azuresentinel-', parameters('playbook3-Playbook Name'))]",
    "playbook3-UserIdentifier": "[parameters('playbook3-User Identifier Name')]",
    "playbook3-Functionappname": "[parameters('playbook3-Function app Name')]",
    "playbook-3-connection-2": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('workspace-location'), '/managedApis/azuresentinel')]",
    "_playbook-3-connection-2": "[variables('playbook-3-connection-2')]",
    "playbook4-AzureSentinelConnectionName": "[concat('azuresentinel-', parameters('playbook4-Playbook Name'))]",
    "playbook4-TeamsConnectionName": "[concat('teamsconnector-', parameters('playbook4-Playbook Name'))]",
    "playbook4-FortinetConnectorConnectionName": "[concat('FortinetConnector-', parameters('playbook4-Playbook Name'))]",
    "playbook4-UserIdentifier": "[parameters('playbook4-User Identifier Name')]",
    "playbook4-Functionappname": "[parameters('playbook4-Function app Name')]",
    "playbook-4-connection-1": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/FortinetConnector')]",
    "_playbook-4-connection-1": "[variables('playbook-4-connection-1')]",
    "playbook-4-connection-3": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('workspace-location'), '/managedApis/teams')]",
    "_playbook-4-connection-3": "[variables('playbook-4-connection-3')]",
    "playbook5-AzureSentinelConnectionName": "[concat('azuresentinel-', parameters('playbook5-Playbook Name'))]",
    "playbook5-TeamsConnectionName": "[concat('teamsconnector-', parameters('playbook5-Playbook Name'))]",
    "playbook5-FortinetConnectorConnectionName": "[concat('FortinetConnector-', parameters('playbook5-Playbook Name'))]",
    "playbook5-UserIdentifier": "[parameters('playbook5-User Identifier Name')]",
    "playbook5-functionappname": "[parameters('playbook5-Function App Name')]",
    "playbook6-FortinetConnectorConnectionName": "[parameters('playbook6-PlaybookName')]",
    "playbook6-UserIdentifier": "[parameters('playbook6-UserIdentifierName')]",
    "playbook6-Functionappname": "[parameters('playbook6-FunctionAppName')]",
    "CustomConnector": "CustomConnector",
    "_CustomConnector": "[variables('CustomConnector')]",
    "FunctionApp": "FunctionApp",
    "_FunctionApp": "[variables('FunctionApp')]",
    "Fortinet_IncidentEnrichment": "Fortinet_IncidentEnrichment",
    "_Fortinet_IncidentEnrichment": "[variables('Fortinet_IncidentEnrichment')]",
    "Fortinet_ResponseOnIP": "Fortinet_ResponseOnIP",
    "_Fortinet_ResponseOnIP": "[variables('Fortinet_ResponseOnIP')]",
    "Fortinet_ResponseOnURL": "Fortinet_ResponseOnURL",
    "_Fortinet_ResponseOnURL": "[variables('Fortinet_ResponseOnURL')]",
    "sourceId": "azuresentinel.azure-sentinel-solution-fortinetfortigate",
    "_sourceId": "[variables('sourceId')]"
  },
  "resources": [
    {
      "condition": "[equals(parameters('playbook6-CreateIdentity'), 'true')]",
      "type": "Microsoft.ManagedIdentity/userAssignedIdentities",
      "name": "[parameters('playbook6-UserIdentifierName')]",
      "apiVersion": "2018-11-30",
      "location": "[parameters('workspace-location')]"
    },
    {
      "type": "Microsoft.Web/customApis",
      "apiVersion": "2018-07-01-preview",
      "name": "[variables('playbook1-FortinetConnectorname')]",
      "location": "[parameters('workspace-location')]",
      "metadata": {
        "workspace": "[parameters('workspace')]"
      },
      "properties": {
        "connectionParameters": {
          "api_key": {
            "type": "securestring",
            "uiDefinition": {
              "displayName": "API Key",
              "description": "The API Key for this api",
              "tooltip": "Provide your API Key",
              "constraints": {
                "tabIndex": 2,
                "clearText": false,
                "required": "true"
              }
            }
          }
        },
        "backendService": {
          "serviceUrl": "[parameters('playbook1-service_EndPoint')]"
        },
        "description": "Connector to FortiNet and FortiGate API's",
        "displayName": "[variables('playbook1-FortinetConnectorname')]",
        "iconUri": "data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABQAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzEzOCA3OS4xNTk4MjQsIDIwMTYvMDkvMTQtMDE6MDk6MDEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWI3MjVhZWEtZDExZi00MTE1LTg2MzMtYjJmNjhjMTBiN2M0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkI4Njg2Q0ZDRTIyOTExRTZCRkEyRkUxRTVERjJDQjE5IiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkI4Njg2Q0ZCRTIyOTExRTZCRkEyRkUxRTVERjJDQjE5IiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE3IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YWI3MjVhZWEtZDExZi00MTE1LTg2MzMtYjJmNjhjMTBiN2M0IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFiNzI1YWVhLWQxMWYtNDExNS04NjMzLWIyZjY4YzEwYjdjNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/uAA5BZG9iZQBkwAAAAAH/2wCEAAICAgICAgICAgIDAgICAwQDAgIDBAUEBAQEBAUGBQUFBQUFBgYHBwgHBwYJCQoKCQkMDAwMDAwMDAwMDAwMDAwBAwMDBQQFCQYGCQ0LCQsNDw4ODg4PDwwMDAwMDw8MDAwMDAwPDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDP/AABEIAJYBGAMBEQACEQEDEQH/xADIAAEAAgMAAwEBAAAAAAAAAAAACAkEBQoBBgcDAgEBAAIDAQEBAAAAAAAAAAAAAAcIAwUGBAIBEAABAgQCBQULCAkDBQAAAAAAAQIDBAUGEQcS05VXCCETs3UXMUEiFJQ1FlY3GDhRYbJzNLQVCXFSckOFtcWGR4EyYkKSI2MkEQABAgICCwwHBQcFAQAAAAAAAQIDBBEFITFx0ZJTVBUGFgdBUWGBkbESMnKTFDRCUrITczU2oSKCQ4PB4cIzs8NE8GLSIyRj/9oADAMBAAIRAxEAPwC/wAAAAAAA0dyXJQ7QodSuS5KlBpFEpMFY8/Px1waxqciIiJirnOVURrURVcqoiIqqYo0ZkFivetCIeyQkI8/HZLy7FfEetCIn+rCJbVVsIllbBUrnVxpXvek1N0bLmPMWRabXOhsn4Soyqzje5pvjNx8XRe6jYS6Sd969xOErHSKLGVWwfut3/SXj3OLlLM6JbJpGrmNiz6JGjW6F/lt4Eb6d11jealshVNTc1PzEacnpmLOTcw5Xx5qO90SI9y91XPcqqq/pU51zlctKrSpLUOEyE1GsREalpEShE4jHPk+wAACX/A77eaf1NUujab/RrziXFIu2v/IHfEZzl0hIpU4idxr/AA/3H1hS/vcM0WkfknXU5yS9kn1BC7L/AGVKTSOC24AAAAAAAAB0tSX2OU+ph/RQmJtpCgMbruuqZJ9GM5tLh8/1zrCZ6VxD8XruuqX4kfLw+y3mQ05jPUAAAb+3bpuW0ahDqtr16ft+ow1RWzkhHiQHqid5ysVNJPlRcUUywY8SC7pMcqLwHinqtlp+GsOZhtiN3nIjue1dQsl4fuNdavOSNn5xRIErNzLmwKbfMNrYMF8R2CNZPw2ojIeK/vWIjf1mtTFx2FVaR9NUhzFvcdfvkB6bbJPcMdNVUiq1LLoS2VRN+GtteytK7yr1Sx5FRURUVFRUxRU7iodeQMeQAAAAAAAAAAAAAAUt8W2fcxmjd8e1LfnV9AbSmHwpRITvAqE7DxZFm3YcjmtXFsL/AI4u/wCvBI6r6tFmovu2L9xv2rv3v3lstmWhbalk0mY7f/TFSlabbGLZRnAu6/hseiRANASgAAAAAAS/4HfbzT+pql0bTf6NecS4pF21/wCQO+IznLpCRSpxE7jX+H+4+sKX97hmi0j8k66nOSXsk+oIXZf7KlJpHBbcAAAAAAAAA6WpL7HKfUw/ooTE20hQGN13XVMk+jGc2lw+f651hM9K4h+L13XVL8SPl4fZbzIacxnqAAAAAALV+CfPuYuOT7IrtnVj1ejS6xbNn4zsXzElCT/ySjnLyq6A3wmf+vFORGcvcaOVosRPDxFsp1eFN7i3OC4Vu2t6FtlH50lm0MetEVEtNetp9x9p3+6hfSLDDrCDgAAAAAAAAAAACM/FlmXEy2yfrMSnzCy9fux6UKixGrg+Gsy1yzEZuHKisgNfg5O45Wmmr2c8NLLR1nfdTjt/YSBs00fSt64ho9KYcL/sdw9FU6KcblSlN1qKUaEaFwgAAAAAAAS/4HfbzT+pql0bTf6NecS4pF21/wCQO+IznLpCRSpxE7jX+H+4+sKX97hmi0j8k66nOSXsk+oIXZf7KlJpHBbcAAAAAAAAA6WpL7HKfUw/ooTE20hQGN13XVMk+jGc2lw+f651hM9K4h+L13XVL8SPl4fZbzIacxnqAAAAAAPYrSueq2Xc1CuyiRuYqtvzsGdk38uiroTkVWPw7rXpi1yd9FVDNAjOgxGxG20Wk8NZ1fCrCViS0ZKWRGq1ePdThS2m8p0QWnclPvG2LfuulO0qdcUhL1CURVxc1keGj9B3/JuOiqfKhLMCM2NDa9tpURSjNZyESr5qJLRetDcrV/CtFNxbacB7CZTwgAAAAAAAAAAqY/MAux9Qv+0bOhRdKVtujuno7EXkSZqMVUVHJ8qQpdip+0cJpVH6UZkPcalPGv7kLMbE6sSFV8aaVLMR/RTsw0/5OdyEAzliagAAAAAAAS/4HfbzT+pql0bTf6NecS4pF21/5A74jOcukJFKnETuNf4f7j6wpf3uGaLSPyTrqc5JeyT6ghdl/sqUmkcFtwAAAAAAAADpakvscp9TD+ihMTbSFAY3XddUyT6MZzaXD5/rnWEz0riH4vXddUvxI+Xh9lvMhpzGeoAAAAAAAFyvAvdj69kw+hzEXTmLNrEzIwWquLklphGzcJf0acWI1PmaSFozH95K9FfRVU4ls/tUqptiqxJWuvfNSxGY134m0sX7GtXjJnHREUAAAAAAAAAAApo4tLEzCuDPy96jSbLuCtUpWUuHT5+Sps1MS7mtpkrppDiQ4bmrhEVyLgvIuKEe17Kxok49WscqWKKEVfRQtZszrmrpWoJdkWPCY/76qjnta7+Y6ilFWm1RxEceynNHdtdOx53Umn8DMYt2Ct47zWSqsqg94y+OynNHdtdOx53UjwMxi3YK3hrJVWVQe8ZfHZTmju2unY87qR4GYxbsFbw1kqrKoPeMvjspzR3bXTsed1I8DMYt2Ct4ayVVlUHvGXx2U5o7trp2PO6keBmMW7BW8NZKqyqD3jL47Kc0d2107HndSPAzGLdgreGslVZVB7xl8lXwaWJfFv52SFRr1m1yiU9tIqEN09P06ZloKPcxui1YkWG1uK95MTeaPSsWHNormORKFtoqEbbVq5kZqpHQ4MeG93TZYa9rlt7yKqlvR3xWAjBxg0asV7Iy4KbQqVOVqoxZ6muhSEhAiTMdzWTTHOVIcJrnKiJyryGlr+G6JKORqKq0pas7pIey2bgytew4kZ7WNRr7LlRqdVd1aEKeeynNHdtdOx53Ukf+BmMW7BW8Wl1kqrKoPeMvjspzR3bXTsed1I8DMYt2Ct4ayVVlUHvGXx2U5o7trp2PO6keBmMW7BW8NZKqyqD3jL47Kc0d2107HndSPAzGLdgreGslVZVB7xl8dlOaO7a6djzupHgZjFuwVvDWSqsqg94y+OynNHdtdOx53UjwMxi3YK3hrJVWVQe8ZfHZTmju2unY87qR4GYxbsFbw1kqrKoPeMvnQ5JorZSVa5Fa5sFiKi8ioqNQlltpCjcVaXrdUyT9MZz317KzM6LXKzEh5c3REhxJ6YdDiNpE6rXNWK5UVFSFyopFMWSmFev/AFutr6K3i78lpHVaQIaLNQaein5jN66arspzR3bXTsed1Jj8DMYt2Ct49OslVZVB7xl8dlOaO7a6djzupHgZjFuwVvDWSqsqg94y+OynNHdtdOx53UjwMxi3YK3hrJVWVQe8ZfHZTmju2unY87qR4GYxbsFbw1kqrKoPeMvjspzR3bXTsed1I8DMYt2Ct4ayVVlUHvGXx2U5o7trp2PO6keBmMW7BW8NZKqyqD3jL5YvwEW1dttQc1Je5rdq1vwZl9FiU6HU5OPKJFciTyRlh88xmlgmhpYdzk+U67ReDEhJFR7VTq0Uoqb5BO2msJScdJul4rIip7xHdByOo/l0U9FVo3aOMsOOsINAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPX567bVpk1Fkalc1Jp87A0eek5mdgQorNJqObpMe9HJi1UVMU7hidHhtWhXIi3UPdBqybjMR8OE9zVtKjVVOVEMT08sf1zoW0ZbWHz4qD67eVDJmaexETAdeHp5Y/rnQtoy2sHioPrt5UGZp7ERMB14enlj+udC2jLaweKg+u3lQZmnsREwHXh6eWP650LaMtrB4qD67eVBmaexETAdeHp5Y/rnQtoy2sHioPrt5UGZp7ERMB14enlj+udC2jLaweKg+u3lQZmnsREwHXjNp902xVplJOlXHS6nNuarklZScgxoitb3V0GPVcE7/IfTI8N60NcirwKhhj1dNQG9KJCe1u+rVROVUN8ZTxgAAAAAAAAAAAAAAHqrr6sljnMfeNDY9iq17HVCWRUVORUVFiGDxML128qGxSp55UpSBEwHXjx6eWP650LaMtrB4qD67eVD9zNPYiJgOvD08sf1zoW0ZbWDxUH128qDM09iImA68PTyx/XOhbRltYPFQfXbyoMzT2IiYDrw9PLH9c6FtGW1g8VB9dvKgzNPYiJgOvD08sf1zoW0ZbWDxUH128qDM09iImA68PTyx/XOhbRltYPFQfXbyoMzT2IiYDrxtaXXqHW+f8AwWsyNX8V0fGfEpiFMc3p46OnzbnaOlorhj3cFPtkVj+qqLcWk80xJR5aj3sNzKbXSRW00W6KUNsZDzAAAAAAAAAAAo14xPiNzF/hH8okiNNIPPROL2ULhbLPpuV/U/qvIzGmJAAAAAAAABL/AIHfbzT+pql0bTf6NecS4pF21/5A74jOcukJFKnAAAAAAAAAAAAAAAHNpcPn+udYTPSuIfi9d11S/Ej5eH2W8yGnMZ6gAAAAAAAWZfl1f5h/t/8AqR2WiX5v4f4iv23X/B/V/tFmJ2RX4AAAAAAAAAAFGvGJ8RuYv8I/lEkRppB56JxeyhcLZZ9Nyv6n9V5GY0xIAAAAAAAAJf8AA77eaf1NUujab/RrziXFIu2v/IHfEZzl0hIpU4AAAAAAAAAAAAAAA5tLh8/1zrCZ6VxD8XruuqX4kfLw+y3mQ05jPUAAAAAAACzL8ur/ADD/AG//AFI7LRL838P8RX7br/g/q/2izE7Ir8AAAAAAAAAACjXjE+I3MX+EfyiSI00g89E4vZQuFss+m5X9T+q8jMaYkAAAAAAAAEv+B3280/qapdG03+jXnEuKRdtf+QO+IznLpCRSpwAAAAAAAAAAAAAABzaXD5/rnWEz0riH4vXddUvxI+Xh9lvMhpzGeoAAAAAAAFmX5dX+Yf7f/qR2WiX5v4f4iv23X/B/V/tFmJ2RX4AAAAAAAAAAFGvGJ8RuYv8ACP5RJEaaQeeicXsoXC2WfTcr+p/VeRmNMSAAAAAAAACX/A77eaf1NUujab/RrziXFIu2v/IHfEZzl0hIpU4AAAAAAAAAAAAAAA5tLh8/1zrCZ6VxD8XruuqX4kfLw+y3mQ05jPUAAAAAAACzL8ur/MP9v/1I7LRL838P8RX7br/g/q/2izE7Ir8AAAAAAAAAACoPiiyWzWu3PW+bgtqwqxWqJUPwzxKpysur4MXmqZKQn6Lk7ui9jmr86HA11V0xFm3vYxVRaLP4ULQbO9LKpkahl4ExMsZEb06WqtCpTEeqcqKinwH3dM891tweSuNVmibxbuQ7bXuosshYQ93TPPdbcHkrhmibxbuQa91FlkLCHu6Z57rbg8lcM0TeLdyDXuosshYQ93TPPdbcHkrhmibxbuQa91FlkLCHu6Z57rbg8lcM0TeLdyDXuosshYQ93TPPdbcHkrhmibxbuQa91FlkLCJPcImT+Z9mZySVcuux6tQaRDpU/BfUJyAsOEkSIxqMarl76943VQ1fMQZpHPYqJQtlSPNp+lNV1hUzoMtMMe/ptWhq0rQi2S1w7krYAAAAAAAAAAAAAAAUM1vh5zvj1qrx4OWFfiQY07MRIURsq5Uc10RyoqfpQjCJVM2r1VIbra7hc2T05qNsBjVm4aKjU9LgNX7umee624PJXGPNE3i3ch6de6iyyFhD3dM891tweSuGaJvFu5Br3UWWQsIe7pnnutuDyVwzRN4t3INe6iyyFhD3dM891tweSuGaJvFu5Br3UWWQsIe7pnnutuDyVwzRN4t3INe6iyyFhD3dM891tweSuGaJvFu5Br3UWWQsIn7wNZc31YHaj6aWtULa/FvwT8N8ehLC5/mPH+d0Me7o843H9KHVaNSkaX957xqtp6NFPGQpthr6QrTwnhIzYnQ970uitNHS93RTdoXkJ+nUkKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHz+t5sZYWzVJqiXFmDb1DrEloeOUueqUtLzELnGNiM04cR6ObpMcjkxTlRUU8sSel4Tla+I1FTcVUpN3J6NVpOQkjQJaK9jqaHNY5zVoWhaFRKLCoqXTU9uuS29e0tryetMec5XGswkPTqbXeRx+7deHbrktvXtLa8nrRnOVxrMJBqbXeRx+7deHbrktvXtLa8nrRnOVxrMJBqbXeRx+7deHbrktvXtLa8nrRnOVxrMJBqbXeRx+7deHbrktvXtLa8nrRnOVxrMJBqbXeRx+7deHbrktvXtLa8nrRnOVxrMJBqbXeRx+7deN3b+aOW911FtIti/KBcFVfDdFZTqfUJeZjqxnK5yQ4b3OwTvrgZIU7Aiu6LHtVd5FRTyTujtZSMP3sxLxIbKaOk5jmpStqyqHvZ6jTGmr1xUG1qbFrNy1mSoFJgOYyNUqhHZLwGOiORrEdEiK1qK5VwTlMcWMyE3pPVETfWweuSkZidipCl4boj1tNaiuWxbsJZPQu3XJbevaW15PWnlznK41mEhudTa7yOP3brw7dclt69pbXk9aM5yuNZhINTa7yOP3brw7dclt69pbXk9aM5yuNZhINTa7yOP3brw7dclt69pbXk9aM5yuNZhINTa7yOP3brw7dclt69pbXk9aM5yuNZhINTa7yOP3brw7dclt69pbXk9aM5yuNZhINTa7yOP3brw7dclt69pbXk9aM5yuNZhINTa7yOP3brx9Va5rmtc1Uc1yIrXJyoqL3FPcc4qUWDyD8PlkXPHJqDEiQY2alqQosJysiw3VeURzXNXBUVFiciop4lrKVT81vKh0bdD66ciKknGVF/+brx/HbrktvXtLa8nrT8znK41mEh+6m13kcfu3Xh265Lb17S2vJ60ZzlcazCQam13kcfu3Xh265Lb17S2vJ60ZzlcazCQam13kcfu3Xh265Lb17S2vJ60ZzlcazCQam13kcfu3Xh265Lb17S2vJ60ZzlcazCQam13kcfu3Xh265Lb17S2vJ60ZzlcazCQam13kcfu3Xj2u2L7su9fHvQ+7KTdH4ZzX4j+FzkGb5jntPm+c5pztHT5t2GPdwX5DPBmoUan3bkdRboWk1tYVNO1d0fFQXwulT0em1W00UU0UolNFKU3UPazOa0AAAAAAAAAAFIPGbIx5TiGvSYjNwh1SXpUzKr8sNtOl4Cr/wB8FyEbaRNVJ1679HMifsLebKIzYmjsBqW2rERbvvHO5nIRaNISMAAAAAAACX/A77eaf1NUujab/RrziXFIu2v/ACB3xGc5dISKVOInca/w/wBx9YUv73DNFpH5J11OckvZJ9QQuy/2VKTSOC24AAAAAAAAB0tSX2OU+ph/RQmJtpCgMbruuqZJ9GM5tLh8/wBc6wmelcQ/F67rql+JHy8Pst5kNOYz1AAAAAAAAs+/LukY8On5r1Jzf/mm5ijS0F3yxJdk696f6JHadpok1ejFdufd+ym+V526RmrEk4e6iRF4nKxE9lSyU7AgMAAAAAAAAAAFW/5g9nRINcsS/oEJVgVCTjUKoRUTkbElnumJfS+d7Y0TD5mHE6Vy9D2RU3UoXispzryFi9iFao6BMSSrZa5IiXHJ0XcitbhFchyJO4AAAAAAAJf8Dvt5p/U1S6Npv9GvOJcUi7a/8gd8RnOXSEilTiJ3Gv8AD/cfWFL+9wzRaR+SddTnJL2SfUELsv8AZUpNI4LbgAAAAAAAAHS1JfY5T6mH9FCYm2kKAxuu66pkn0Yzm0uHz/XOsJnpXEPxeu66pfiR8vD7LeZDTmM9QAAAAAAALtOC+zolqZG0acmYSwpy8ZyZrsZrk8Lm4ujAl+X5HQYLXp+0SPo7L+6lEVbblVf2J9iFR9rFapPV7EY1aWwWpD40pc7kc5U4iV5vSNQAAAAAAAAAAfF+IDLNM2Mq7ktWBDa6sshpULbe7BNGoSuL4TcV5E51NKEq95Hqa6tZPxcu5iW7aXUv2uM6zQnSDMdawplV+5T0X9h1hcGw660oJjQY0tGiy8xCfAmID3Q48CI1WvY9q4Oa5q8qKipgqKRaqKi0KXUY9HtRzVpRbKLvn5H4fQAAAAABL/gd9vNP6mqXRtN/o15xLikXbX/kDviM5y6QkUqcRO41/h/uPrCl/e4ZotI/JOupzkl7JPqCF2X+ypSaRwW3AAAAAAAAAOlqS+xyn1MP6KExNtIUBjdd11TJPoxnNpcPn+udYTPSuIfi9d11S/Ej5eH2W8yGnMZ6gAAAAAD6HlTl9Us0b/tuyaa17Vq8038Qmmpj4tJw/DmY697wIaKqY912De6p65GUdNRmw03Vs8Cbqmj0kryHUtXxZuJ6CWE9Z62Gt41t7yUruHQnTKdJUem0+kU2A2Vp1LloUpISrP8AbDgwGJDhsT5mtaiErsYjGo1LSJQUfmI75iI6LEWlzlVyrvqq0qvKZp9GEAAAAAAAAAAAAqy4zuHaZp1Rn84bMkFjUmoO52+KbAbi6VmF7s81qfu4n739V3hryOXR4nSKqVa5ZiGlhesm8u/cXd5SxuyjTpsWG2q5t1D22ITl9JuL7TfR32/dtolNdJyJOoAAAAABL/gd9vNP6mqXRtN/o15xLikXbX/kDviM5y6QkUqcRO41/h/uPrCl/e4ZotI/JOupzkl7JPqCF2X+ypSaRwW3AAAAAAAAAOlqS+xyn1MP6KExNtIUBjdd11TJPoxnNpcPn+udYTPSuIfi9d11S/Ej5eH2W8yGnMZ6gAAAAftLy8ebjwJWVgRJmamYjYUtLQmq+JEiPVGtYxrUVVVVXBEQ/URVWhLZ8ve1jVc5URESlVWwiIm6pdHwncPzsobZjXDc0u1L/umCzx+HyOWnyeKPZJo5MfCVcHRVTk0kRvLoYrItRVV4SH039d32JvX/ANxU3aXpslfTSQJdf/NCWx/vfaV9zcZwUr6VCS6N8RiAAAAAAAAAAAAAD8JnxbxaY8c5vxTm3+Nc9hzfN4Lp6elyaOGOOPJgfi0UWbR9w+l0k6FPSpsUW6dyjhKZM9bT4Z5+qVSr5U5pyNDqTY0Tx60YtOqsWmvitcuksjNwJOK1jVVFwamlDXHwXNbghHlZwJBzldAiIi+rQ6jiVE/cWu0OrPSeFCZCrKTc9tCUREfDSIibnvGOeiqu+th2+jlIfuREVURyORFwRyY4L86Y4Kc+Sih4AAAAJf8AA77eaf1NUujab/RrziXFIu2v/IHfEZzl0hIpU4idxr/D/cfWFL+9wzRaR+SddTnJL2SfUELsv9lSk0jgtuAAAAAAAAAdLUl9jlPqYf0UJibaQoDG67rqmSfRjObS4fP9c6wmelcQ/F67rql+JHy8Pst5kNOYz1AAAGfTZSXnp2BKzVUlqNAjOwiVKcbHfBhJ+s9stCjxVT9lin2xqOWhVROFaf2IqmGYiuhMVzWK9U9FvRpW50la3lchZvwqW9wy2/cMiyk5gSt+5qzENzpCYm5Ccp8CXVE8NlPhzsCE10TBV8JXLEVEXRa1NJDsqjhSEN6dF6Pi7lKKlHZpS39pXzaRPaTzUu5YsssCTRbKNcx7nbyxFY5VRvBQjUW2rloLHTryBgAAAAAAAf/Z",
        "swagger": {
          "swagger": "2.0",
          "info": {
            "title": "Default title",
            "description": "Connector to FortiNet and FortiGate API's",
            "version": "1.0"
          },
          "host": "fortinetlactest1.trafficmanager.net",
          "basePath": "/",
          "schemes": [
            "https"
          ],
          "paths": {
            "/api/v2/cmdb/firewall/address": {
              "get": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string",
                            "description": "Name of the address object",
                            "title": "name"
                          },
                          "q_origin_key": {
                            "type": "string",
                            "description": "q_origin_key of an address object",
                            "title": "q_origin_key"
                          },
                          "uuid": {
                            "type": "string",
                            "description": "Unique id of address group",
                            "title": "uuid"
                          },
                          "subnet": {
                            "type": "string",
                            "description": "subnet address of address object",
                            "title": "subnet"
                          },
                          "type": {
                            "type": "string",
                            "description": "Type of the address object",
                            "title": "type"
                          },
                          "sub-type": {
                            "type": "string",
                            "description": "Sub-type of address object",
                            "title": "sub-type"
                          },
                          "clearpass-spt": {
                            "type": "string",
                            "description": "clear pass-spt of address object",
                            "title": "clearpass-spt"
                          },
                          "start-mac": {
                            "type": "string",
                            "description": "Starting mac address of address object",
                            "title": "start-mac"
                          },
                          "end-mac": {
                            "type": "string",
                            "description": "end-mac address of address object",
                            "title": "end-mac"
                          },
                          "country": {
                            "type": "string",
                            "description": "Country of the address object",
                            "title": "country"
                          },
                          "cache-ttl": {
                            "type": "integer",
                            "format": "int32",
                            "description": "cache-ttl of the address",
                            "title": "cache-ttl"
                          },
                          "sdn": {
                            "type": "string",
                            "description": "sdn",
                            "title": "sdn"
                          },
                          "fsso-group": {
                            "type": "array",
                            "description": "fsso-group"
                          },
                          "interface": {
                            "type": "string",
                            "description": "Interface of address object",
                            "title": "interface"
                          },
                          "obj-type": {
                            "type": "string",
                            "description": "object-type of an address",
                            "title": "obj-type"
                          },
                          "comment": {
                            "type": "string",
                            "description": "Comment of the address object",
                            "title": "comment"
                          },
                          "associated-interface": {
                            "type": "string",
                            "description": "associated-interface of the address object",
                            "title": "associated-interface"
                          },
                          "color": {
                            "type": "integer",
                            "format": "int32",
                            "description": "Color of the address object",
                            "title": "color"
                          },
                          "filter": {
                            "type": "string",
                            "description": "filter of address object",
                            "title": "filter"
                          },
                          "sdn-addr-type": {
                            "type": "string",
                            "description": "sdn-addr-type",
                            "title": "sdn-addr-type"
                          },
                          "obj-id": {
                            "type": "string",
                            "description": "object_id of the address object",
                            "title": "obj-id"
                          },
                          "list": {
                            "type": "array",
                            "description": "list"
                          },
                          "tagging": {
                            "type": "array",
                            "description": "tagging"
                          },
                          "allow-routing": {
                            "type": "string",
                            "description": "allow routing object is enable or disable",
                            "title": "allow-routing"
                          },
                          "fabric-object": {
                            "type": "string",
                            "description": "fabric-object of address object",
                            "title": "fabric-object"
                          },
                          "obj-tag": {
                            "type": "string",
                            "description": "object-tag of an object",
                            "title": "obj-tag"
                          },
                          "start-ip": {
                            "type": "string",
                            "description": "start-ip of  address object",
                            "title": "start-ip"
                          },
                          "end-ip": {
                            "type": "string",
                            "description": "end-ip of address object",
                            "title": "end-ip"
                          },
                          "fqdn": {
                            "type": "string",
                            "description": "fqdn",
                            "title": "fqdn"
                          }
                        }
                      }
                    }
                  }
                },
                "summary": "List address objects",
                "description": "action used to fetch details all address objects",
                "operationId": "[variables('_operationId-Listaddressobjects')]"
              },
              "post": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "mkey": {
                          "type": "string",
                          "description": "Name of the address object created",
                          "title": "mkey"
                        },
                        "status": {
                          "type": "string",
                          "description": "status"
                        },
                        "path": {
                          "type": "string",
                          "description": "path of an address object",
                          "title": "path"
                        },
                        "serial": {
                          "type": "string",
                          "description": "Serial number of the system",
                          "title": "serial"
                        },
                        "version": {
                          "type": "string",
                          "description": "Version of the system",
                          "title": "version"
                        }
                      }
                    }
                  }
                },
                "summary": "Create an address object",
                "description": "action used to create a new address object",
                "operationId": "[variables('_operationId-CreateaddressObject')]",
                "x-ms-visibility": "important",
                "parameters": [
                  {
                    "name": "body",
                    "in": "body",
                    "required": true,
                    "schema": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "description": "enter the address object name",
                          "title": "name"
                        },
                        "type": {
                          "type": "string",
                          "description": "Type of address.ipmask:Standard IPv4 address with subnet mask. fqdn:Fully Qualified Domain Name address.",
                          "title": "address type",
                          "enum": [
                            "iprange",
                            "fqdn"
                          ]
                        },
                        "start-ip": {
                          "type": "string",
                          "description": "start range of IPv4 addresses between two specified addresses (inclusive)",
                          "title": "start-ip"
                        },
                        "end-ip": {
                          "type": "string",
                          "description": "end range of IPv4 addresses between two specified addresses (inclusive)",
                          "title": "end-ip"
                        },
                        "fqdn": {
                          "type": "string",
                          "description": "Please provide the URL for ex gmail.com if type=fqdn",
                          "title": "URL address"
                        }
                      },
                      "required": [
                        "name",
                        "type"
                      ]
                    }
                  }
                ]
              }
            },
            "/api/v2/cmdb/firewall/addrgrp": {
              "get": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "http_method": {
                          "type": "string",
                          "description": "http_method used to call the API",
                          "title": "http_method"
                        },
                        "revision": {
                          "type": "string",
                          "description": "revision of the address group",
                          "title": "revision"
                        },
                        "results": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string",
                                "description": "Group name",
                                "title": "name"
                              },
                              "q_origin_key": {
                                "type": "string",
                                "description": "q_origin_key of the group member",
                                "title": "q_origin_key"
                              },
                              "type": {
                                "type": "string",
                                "description": "type of the group",
                                "title": "type"
                              },
                              "uuid": {
                                "type": "string",
                                "description": "Unique ID of group",
                                "title": "uuid"
                              },
                              "member": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "name": {
                                      "type": "string",
                                      "description": "name"
                                    },
                                    "q_origin_key": {
                                      "type": "string",
                                      "description": "q_origin_key"
                                    }
                                  }
                                },
                                "description": "member"
                              },
                              "comment": {
                                "type": "string",
                                "description": "comment of the group",
                                "title": "comment"
                              },
                              "exclude": {
                                "type": "string",
                                "description": "exclude"
                              },
                              "exclude-member": {
                                "type": "array",
                                "description": "exclude-member"
                              },
                              "color": {
                                "type": "integer",
                                "format": "int32",
                                "description": "color of the group",
                                "title": "color"
                              },
                              "tagging": {
                                "type": "array",
                                "description": "tagging"
                              },
                              "allow-routing": {
                                "type": "string",
                                "description": "allow-routing"
                              },
                              "fabric-object": {
                                "type": "string",
                                "description": "fabric-object"
                              }
                            }
                          },
                          "description": "results"
                        },
                        "vdom": {
                          "type": "string",
                          "description": "virtual domain",
                          "title": "vdom"
                        },
                        "path": {
                          "type": "string",
                          "description": "path",
                          "title": "path"
                        },
                        "name": {
                          "type": "string",
                          "description": "name of the entities",
                          "title": "name"
                        },
                        "status": {
                          "type": "string",
                          "description": "status of the API call",
                          "title": "status"
                        },
                        "http_status": {
                          "type": "integer",
                          "format": "int32",
                          "description": "http_status of the API call",
                          "title": "http_status"
                        },
                        "serial": {
                          "type": "string",
                          "description": "serial"
                        },
                        "version": {
                          "type": "string",
                          "description": "version of the address group",
                          "title": "version"
                        },
                        "build": {
                          "type": "integer",
                          "format": "int32",
                          "description": "build of response",
                          "title": "build"
                        }
                      }
                    }
                  }
                },
                "summary": "List address groups",
                "description": "action used to create a new address groups",
                "operationId": "[variables('_operationId-Listaddressgroups')]",
                "parameters": [
                  {
                    "name": "filter",
                    "in": "query",
                    "required": false,
                    "type": "string",
                    "description": "enter the address object name to filter (e.g. member=@10.10.10.09)"
                  }
                ]
              }
            },
            "/api/v2/cmdb/firewall/addrgrp/{name}": {
              "put": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "mkey": {
                          "type": "string",
                          "description": "Group name which address object is added",
                          "title": "mkey"
                        },
                        "status": {
                          "type": "string",
                          "description": "Status code of the API call",
                          "title": "status"
                        },
                        "http_status": {
                          "type": "integer",
                          "format": "int32",
                          "description": "Status of the \"IP add to an address object\" action",
                          "title": "http_status"
                        },
                        "vdom": {
                          "type": "string",
                          "description": "virtual domain",
                          "title": "vdom"
                        },
                        "path": {
                          "type": "string",
                          "description": "firewall path",
                          "title": "path"
                        },
                        "name": {
                          "type": "string",
                          "description": "Entity name",
                          "title": "name"
                        }
                      }
                    }
                  }
                },
                "summary": "Update address group",
                "description": "Action is used to add/remove an address object to an address group",
                "operationId": "[variables('_operationId-Updateaddressgroup')]",
                "parameters": [
                  {
                    "name": "name",
                    "in": "path",
                    "required": true,
                    "type": "string",
                    "description": "enter the address group name"
                  },
                  {
                    "name": "body",
                    "in": "body",
                    "required": true,
                    "schema": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "description": "enter the address group name",
                          "title": "name"
                        },
                        "member": {
                          "type": "object",
                          "description": "Enter the whole array of members i.e existing and also new ones",
                          "title": "member"
                        }
                      },
                      "required": [
                        "member",
                        "name"
                      ]
                    }
                  }
                ]
              }
            },
            "/api/v2/cmdb/firewall.wildcard-fqdn/group": {
              "put": {
                "responses": {
                  "default": {
                    "description": "default"
                  }
                },
                "summary": "Add an URL to an address group",
                "description": "Action used to add an URL to an address group",
                "operationId": "[variables('_operationId-AddURLtoaddressGroup')]",
                "parameters": [
                  {
                    "name": "name",
                    "in": "query",
                    "required": false,
                    "type": "string",
                    "x-ms-visibility": "important",
                    "description": "please provide the name address group"
                  },
                  {
                    "name": "body",
                    "in": "body",
                    "required": false,
                    "schema": {
                      "type": "object"
                    }
                  }
                ]
              }
            },
            "/api/v2/cmdb/firewall/policy": {
              "get": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "policyid": {
                            "type": "integer",
                            "format": "int32",
                            "description": "policyid of the policy",
                            "title": "policyid"
                          },
                          "q_origin_key": {
                            "type": "integer",
                            "format": "int32",
                            "description": "q_origin_key of the policy",
                            "title": "q_origin_key"
                          },
                          "status": {
                            "type": "string",
                            "description": "status of the policy",
                            "title": "status"
                          },
                          "name": {
                            "type": "string",
                            "description": "name of the policy",
                            "title": "name"
                          },
                          "uuid": {
                            "type": "string",
                            "description": "unique Id of the Poilcy",
                            "title": "uuid"
                          },
                          "srcintf": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string",
                                  "description": "name"
                                },
                                "q_origin_key": {
                                  "type": "string",
                                  "description": "q_origin_key"
                                }
                              }
                            },
                            "description": "srcintf"
                          },
                          "dstintf": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string",
                                  "description": "name"
                                },
                                "q_origin_key": {
                                  "type": "string",
                                  "description": "q_origin_key"
                                }
                              }
                            },
                            "description": "dstintf"
                          },
                          "srcaddr": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string",
                                  "description": "name"
                                },
                                "q_origin_key": {
                                  "type": "string",
                                  "description": "q_origin_key"
                                }
                              }
                            },
                            "description": "srcaddr"
                          },
                          "dstaddr": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string",
                                  "description": "name"
                                },
                                "q_origin_key": {
                                  "type": "string",
                                  "description": "q_origin_key"
                                }
                              }
                            },
                            "description": "dstaddr"
                          },
                          "srcaddr6": {
                            "type": "array",
                            "description": "srcaddr6"
                          },
                          "dstaddr6": {
                            "type": "array",
                            "description": "dstaddr6"
                          },
                          "internet-service": {
                            "type": "string",
                            "description": "internet-service of the policy",
                            "title": "internet-service"
                          },
                          "internet-service-name": {
                            "type": "array",
                            "description": "internet-service-name"
                          },
                          "internet-service-group": {
                            "type": "array",
                            "description": "internet-service-group"
                          },
                          "internet-service-custom": {
                            "type": "array",
                            "description": "internet-service-custom"
                          },
                          "internet-service-custom-group": {
                            "type": "array",
                            "description": "internet-service-custom-group"
                          },
                          "internet-service-src": {
                            "type": "string",
                            "description": "internet-service-source",
                            "title": "internet-service-src"
                          },
                          "internet-service-src-name": {
                            "type": "array",
                            "description": "internet-service-src-name"
                          },
                          "internet-service-src-group": {
                            "type": "array",
                            "description": "internet-service-src-group"
                          },
                          "internet-service-src-custom": {
                            "type": "array",
                            "description": "internet-service-src-custom"
                          },
                          "internet-service-src-custom-group": {
                            "type": "array",
                            "description": "internet-service-src-custom-group"
                          },
                          "reputation-minimum": {
                            "type": "integer",
                            "format": "int32",
                            "description": "reputation-minimum of the policy",
                            "title": "reputation-minimum"
                          },
                          "reputation-direction": {
                            "type": "string",
                            "description": "reputation-direction of the policy",
                            "title": "reputation-direction"
                          },
                          "src-vendor-mac": {
                            "type": "array",
                            "description": "src-vendor-mac"
                          },
                          "rtp-nat": {
                            "type": "string",
                            "description": "rtp-nat of the policy",
                            "title": "rtp-nat"
                          },
                          "rtp-addr": {
                            "type": "array",
                            "description": "rtp-addr"
                          },
                          "action": {
                            "type": "string",
                            "description": "Action of the policy",
                            "title": "action"
                          },
                          "send-deny-packet": {
                            "type": "string",
                            "description": "send-deny-packet of  policy",
                            "title": "send-deny-packet"
                          },
                          "firewall-session-dirty": {
                            "type": "string",
                            "description": "firewall-session-dirty of the policy",
                            "title": "firewall-session-dirty"
                          },
                          "schedule": {
                            "type": "string",
                            "description": "schedule of the policy",
                            "title": "schedule"
                          },
                          "schedule-timeout": {
                            "type": "string",
                            "description": "schedule-timeout of the poilcy",
                            "title": "schedule-timeout"
                          },
                          "service": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string",
                                  "description": "name"
                                },
                                "q_origin_key": {
                                  "type": "string",
                                  "description": "q_origin_key"
                                }
                              }
                            },
                            "description": "service"
                          },
                          "tos": {
                            "type": "string",
                            "description": "tos of the policy",
                            "title": "tos"
                          },
                          "tos-mask": {
                            "type": "string",
                            "description": "tos-mask of the policy",
                            "title": "tos-mask"
                          },
                          "tos-negate": {
                            "type": "string",
                            "description": "tos-negate of the policy",
                            "title": "tos-negate"
                          },
                          "anti-replay": {
                            "type": "string",
                            "description": "anti-replay of the policy",
                            "title": "anti-replay"
                          },
                          "tcp-session-without-syn": {
                            "type": "string",
                            "description": "tcp-session-without-syn of policy",
                            "title": "tcp-session-without-syn"
                          },
                          "geoip-anycast": {
                            "type": "string",
                            "description": "geoip-anycast of the policy",
                            "title": "geoip-anycast"
                          },
                          "geoip-match": {
                            "type": "string",
                            "description": "geoip-match of the policy",
                            "title": "geoip-match"
                          },
                          "utm-status": {
                            "type": "string",
                            "description": "utm-status of the policy",
                            "title": "utm-status"
                          },
                          "inspection-mode": {
                            "type": "string",
                            "description": "inspection-mode of the policy",
                            "title": "inspection-mode"
                          },
                          "http-policy-redirect": {
                            "type": "string",
                            "description": "http-policy-redirect of the policy",
                            "title": "http-policy-redirect"
                          },
                          "ssh-policy-redirect": {
                            "type": "string",
                            "description": "ssh-policy-redirect of the policy",
                            "title": "ssh-policy-redirect"
                          },
                          "webproxy-profile": {
                            "type": "string",
                            "description": "webproxy-profile of the policy",
                            "title": "webproxy-profile"
                          },
                          "profile-type": {
                            "type": "string",
                            "description": "profile-type"
                          },
                          "profile-group": {
                            "type": "string",
                            "description": "profile-group of the policy",
                            "title": "profile-group"
                          },
                          "profile-protocol-options": {
                            "type": "string",
                            "description": "profile-protocol-options"
                          },
                          "ssl-ssh-profile": {
                            "type": "string",
                            "description": "ssl-ssh-profile of the policy",
                            "title": "ssl-ssh-profile"
                          },
                          "av-profile": {
                            "type": "string",
                            "description": "av-profile of policy",
                            "title": "av-profile"
                          },
                          "webfilter-profile": {
                            "type": "string",
                            "description": "webfilter-profile of the policy",
                            "title": "webfilter-profile"
                          },
                          "dnsfilter-profile": {
                            "type": "string",
                            "description": "dnsfilter-profile of the policy",
                            "title": "dnsfilter-profile"
                          },
                          "emailfilter-profile": {
                            "type": "string",
                            "description": "emailfilter-profile of the policy",
                            "title": "emailfilter-profile"
                          },
                          "dlp-sensor": {
                            "type": "string",
                            "description": "dlp-sensor of the policy",
                            "title": "dlp-sensor"
                          },
                          "file-filter-profile": {
                            "type": "string",
                            "description": "file-filter-profile of the policy",
                            "title": "file-filter-profile"
                          },
                          "ips-sensor": {
                            "type": "string",
                            "description": "ips-sensor"
                          },
                          "application-list": {
                            "type": "string",
                            "description": "application-list of the policy",
                            "title": "application-list"
                          },
                          "voip-profile": {
                            "type": "string",
                            "description": "voip-profile"
                          },
                          "icap-profile": {
                            "type": "string",
                            "description": "icap-profile of the policy",
                            "title": "icap-profile"
                          },
                          "cifs-profile": {
                            "type": "string",
                            "description": "cifs-profile of the policy",
                            "title": "cifs-profile"
                          },
                          "waf-profile": {
                            "type": "string",
                            "description": "waf-profile of policy",
                            "title": "waf-profile"
                          },
                          "ssh-filter-profile": {
                            "type": "string",
                            "description": "ssh-filter-profile of the policy",
                            "title": "ssh-filter-profile"
                          },
                          "logtraffic": {
                            "type": "string",
                            "description": "logtraffic of the policy",
                            "title": "logtraffic"
                          },
                          "logtraffic-start": {
                            "type": "string",
                            "description": "logtraffic-start of the policy",
                            "title": "logtraffic-start"
                          },
                          "capture-packet": {
                            "type": "string",
                            "description": "capture-packet of the policy",
                            "title": "capture-packet"
                          },
                          "auto-asic-offload": {
                            "type": "string",
                            "description": "auto-asic-offload",
                            "title": "auto-asic-offload"
                          },
                          "wanopt": {
                            "type": "string",
                            "description": "wanopt of the policy",
                            "title": "wanopt"
                          },
                          "wanopt-detection": {
                            "type": "string",
                            "description": "wanopt-detection of the policy",
                            "title": "wanopt-detection"
                          },
                          "wanopt-passive-opt": {
                            "type": "string",
                            "description": "wanopt-passive-opt of the policy",
                            "title": "wanopt-passive-opt"
                          },
                          "wanopt-profile": {
                            "type": "string",
                            "description": "wanopt-profile of the policy",
                            "title": "wanopt-profile"
                          },
                          "wanopt-peer": {
                            "type": "string",
                            "description": "wanopt-peer of the policy",
                            "title": "wanopt-peer"
                          },
                          "webcache": {
                            "type": "string",
                            "description": "webcache of the policy",
                            "title": "webcache"
                          },
                          "webcache-https": {
                            "type": "string",
                            "description": "webcache-https of the policy",
                            "title": "webcache-https"
                          },
                          "webproxy-forward-server": {
                            "type": "string",
                            "description": "webproxy-forward-server of the policy",
                            "title": "webproxy-forward-server"
                          },
                          "traffic-shaper": {
                            "type": "string",
                            "description": "traffic-shaper of the policy",
                            "title": "traffic-shaper"
                          },
                          "traffic-shaper-reverse": {
                            "type": "string",
                            "description": "traffic-shaper-reverse of the policy",
                            "title": "traffic-shaper-reverse"
                          },
                          "per-ip-shaper": {
                            "type": "string",
                            "description": "per-ip-shaper of the policy",
                            "title": "per-ip-shaper"
                          },
                          "nat": {
                            "type": "string",
                            "description": "nat of the policy",
                            "title": "nat"
                          },
                          "permit-any-host": {
                            "type": "string",
                            "description": "permit-any-host of the policy",
                            "title": "permit-any-host"
                          },
                          "permit-stun-host": {
                            "type": "string",
                            "description": "permit-stun-host of the policy",
                            "title": "permit-stun-host"
                          },
                          "fixedport": {
                            "type": "string",
                            "description": "fixedport of the policy",
                            "title": "fixedport"
                          },
                          "ippool": {
                            "type": "string",
                            "description": "ippool of the policy",
                            "title": "ippool"
                          },
                          "poolname": {
                            "type": "array",
                            "description": "poolname"
                          },
                          "poolname6": {
                            "type": "array",
                            "description": "poolname6"
                          },
                          "session-ttl": {
                            "type": "string",
                            "description": "session-ttl"
                          },
                          "vlan-cos-fwd": {
                            "type": "integer",
                            "format": "int32",
                            "description": "vlan-cos-fwd of the policy",
                            "title": "vlan-cos-fwd"
                          },
                          "vlan-cos-rev": {
                            "type": "integer",
                            "format": "int32",
                            "description": "vlan-cos-rev of the policy",
                            "title": "vlan-cos-rev"
                          },
                          "inbound": {
                            "type": "string",
                            "description": "inbound of the policy",
                            "title": "inbound"
                          },
                          "outbound": {
                            "type": "string",
                            "description": "outbound of the policy",
                            "title": "outbound"
                          },
                          "natinbound": {
                            "type": "string",
                            "description": "natinbound of the policy",
                            "title": "natinbound"
                          },
                          "natoutbound": {
                            "type": "string",
                            "description": "natoutbound"
                          },
                          "wccp": {
                            "type": "string",
                            "description": "wccp of the policy",
                            "title": "wccp"
                          },
                          "ntlm": {
                            "type": "string",
                            "description": "ntlm of the policy",
                            "title": "ntlm"
                          },
                          "ntlm-guest": {
                            "type": "string",
                            "description": "ntlm-guest of the policy",
                            "title": "ntlm-guest"
                          },
                          "ntlm-enabled-browsers": {
                            "type": "array",
                            "description": "ntlm-enabled-browsers"
                          },
                          "fsso-agent-for-ntlm": {
                            "type": "string",
                            "description": "fsso-agent-for-ntlm of the policy",
                            "title": "fsso-agent-for-ntlm"
                          },
                          "groups": {
                            "type": "array",
                            "description": "groups"
                          },
                          "users": {
                            "type": "array",
                            "description": "users"
                          },
                          "fsso-groups": {
                            "type": "array",
                            "description": "fsso-groups"
                          },
                          "auth-path": {
                            "type": "string",
                            "description": "authentication path of the policy",
                            "title": "auth-path"
                          },
                          "disclaimer": {
                            "type": "string",
                            "description": "disclaimer of the policy",
                            "title": "disclaimer"
                          },
                          "email-collect": {
                            "type": "string",
                            "description": "email-collect of the policy",
                            "title": "email-collect"
                          },
                          "vpntunnel": {
                            "type": "string",
                            "description": "vpntunnel of the policy",
                            "title": "vpntunnel"
                          },
                          "natip": {
                            "type": "string",
                            "description": "natip of the policy",
                            "title": "natip"
                          },
                          "match-vip": {
                            "type": "string",
                            "description": "match-vip of the policy",
                            "title": "match-vip"
                          },
                          "match-vip-only": {
                            "type": "string",
                            "description": "match-vip-only of the policy",
                            "title": "match-vip-only"
                          },
                          "diffserv-forward": {
                            "type": "string",
                            "description": "diffserv-forward of the policy",
                            "title": "diffserv-forward"
                          },
                          "diffserv-reverse": {
                            "type": "string",
                            "description": "diffserv-reverse of the policy",
                            "title": "diffserv-reverse"
                          },
                          "diffservcode-forward": {
                            "type": "string",
                            "description": "diffservcode-forward of the policy",
                            "title": "diffservcode-forward"
                          },
                          "diffservcode-rev": {
                            "type": "string",
                            "description": "diffservcode-rev of the policy",
                            "title": "diffservcode-rev"
                          },
                          "tcp-mss-sender": {
                            "type": "integer",
                            "format": "int32",
                            "description": "tcp-mss-sender of the policy",
                            "title": "tcp-mss-sender"
                          },
                          "tcp-mss-receiver": {
                            "type": "integer",
                            "format": "int32",
                            "description": "tcp-mss-receiver of the policy",
                            "title": "tcp-mss-receiver"
                          },
                          "comments": {
                            "type": "string",
                            "description": "comments of the policy",
                            "title": "comments"
                          },
                          "label": {
                            "type": "string",
                            "description": "label of the policy",
                            "title": "label"
                          },
                          "global-label": {
                            "type": "string",
                            "description": "global-label of the policy",
                            "title": "global-label"
                          },
                          "auth-cert": {
                            "type": "string",
                            "description": "authentication certificate of the policy",
                            "title": "auth-cert"
                          },
                          "auth-redirect-addr": {
                            "type": "string",
                            "description": "authentication-redirect-address",
                            "title": "auth-redirect-addr"
                          },
                          "redirect-url": {
                            "type": "string",
                            "description": "redirect-url of the policy",
                            "title": "redirect-url"
                          },
                          "identity-based-route": {
                            "type": "string",
                            "description": "identity-based-route of the policy",
                            "title": "identity-based-route"
                          },
                          "block-notification": {
                            "type": "string",
                            "description": "Block-notification of policy",
                            "title": "block-notification"
                          },
                          "custom-log-fields": {
                            "type": "array",
                            "description": "custom-log-fields"
                          },
                          "replacemsg-override-group": {
                            "type": "string",
                            "description": "replacemsg-override-group of the policy",
                            "title": "replacemsg-override-group"
                          },
                          "srcaddr-negate": {
                            "type": "string",
                            "description": "srouce address-negate of the policy",
                            "title": "srcaddr-negate"
                          },
                          "dstaddr-negate": {
                            "type": "string",
                            "description": "dstaddr-negate of the policy",
                            "title": "dstaddr-negate"
                          },
                          "service-negate": {
                            "type": "string",
                            "description": "service-negate of the policy",
                            "title": "service-negate"
                          },
                          "internet-service-negate": {
                            "type": "string",
                            "description": "internet-service-negate"
                          },
                          "internet-service-src-negate": {
                            "type": "string",
                            "description": "internet-service-src-negate"
                          },
                          "timeout-send-rst": {
                            "type": "string",
                            "description": "timeout-send-rst of the policy",
                            "title": "timeout-send-rst"
                          },
                          "captive-portal-exempt": {
                            "type": "string",
                            "description": "captive-portal-exempt of the policy",
                            "title": "captive-portal-exempt"
                          },
                          "decrypted-traffic-mirror": {
                            "type": "string",
                            "description": "decrypted-traffic-mirror of the policy",
                            "title": "decrypted-traffic-mirror"
                          },
                          "dsri": {
                            "type": "string",
                            "description": "dsri of the policy",
                            "title": "dsri"
                          },
                          "radius-mac-auth-bypass": {
                            "type": "string",
                            "description": "radius-mac-authentication-bypass of the policy",
                            "title": "radius-mac-auth-bypass"
                          },
                          "delay-tcp-npu-session": {
                            "type": "string",
                            "description": "delay-tcp-npu-session of the policy",
                            "title": "delay-tcp-npu-session"
                          },
                          "vlan-filter": {
                            "type": "string",
                            "description": "vlan-filter of the policy",
                            "title": "vlan-filter"
                          }
                        }
                      }
                    }
                  }
                },
                "summary": "Check if IP/URL is blocked",
                "description": "Action used to block IP/URL",
                "operationId": "[variables('_operationId-CheckIFIP_URLBlocked')]"
              }
            },
            "/api/v2/cmdb/firewall/address/{name}": {
              "get": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "http_method": {
                          "type": "string",
                          "description": "http_method to call the API",
                          "title": "http_method"
                        },
                        "revision": {
                          "type": "string",
                          "description": "revision of an address object",
                          "title": "revision"
                        },
                        "results": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string",
                                "description": "Name of an address object",
                                "title": "name"
                              },
                              "q_origin_key": {
                                "type": "string",
                                "description": "q_origin_key of an address object",
                                "title": "q_orgin_key"
                              },
                              "uuid": {
                                "type": "string",
                                "description": "unique of an address object",
                                "title": "uuid"
                              },
                              "subnet": {
                                "type": "string",
                                "description": "subnet of an address object",
                                "title": "subnet"
                              },
                              "type": {
                                "type": "string",
                                "description": "type",
                                "title": "type"
                              },
                              "sub-type": {
                                "type": "string",
                                "description": "sub-type of an address object",
                                "title": "sub-type"
                              },
                              "clearpass-spt": {
                                "type": "string",
                                "description": "clearpass-spt of an address object",
                                "title": "clearpass-spt"
                              },
                              "start-mac": {
                                "type": "string",
                                "description": "start-mac of an address object",
                                "title": "start-mac"
                              },
                              "end-mac": {
                                "type": "string",
                                "description": "end-mac address of the address object",
                                "title": "end-mac"
                              },
                              "country": {
                                "type": "string",
                                "description": "country of the address object",
                                "title": "country"
                              },
                              "cache-ttl": {
                                "type": "integer",
                                "format": "int32",
                                "description": "cache-ttl of the address group",
                                "title": "cache-ttl"
                              },
                              "sdn": {
                                "type": "string",
                                "description": "sdn of an address object",
                                "title": "sdn"
                              },
                              "fsso-group": {
                                "type": "array",
                                "description": "fsso-group"
                              },
                              "interface": {
                                "type": "string",
                                "description": "interface of an address group",
                                "title": "interface"
                              },
                              "obj-type": {
                                "type": "string",
                                "description": "obj-type of an address object",
                                "title": "obj-type"
                              },
                              "comment": {
                                "type": "string",
                                "description": "comment of the address object",
                                "title": "comment"
                              },
                              "associated-interface": {
                                "type": "string",
                                "description": "associated-interface of the address object",
                                "title": "associated-interface"
                              },
                              "color": {
                                "type": "integer",
                                "format": "int32",
                                "description": "color of the address object",
                                "title": "color"
                              },
                              "filter": {
                                "type": "string",
                                "description": "filter of an address object",
                                "title": "filter"
                              },
                              "sdn-addr-type": {
                                "type": "string",
                                "description": "sdn-addr-type of an address object",
                                "title": "sdn-addr-type"
                              },
                              "obj-id": {
                                "type": "string",
                                "description": "obj-id  of an address object",
                                "title": "obj-id"
                              },
                              "list": {
                                "type": "array",
                                "description": "list"
                              },
                              "tagging": {
                                "type": "array",
                                "description": "tagging"
                              },
                              "allow-routing": {
                                "type": "string",
                                "description": "allow-routing of the address object",
                                "title": "allow-routing"
                              },
                              "fabric-object": {
                                "type": "string",
                                "description": "fabric-object of an address object",
                                "title": "fabric-object"
                              },
                              "start-ip": {
                                "type": "string",
                                "description": "start-ip of an address object",
                                "title": "start-ip"
                              },
                              "end-ip": {
                                "type": "string",
                                "description": "end-ip of the address object",
                                "title": "end-ip"
                              },
                              "obj-tag": {
                                "type": "string",
                                "description": "obj-tag of an address object",
                                "title": "obj-tag"
                              },
                              "fqdn": {
                                "type": "string",
                                "description": "fqdn of an address object",
                                "title": "fqdn"
                              }
                            }
                          },
                          "description": "results"
                        },
                        "vdom": {
                          "type": "string",
                          "description": "virtual domain of an address object",
                          "title": "vdom"
                        },
                        "path": {
                          "type": "string",
                          "description": "path of the address object",
                          "title": "path"
                        },
                        "name": {
                          "type": "string",
                          "description": "Name of the entities",
                          "title": "name"
                        },
                        "status": {
                          "type": "string",
                          "description": "status of an address object",
                          "title": "status"
                        },
                        "http_status": {
                          "type": "integer",
                          "format": "int32",
                          "description": "http_status"
                        },
                        "serial": {
                          "type": "string",
                          "description": "serial of an address object",
                          "title": "serial"
                        },
                        "version": {
                          "type": "string",
                          "description": "version of an address object",
                          "title": "version"
                        },
                        "build": {
                          "type": "integer",
                          "format": "int32",
                          "description": "build number",
                          "title": "build"
                        }
                      }
                    }
                  }
                },
                "summary": "Get an address object",
                "description": "Action used to fetch the details of particular address object",
                "operationId": "[variables('_operationId-GetAddressObject')]",
                "parameters": [
                  {
                    "name": "name",
                    "in": "path",
                    "required": true,
                    "type": "string",
                    "description": "Please enter address object name which you like get details"
                  }
                ]
              }
            }
          },
          "securityDefinitions": {
            "API Key": {
              "type": "apiKey",
              "in": "header",
              "name": "Authorization"
            }
          },
          "security": [
            {}
          ]
        }
      }
    },
    {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2021-06-01",
      "name": "[variables('playbook2-storageAccountName')]",
      "location": "[variables('playbook2-location')]",
      "sku": {
        "name": "[variables('playbook2-StorageAccount')]"
      },
      "kind": "Storage"
    },
    {
      "type": "Microsoft.Web/serverfarms",
      "apiVersion": "2020-06-01",
      "name": "[variables('playbook2-hostingPlanName')]",
      "location": "[variables('playbook2-location')]",
      "sku": {
        "name": "Y1",
        "tier": "Dynamic"
      },
      "properties": {
        "name": "[variables('playbook2-hostingPlanName')]",
        "computeMode": "Dynamic"
      }
    },
    {
      "type": "Microsoft.Web/sites",
      "apiVersion": "2020-06-01",
      "name": "[variables('playbook2-functionAppName')]",
      "location": "[variables('playbook2-location')]",
      "kind": "functionapp",
      "identity": {
        "type": "SystemAssigned"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Web/serverfarms', variables('playbook2-hostingPlanName'))]",
        "[resourceId('Microsoft.Storage/storageAccounts', variables('playbook2-storageAccountName'))]"
      ],
      "properties": {
        "serverFarmId": "[resourceId('Microsoft.Web/serverfarms', variables('playbook2-hostingPlanName'))]",
        "siteConfig": {
          "appSettings": [
            {
              "name": "AzureWebJobsStorage",
              "value": "[concat('DefaultEndpointsProtocol=https;AccountName=', variables('playbook2-storageAccountName'), ';EndpointSuffix=', environment().suffixes.storage, ';AccountKey=',listKeys(resourceId('Microsoft.Storage/storageAccounts', variables('playbook2-storageAccountName')), '2021-06-01').keys[0].value)]"
            },
            {
              "name": "WEBSITE_CONTENTAZUREFILECONNECTIONSTRING",
              "value": "[concat('DefaultEndpointsProtocol=https;AccountName=', variables('playbook2-storageAccountName'), ';EndpointSuffix=', environment().suffixes.storage, ';AccountKey=',listKeys(resourceId('Microsoft.Storage/storageAccounts', variables('playbook2-storageAccountName')), '2021-06-01').keys[0].value)]"
            },
            {
              "name": "WEBSITE_CONTENTSHARE",
              "value": "[toLower(variables('playbook2-functionAppName'))]"
            },
            {
              "name": "FUNCTIONS_EXTENSION_VERSION",
              "value": "~2"
            },
            {
              "name": "WEBSITE_NODE_DEFAULT_VERSION",
              "value": "~10"
            },
            {
              "name": "APPINSIGHTS_INSTRUMENTATIONKEY",
              "value": "[reference(resourceId('microsoft.insights/components', variables('playbook2-applicationInsightsName')), '2020-02-02').InstrumentationKey]"
            },
            {
              "name": "FUNCTIONS_WORKER_RUNTIME",
              "value": "[variables('playbook2-functionWorkerRuntime')]"
            },
            {
              "name": "Authorization",
              "value": "[concat('@','Microsoft.KeyVault(SecretUri=',variables('playbook2-SecretIdentifierofKeyvalut'),')')]"
            },
            {
              "name": "EndpointURL",
              "value": "[variables('playbook2-Endpoint')]"
            },
            {
              "name": "BaseURL",
              "value": "/api/v2/cmdb/firewall/"
            }
          ]
        },
        "cors": {
          "allowedOrigins": [
            "https://functions.azure.com",
            "https://functions-staging.azure.com",
            "https://functions-next.azure.com"
          ],
          "supportCredentials": false
        }
      }
    },
    {
      "type": "microsoft.insights/components",
      "apiVersion": "2020-02-02",
      "name": "[variables('playbook2-applicationInsightsName')]",
      "location": "[variables('playbook2-appInsightsLocation')]",
      "tags": {
        "[concat('hidden-link:', resourceId('Microsoft.Web/sites', variables('playbook2-applicationInsightsName')))]": "Resource"
      },
      "properties": {
        "ApplicationId": "[variables('playbook2-applicationInsightsName')]",
        "Request_Source": "IbizaWebAppExtensionCreate"
      }
    },
    {
      "apiVersion": "2019-08-01",
      "name": "[concat(variables('playbook2-FunctionappName'),'/', variables('playbook2-functionName'))]",
      "type": "Microsoft.Web/sites/functions",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', variables('playbook3-UserIdentifier'))]": {}
        }
      },
      "dependsOn": [
        "[resourceId('Microsoft.Web/serverfarms', variables('playbook2-hostingPlanName'))]",
        "[resourceId('Microsoft.Storage/storageAccounts', variables('playbook2-storageAccountName'))]",
        "[resourceId('Microsoft.Web/sites', variables('playbook2-functionAppName'))]"
      ],
      "properties": {
        "config": {
          "bindings": [
            {
              "name": "req",
              "webHookType": "genericJson",
              "direction": "in",
              "type": "httpTrigger",
              "authLevel": "anonymous"
            },
            {
              "name": "res",
              "direction": "out",
              "type": "http"
            }
          ]
        },
        "files": {
          "run.csx": "#r \"Newtonsoft.Json\"  #r \"System.Net.Http\"  using System.Net;  using Microsoft.AspNetCore.Mvc;  using Microsoft.Extensions.Primitives;  using Newtonsoft.Json;  using Newtonsoft.Json.Linq;  public static async Task<IActionResult> Run(HttpRequest req, ILogger log) { log.LogInformation(\"HTTP request recived.\");  var entity = req.Query[\"entity\"]; var filter = req.Query[\"filter\"]; var key = Environment.GetEnvironmentVariable(\"Authorization\", EnvironmentVariableTarget.Process); var endpointURL = Environment.GetEnvironmentVariable(\"EndpointURL\", EnvironmentVariableTarget.Process); var baseURL = Environment.GetEnvironmentVariable(\"BaseURL\", EnvironmentVariableTarget.Process); JToken results = null; log.LogInformation(filter); log.LogInformation(entity); var httpclient = new HttpClient(); var httpRequest = new HttpRequestMessage(HttpMethod.Get, new Uri(endpointURL + baseURL + entity + \"?\" + filter )); log.LogInformation(httpRequest.RequestUri.ToString()); httpRequest.Headers.Add(\"Authorization\", key.ToString()); var response = httpclient.SendAsync(httpRequest).Result; var responseJson = response.Content.ReadAsStringAsync().Result; if (responseJson != null) { JObject json = new JObject(); dynamic obj = JsonConvert.DeserializeObject(responseJson); json = (JObject)obj; results = json.SelectToken(\"results\"); return new OkObjectResult(results); } return new OkObjectResult(results); } "
        }
      }
    },
    {
      "properties": {
        "state": "Enabled",
        "definition": {
          "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
          "actions": {
            "Add_comment_to_incident_(V3)": {
              "runAfter": {
                "For_each_IP": [
                  "Succeeded"
                ]
              },
              "type": "ApiConnection",
              "inputs": {
                "body": {
                  "incidentArmId": "@triggerBody()?['object']?['id']",
                  "message": "<p>Fortinet Playbook ran and fetched the below Information:<br> @{variables('commentDes')}</p>"
                },
                "host": {
                  "connection": {
                    "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                  }
                },
                "method": "post",
                "path": "/Incidents/Comment"
              }
            },
            "Entities_-_Get_IPs": {
              "type": "ApiConnection",
              "inputs": {
                "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                "host": {
                  "connection": {
                    "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                  }
                },
                "method": "post",
                "path": "/entities/ip"
              },
              "description": "Get Entities get all IPs",
              "runtimeConfiguration": {
                "staticResult": {
                  "staticResultOptions": "Disabled",
                  "name": "Entities_-_Get_IPs0"
                }
              }
            },
            "For_each_IP": {
              "type": "Foreach",
              "foreach": "@body('Entities_-_Get_IPs')?['IPs']",
              "actions": {
                "Condition_to_check_if_Ip_address_already_present_in_list_of_address_objects": {
                  "type": "If",
                  "expression": {
                    "and": [
                      {
                        "greater": [
                          "@length(body('Parse_JSON_for_address_object_dynamic_content'))",
                          0
                        ]
                      }
                    ]
                  },
                  "actions": {
                    "Append_to_array_variable_address_object_details": {
                      "type": "AppendToStringVariable",
                      "inputs": {
                        "name": "commentDes",
                        "value": "@body('Create_HTML_table_address_object_details')"
                      },
                      "runAfter": {
                        "Create_HTML_table_address_object_details": [
                          "Succeeded"
                        ]
                      },
                      "description": "This appends address object details"
                    },
                    "Condition_to_check_if_Ip_already_present_in_predefined_address_group": {
                      "type": "If",
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(body('Filter_array_address_name_from_address_group'))",
                              0
                            ]
                          }
                        ]
                      },
                      "actions": {
                        "Append_to_string_variable": {
                          "type": "AppendToStringVariable",
                          "inputs": {
                            "name": "commentDes",
                            "value": "There is an address object for this IP and this address object is a part of address group. "
                          }
                        },
                        "Append_to_string_variable_comment_address_group_details": {
                          "type": "AppendToStringVariable",
                          "inputs": {
                            "name": "commentDes",
                            "value": "Below are the details: Address group details: @{body('Create_HTML_table_for_address_group_details')} Address object details:"
                          },
                          "runAfter": {
                            "Create_HTML_table_for_address_group_details": [
                              "Succeeded"
                            ]
                          }
                        },
                        "Create_HTML_table_for_address_group_details": {
                          "type": "Table",
                          "inputs": {
                            "from": "@body('Parse_JSON_for_address_group_dynamic_content')",
                            "format": "HTML",
                            "columns": [
                              {
                                "header": "name",
                                "value": "@item()['name']"
                              },
                              {
                                "header": "groupId",
                                "value": "@item()['uuid']"
                              },
                              {
                                "header": "type",
                                "value": "@item()['type']"
                              },
                              {
                                "header": "q_origin_key",
                                "value": "@item()['q_origin_key']"
                              },
                              {
                                "header": "allow_routing",
                                "value": "@item()['allow-routing']"
                              }
                            ]
                          },
                          "runAfter": {
                            "Append_to_string_variable": [
                              "Succeeded"
                            ]
                          },
                          "description": "This creates table of objects from address group"
                        }
                      },
                      "runAfter": {
                        "Filter_array_address_name_from_address_group": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Append_to_string_variable_comment_if_address_object_exist": {
                            "type": "AppendToStringVariable",
                            "inputs": {
                              "name": "commentDes",
                              "value": "There is an address object for this IP and this address object is not a part of predefined address group. Below are the address object details:"
                            }
                          }
                        }
                      },
                      "description": "condition to check the malicious IP address is present in the predefined address group"
                    },
                    "Create_HTML_table_address_object_details": {
                      "type": "Table",
                      "inputs": {
                        "from": "@body('Parse_JSON_for_address_object_dynamic_content')",
                        "format": "HTML",
                        "columns": [
                          {
                            "header": "name",
                            "value": "@item()['name']"
                          },
                          {
                            "header": "type",
                            "value": "@item()?['type']"
                          },
                          {
                            "header": "start-ip",
                            "value": "@item()?['start-ip']"
                          },
                          {
                            "header": "end-ip",
                            "value": "@item()?['end-ip']"
                          },
                          {
                            "header": "q_origin_key",
                            "value": "@item()['q_origin_key']"
                          },
                          {
                            "header": "start-mac",
                            "value": "@item()?['start-mac']"
                          },
                          {
                            "header": "end-mac",
                            "value": "@item()?['end-mac']"
                          },
                          {
                            "header": "addressobjectid",
                            "value": "@item()?['uuid']"
                          },
                          {
                            "header": "allow-routing",
                            "value": "@item()?['allow-routing']"
                          }
                        ]
                      },
                      "runAfter": {
                        "Condition_to_check_if_Ip_already_present_in_predefined_address_group": [
                          "Succeeded"
                        ]
                      },
                      "description": "This create table of content for address object"
                    },
                    "Filter_array_address_name_from_address_group": {
                      "type": "Query",
                      "inputs": {
                        "from": "@body('Parse_JSON_for_address_group_dynamic_content')?[0]?['member']",
                        "where": "@contains(item()['name'], body('Parse_JSON_for_address_object_dynamic_content')?[0]?['name'])"
                      },
                      "description": "This filters the address name of address object from address group"
                    }
                  },
                  "runAfter": {
                    "Parse_JSON_for_address_group_dynamic_content": [
                      "Succeeded"
                    ]
                  },
                  "else": {
                    "actions": {
                      "Append_to_array_variable_comment": {
                        "type": "AppendToArrayVariable",
                        "inputs": {
                          "name": "Comment",
                          "value": "There is no address object for this IP"
                        }
                      }
                    }
                  },
                  "description": "This checks if Ip is a member of any of the list of address objects"
                },
                "Construct_filter_for_address_group": {
                  "type": "SetVariable",
                  "inputs": {
                    "name": "filter",
                    "value": "filter=member=@{concat('@',body('Parse_JSON_for_address_object_dynamic_content')[0]?['name'])}"
                  },
                  "runAfter": {
                    "Parse_JSON_for_address_object_dynamic_content": [
                      "Succeeded"
                    ]
                  }
                },
                "Construct_filter_for_address_object": {
                  "type": "SetVariable",
                  "inputs": {
                    "name": "filter",
                    "value": "filter=start-ip=@{concat('@',items('for_each_IP')?['Address'])}"
                  },
                  "description": "Filter construction to apply on get the details of address object API call"
                },
                "Fetch_the_details_of_the_address_object": {
                  "type": "Function",
                  "inputs": {
                    "method": "GET",
                    "queries": {
                      "entity": "address",
                      "filter": "@{variables('filter')}"
                    },
                    "authentication": {
                      "audience": "[environment().resourceManager]",
                      "identity": "[variables('playbook3-UserIdentifier')]",
                      "type": "ManagedServiceIdentity"
                    },
                    "function": {
                      "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/sites/',variables('playbook3-Functionappname'),'/functions/Fortinet-GetEntityDetails')]"
                    }
                  },
                  "runAfter": {
                    "Construct_filter_for_address_object": [
                      "Succeeded"
                    ]
                  },
                  "description": "This gets the address object details"
                },
                "Get_address_group_details": {
                  "type": "Function",
                  "inputs": {
                    "method": "GET",
                    "queries": {
                      "entity": "addrgrp",
                      "filter": "@variables('filter')"
                    },
                    "authentication": {
                      "audience": "[environment().resourceManager]",
                      "identity": "[variables('playbook3-UserIdentifier')]",
                      "type": "ManagedServiceIdentity"
                    },
                    "function": {
                      "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/sites/',variables('playbook3-Functionappname'),'/functions/Fortinet-GetEntityDetails')]"
                    }
                  },
                  "runAfter": {
                    "Construct_filter_for_address_group": [
                      "Succeeded"
                    ]
                  },
                  "description": "This gets the address group details"
                },
                "Parse_JSON_for_address_group_dynamic_content": {
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Parse_address_group_JSON')",
                    "schema": {
                      "items": {
                        "properties": {
                          "allow-routing": {
                            "description": "allow-routing of  of an address group",
                            "type": "string"
                          },
                          "color": {
                            "description": "color of  of an address group",
                            "type": "integer"
                          },
                          "comment": {
                            "description": "comment of  of an address group",
                            "type": "string"
                          },
                          "exclude": {
                            "description": "exclude of  of an address group",
                            "type": "string"
                          },
                          "exclude-member": {
                            "type": "array"
                          },
                          "fabric-object": {
                            "description": "fabric-object of  of an address group",
                            "type": "string"
                          },
                          "member": {
                            "items": {
                              "properties": {
                                "name": {
                                  "description": "member name",
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "description": "member q_origin_key",
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key"
                              ],
                              "type": "object"
                            },
                            "type": "array"
                          },
                          "name": {
                            "description": "name of an address group",
                            "type": "string"
                          },
                          "q_origin_key": {
                            "description": "q_origin_key of an address group",
                            "type": "string"
                          },
                          "tagging": {
                            "description": "tagging of an address group",
                            "type": "array"
                          },
                          "type": {
                            "description": "type of an address group",
                            "type": "string"
                          },
                          "uuid": {
                            "description": "uuid of an address group",
                            "type": "string"
                          }
                        },
                        "required": [
                          "name",
                          "q_origin_key",
                          "type",
                          "uuid",
                          "member",
                          "comment",
                          "exclude",
                          "exclude-member",
                          "color",
                          "tagging",
                          "allow-routing",
                          "fabric-object"
                        ],
                        "type": "object"
                      },
                      "type": "array"
                    }
                  },
                  "runAfter": {
                    "Parse_address_group_JSON": [
                      "Succeeded"
                    ]
                  },
                  "description": "Parse JSON for the address group dynamic content"
                },
                "Parse_JSON_for_address_object_dynamic_content": {
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Parse_JSON_for_the_address_object_body')",
                    "schema": {
                      "items": {
                        "properties": {
                          "allow-routing": {
                            "description": "Allow routing enabling and disabling",
                            "type": "string"
                          },
                          "associated-interface": {
                            "description": "Associated interface",
                            "type": "string"
                          },
                          "cache-ttl": {
                            "description": "cache-ttl of an address object",
                            "type": "integer"
                          },
                          "clearpass-spt": {
                            "description": "clearpass-spt of an address object",
                            "type": "string"
                          },
                          "color": {
                            "description": "color of an adddress object",
                            "type": "integer"
                          },
                          "comment": {
                            "description": "comment of an address object",
                            "type": "string"
                          },
                          "country": {
                            "description": "comment of an address object",
                            "type": "string"
                          },
                          "end-ip": {
                            "description": "end-ip of an address object",
                            "type": "string"
                          },
                          "end-mac": {
                            "description": "end-mac of an address object",
                            "type": "string"
                          },
                          "fabric-object": {
                            "description": "fabric-object of an address object",
                            "type": "string"
                          },
                          "filter": {
                            "description": "filter of an address object",
                            "type": "string"
                          },
                          "fsso-group": {
                            "description": "fsso of an address object",
                            "type": "array"
                          },
                          "interface": {
                            "description": "type of an address object",
                            "type": "string"
                          },
                          "list": {
                            "description": "List of an address object",
                            "type": "array"
                          },
                          "name": {
                            "description": "Name of an address object",
                            "type": "string"
                          },
                          "obj-id": {
                            "description": "obj-id of an address object",
                            "type": "string"
                          },
                          "obj-type": {
                            "description": "obj-type of an address object",
                            "type": "string"
                          },
                          "q_origin_key": {
                            "description": "q_origin_key of an address object",
                            "type": "string"
                          },
                          "sdn": {
                            "description": "sdn of an address object",
                            "type": "string"
                          },
                          "sdn-addr-type": {
                            "description": "sdn-addr-type of an address object",
                            "type": "string"
                          },
                          "start-ip": {
                            "description": "start-ip of an address object",
                            "type": "string"
                          },
                          "start-mac": {
                            "description": "start-mac of an address object",
                            "type": "string"
                          },
                          "sub-type": {
                            "description": "sub-type of an address object",
                            "type": "string"
                          },
                          "tagging": {
                            "description": "tagging of an address object",
                            "type": "array"
                          },
                          "type": {
                            "description": "type of an address object",
                            "type": "string"
                          },
                          "uuid": {
                            "description": "UUid of an address object",
                            "type": "string"
                          }
                        },
                        "required": [
                          "name",
                          "q_origin_key"
                        ],
                        "type": "object"
                      },
                      "type": "array"
                    }
                  },
                  "runAfter": {
                    "Parse_JSON_for_the_address_object_body": [
                      "Succeeded"
                    ]
                  },
                  "description": "Parse JSON for the address object dynamic content"
                },
                "Parse_JSON_for_the_address_object_body": {
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Fetch_the_details_of_the_address_object')",
                    "schema": {
                      "$schema": "http://json-schema.org/draft-04/schema#",
                      "items": [
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-tag": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-tag",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        }
                      ],
                      "type": "array"
                    }
                  },
                  "runAfter": {
                    "Fetch_the_details_of_the_address_object": [
                      "Succeeded"
                    ]
                  },
                  "description": "Parse body of the address object"
                },
                "Parse_address_group_JSON": {
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Get_address_group_details')",
                    "schema": {
                      "$schema": "http://json-schema.org/draft-04/schema#",
                      "items": [
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "exclude": {
                              "type": "string"
                            },
                            "exclude-member": {
                              "type": "array"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "member": {
                              "items": [
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                },
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                },
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                },
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                }
                              ],
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "type",
                            "uuid",
                            "member",
                            "comment",
                            "exclude",
                            "exclude-member",
                            "color",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        }
                      ],
                      "type": "array"
                    }
                  },
                  "runAfter": {
                    "Get_address_group_details": [
                      "Succeeded"
                    ]
                  },
                  "description": "To parse the output of the function address group in to JSON"
                }
              },
              "runAfter": {
                "Initialize_variable_comment_Description": [
                  "Succeeded"
                ]
              },
              "description": "loops on each malicious IP"
            },
            "Initialize_variable_comment_": {
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "Comment",
                    "type": "array"
                  }
                ]
              },
              "runAfter": {
                "Entities_-_Get_IPs": [
                  "Succeeded"
                ]
              },
              "description": "This is used to comment in the incident"
            },
            "Initialize_variable_comment_Description": {
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "commentDes",
                    "type": "string"
                  }
                ]
              },
              "runAfter": {
                "Initialize_variable_filter": [
                  "Succeeded"
                ]
              }
            },
            "Initialize_variable_filter": {
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "filter",
                    "type": "string"
                  }
                ]
              },
              "runAfter": {
                "Initialize_variable_comment_": [
                  "Succeeded"
                ]
              },
              "description": "Initialize variable for function call to apply filter on API call"
            }
          },
          "parameters": {
            "$connections": {
              "type": "Object"
            }
          },
          "triggers": {
            "When_Azure_Sentinel_incident_creation_rule_was_triggered_(Private_Preview_only)": {
              "type": "ApiConnectionWebhook",
              "inputs": {
                "body": {
                  "callback_url": "@{listCallbackUrl()}"
                },
                "host": {
                  "connection": {
                    "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                  }
                },
                "path": "/incident-creation"
              }
            }
          },
          "contentVersion": "1.0.0.0",
          "staticResults": {
            "Entities_-_Get_IPs0": {
              "status": "Succeeded",
              "outputs": {
                "body": {
                  "IPs": [
                    {
                      "Address": "81.42.197.222"
                    }
                  ]
                },
                "statusCode": "OK"
              }
            }
          }
        },
        "parameters": {
          "$connections": {
            "value": {
              "azuresentinel": {
                "connectionId": "[resourceId('Microsoft.Web/connections', variables('playbook3-AzureSentinelConnectionName'))]",
                "connectionName": "[variables('playbook3-AzureSentinelConnectionName')]",
                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('workspace-location'), '/managedApis/azuresentinel')]"
              }
            }
          }
        }
      },
      "name": "[parameters('playbook3-Playbook Name')]",
      "type": "Microsoft.Logic/workflows",
      "location": "[parameters('workspace-location')]",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', variables('playbook3-UserIdentifier'))]": {}
        }
      },
      "apiVersion": "2019-05-01",
      "tags": {
        "displayName": "LogicApp"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Web/connections', variables('playbook3-AzureSentinelConnectionName'))]"
      ]
    },
    {
      "type": "Microsoft.Web/connections",
      "apiVersion": "2018-07-01-preview",
      "name": "[variables('playbook3-AzureSentinelConnectionName')]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "api": {
          "id": "[variables('_playbook-3-connection-2')]"
        }
      }
    },
    {
      "type": "Microsoft.Web/connections",
      "apiVersion": "2018-07-01-preview",
      "name": "[variables('playbook4-FortinetConnectorConnectionName')]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "api": {
          "id": "[variables('_playbook-4-connection-1')]"
        }
      }
    },
    {
      "type": "Microsoft.Web/connections",
      "apiVersion": "2018-07-01-preview",
      "name": "[variables('playbook4-AzureSentinelConnectionName')]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "api": {
          "id": "[variables('_playbook-3-connection-2')]"
        }
      }
    },
    {
      "type": "Microsoft.Web/connections",
      "apiVersion": "2018-07-01-preview",
      "name": "[variables('playbook4-TeamsConnectionName')]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "api": {
          "id": "[variables('_playbook-4-connection-3')]"
        }
      }
    },
    {
      "type": "Microsoft.Logic/workflows",
      "apiVersion": "2019-05-01",
      "name": "[parameters('playbook4-playbook Name')]",
      "location": "[parameters('workspace-location')]",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', variables('playbook4-UserIdentifier'))]": {}
        }
      },
      "dependsOn": [
        "[resourceId('Microsoft.Web/connections', variables('playbook4-FortinetConnectorConnectionName'))]",
        "[resourceId('Microsoft.Web/connections', variables('playbook4-AzureSentinelConnectionName'))]",
        "[resourceId('Microsoft.Web/connections', variables('playbook4-TeamsConnectionName'))]"
      ],
      "properties": {
        "state": "Enabled",
        "definition": {
          "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
          "contentVersion": "1.0.0.0",
          "parameters": {
            "$connections": {
              "type": "Object"
            }
          },
          "triggers": {
            "When_Azure_Sentinel_incident_creation_rule_was_triggered_(Private_Preview_only)": {
              "type": "ApiConnectionWebhook",
              "inputs": {
                "body": {
                  "callback_url": "@{listCallbackUrl()}"
                },
                "host": {
                  "connection": {
                    "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                  }
                },
                "path": "/incident-creation"
              }
            }
          },
          "actions": {
            "Condition_based_on_the_incident_configuration_from_adaptive_card": {
              "actions": {
                "Add_comment_to_incident_(V3)_3": {
                  "type": "ApiConnection",
                  "inputs": {
                    "body": {
                      "incidentArmId": "@triggerBody()?['object']?['id']",
                      "message": "<p>Fortinet Playbook ran and performed the following actions:<br> @{variables('Comments')}<br> Actions taken on Sentinel : Add comment to incident and closure with classification reason &nbsp;: @{body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2')['data']['incidentStatus']}</p>"
                    },
                    "host": {
                      "connection": {
                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                      }
                    },
                    "method": "post",
                    "path": "/Incidents/Comment"
                  }
                },
                "Update_incident": {
                  "runAfter": {
                    "Add_comment_to_incident_(V3)_3": [
                      "Succeeded"
                    ]
                  },
                  "type": "ApiConnection",
                  "inputs": {
                    "body": {
                      "classification": {
                        "ClassificationAndReason": "@{body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2')['data']['incidentStatus']}"
                      },
                      "incidentArmId": "@triggerBody()?['object']?['id']",
                      "severity": "@{body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2')['data']['incidentSeverity']}",
                      "status": "Closed"
                    },
                    "host": {
                      "connection": {
                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                      }
                    },
                    "method": "put",
                    "path": "/Incidents"
                  }
                }
              },
              "runAfter": {
                "For_each": [
                  "Succeeded"
                ]
              },
              "else": {
                "actions": {
                  "Add_comment_to_incident_(V3)": {
                    "type": "ApiConnection",
                    "inputs": {
                      "body": {
                        "incidentArmId": "@triggerBody()?['object']?['id']",
                        "message": "<p>Fortinet Playbook ran and performed the following actions:<br> @{variables('Comments')}<br> Actions taken on Sentinel : Add comment to incident&nbsp;</p>"
                      },
                      "host": {
                        "connection": {
                          "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                        }
                      },
                      "method": "post",
                      "path": "/Incidents/Comment"
                    }
                  }
                }
              },
              "expression": {
                "and": [
                  {
                    "equals": [
                      "@body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2')?['submitActionId']",
                      "Change incident configuration"
                    ]
                  }
                ]
              },
              "type": "If",
              "description": "This decides the action taken on the summarized adaptive card"
            },
            "Entities_-_Get_IPs": {
              "type": "ApiConnection",
              "inputs": {
                "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                "host": {
                  "connection": {
                    "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                  }
                },
                "method": "post",
                "path": "/entities/ip"
              }
            },
            "For_each": {
              "foreach": "@body('Entities_-_Get_IPs')?['IPs']",
              "actions": {
                "Append_to_string_variable_for_comment": {
                  "runAfter": {
                    "Create_HTML_table_comment": [
                      "Succeeded"
                    ]
                  },
                  "type": "AppendToStringVariable",
                  "inputs": {
                    "name": "Comments",
                    "value": "@body('Create_HTML_table_comment')"
                  }
                },
                "Create_HTML_table_comment": {
                  "type": "Table",
                  "inputs": {
                    "columns": [
                      {
                        "header": "URL_Address",
                        "value": "@items('For_each')?['Address']"
                      },
                      {
                        "header": "Action_Taken",
                        "value": "@variables('actionName')"
                      }
                    ],
                    "format": "HTML",
                    "from": "@variables('IPAddressAction')"
                  },
                  "description": "Construct HTML table for the comment"
                }
              },
              "runAfter": {
                "Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2": [
                  "Succeeded"
                ]
              },
              "type": "Foreach"
            },
            "For_each_malicious_IP": {
              "foreach": "@body('Entities_-_Get_IPs')?['IPs']",
              "actions": {
                "Address_group_details": {
                  "runAfter": {
                    "Set_variable_filter_for_address_group_function_call": [
                      "Succeeded"
                    ]
                  },
                  "type": "Function",
                  "inputs": {
                    "authentication": {
                      "audience": "[environment().resourceManager]",
                      "identity": "[variables('playbook4-UserIdentifier')]",
                      "type": "ManagedServiceIdentity"
                    },
                    "function": {
                      "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/sites/',variables('playbook4-Functionappname'),'/functions/Fortinet-GetEntityDetails')]"
                    },
                    "method": "GET",
                    "queries": {
                      "entity": "addrgrp",
                      "filter": "@{variables('filter')}"
                    }
                  },
                  "description": "This gets the address group details from fortinet"
                },
                "Check_address_object_is_already_exist_in_firewall": {
                  "runAfter": {
                    "Set_variable_filter_for_address_object_function_call": [
                      "Succeeded"
                    ]
                  },
                  "type": "Function",
                  "inputs": {
                    "authentication": {
                      "audience": "[environment().resourceManager]",
                      "identity": "[variables('playbook4-UserIdentifier')]",
                      "type": "ManagedServiceIdentity"
                    },
                    "function": {
                      "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/sites/',variables('playbook4-Functionappname'),'/functions/Fortinet-GetEntityDetails')]"
                    },
                    "method": "GET",
                    "queries": {
                      "entity": "address",
                      "filter": "@variables('filter')"
                    }
                  },
                  "description": "Getting the address object details from firewall"
                },
                "Condition_based_on_user_inputs_from_the_adaptive_card": {
                  "actions": {
                    "Append_to_variable_action_taken_on_IP_address": {
                      "runAfter": {
                        "Update_address_group": [
                          "Succeeded"
                        ]
                      },
                      "type": "AppendToArrayVariable",
                      "inputs": {
                        "name": "IPAddressAction",
                        "value": "IP Address : @{items('For_each_malicious_IP')?['Address']} ,  Action Taken :  @{body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3')['submitActionId']}  "
                      },
                      "description": "Append action taken and IP details to IPAddressAction"
                    },
                    "Condition_to_check_if_user_chosen_Block_IP": {
                      "actions": {
                        "Append_to_array_variable_for_new_address_object": {
                          "runAfter": {
                            "Create_an_address_object": [
                              "Succeeded"
                            ]
                          },
                          "type": "AppendToArrayVariable",
                          "inputs": {
                            "name": "memberCollection",
                            "value": {
                              "name": "@body('Create_an_address_object')?['mkey']",
                              "q_origin_key": "@body('Create_an_address_object')?['mkey']"
                            }
                          },
                          "description": "This appends address object to array variable for new address object"
                        },
                        "Create_an_address_object": {
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "end-ip": "@items('For_each_malicious_IP')?['Address']",
                              "name": "Fortinet_@{items('For_each_malicious_IP')?['Address']}",
                              "start-ip": "@items('For_each_malicious_IP')?['Address']",
                              "type": "iprange"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['FortinetConnector']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/api/v2/cmdb/firewall/address"
                          },
                          "description": "Create an address object to add an address in to firewall"
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "equals": [
                              "@body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3')['submitActionId']",
                              "Block IP"
                            ]
                          },
                          {
                            "equals": [
                              "@length(body('Parse_JSON_for_address_object_dynamic_content'))",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If",
                      "description": "This check if user chooses Block IP"
                    },
                    "Update_address_group": {
                      "runAfter": {
                        "Condition_to_check_if_user_chosen_Block_IP": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "body": {
                          "member": "@variables('memberCollection')",
                          "name": "@variables('Pre-definedGroupName')"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['FortinetConnector']['connectionId']"
                          }
                        },
                        "method": "put",
                        "path": "/api/v2/cmdb/firewall/addrgrp/@{encodeURIComponent(variables('Pre-definedGroupName'))}"
                      }
                    }
                  },
                  "runAfter": {
                    "Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3": [
                      "Succeeded"
                    ]
                  },
                  "else": {
                    "actions": {
                      "Append_to_array_variable": {
                        "type": "AppendToArrayVariable",
                        "inputs": {
                          "name": "IPAddressAction",
                          "value": "IP Address : @{items('For_each_malicious_IP')?['Address']} ,  Action Taken :  @{body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3')['submitActionId']} ,  Status :  Success    "
                        }
                      }
                    }
                  },
                  "expression": {
                    "and": [
                      {
                        "not": {
                          "equals": [
                            "@body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3')['submitActionId']",
                            "Ignore"
                          ]
                        }
                      }
                    ]
                  },
                  "type": "If",
                  "description": "condition to check the submit action is block / unblock or Ignore"
                },
                "Condition_to_check_if_Ip_address_already_present_in_list_of_address_objects": {
                  "actions": {
                    "Condition_to_check_if_Ip_already_present_in_predefined_address_group": {
                      "actions": {
                        "Append_to_adaptive_card_body_if_IP_is_a_member_of_blocked_address_group": {
                          "type": "AppendToArrayVariable",
                          "inputs": {
                            "name": "adaptivecardBody",
                            "value": {
                              "text": "The IP  @{items('For_each_malicious_IP')?['Address']} is already a member of the blocked address group",
                              "type": "TextBlock",
                              "wrap": true
                            }
                          },
                          "description": "This appends the text to display If Ip is a member of blocked address group"
                        },
                        "For_each_address_object": {
                          "foreach": "@body('Parse_JSON_for_address_object_dynamic_content')",
                          "actions": {
                            "Filter_array_address_objects_to_remove_from_address_group": {
                              "type": "Query",
                              "inputs": {
                                "from": "@variables('memberCollection')",
                                "where": "@not(equals(item()?['name'], items('For_each_address_object')['name']))"
                              },
                              "description": "This filter is used to remove address objects if already exist"
                            },
                            "Set_variable_address_group_members_in_unblock_case": {
                              "runAfter": {
                                "Filter_array_address_objects_to_remove_from_address_group": [
                                  "Succeeded"
                                ]
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "memberCollection",
                                "value": "@body('Filter_array_address_objects_to_remove_from_address_group')"
                              },
                              "description": "This sets the address group members"
                            }
                          },
                          "runAfter": {
                            "Set_dynamic_action_name_variable_to_unblock": [
                              "Succeeded"
                            ]
                          },
                          "type": "Foreach",
                          "description": "For each address object member"
                        },
                        "Set_dynamic_action_name_variable_to_unblock": {
                          "runAfter": {
                            "Append_to_adaptive_card_body_if_IP_is_a_member_of_blocked_address_group": [
                              "Succeeded"
                            ]
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "actionName",
                            "value": "UnBlock IP"
                          },
                          "description": "variable to set action name dynamically"
                        }
                      },
                      "runAfter": {
                        "Filter_array_address_name_from_address_group": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Append_to_adaptive_card_body_text_if_IP_is_not_a_member_of_blocked_address_group": {
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "adaptivecardBody",
                              "value": {
                                "text": "The IP  @{items('For_each_malicious_IP')?['Address']} is not a member of the blocked address group ",
                                "type": "TextBlock",
                                "wrap": true
                              }
                            },
                            "description": "This appends the text to display If Ip is a member of blocked address group"
                          },
                          "For_each_address_object_member": {
                            "foreach": "@body('Parse_JSON_for_address_object_dynamic_content')",
                            "actions": {
                              "Append_to_array_variable_address_object_group": {
                                "type": "AppendToArrayVariable",
                                "inputs": {
                                  "name": "memberCollection",
                                  "value": {
                                    "name": "@items('For_each_address_object_member')['name']",
                                    "q_origin_key": "@items('For_each_address_object_member')['name']"
                                  }
                                },
                                "description": "This appends address object members to existing members"
                              }
                            },
                            "runAfter": {
                              "Set_dynamic_variable_action_name": [
                                "Succeeded"
                              ]
                            },
                            "type": "Foreach"
                          },
                          "Set_dynamic_variable_action_name": {
                            "runAfter": {
                              "Append_to_adaptive_card_body_text_if_IP_is_not_a_member_of_blocked_address_group": [
                                "Succeeded"
                              ]
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "actionName",
                              "value": "Block IP"
                            },
                            "description": "variable to set action name dynamically"
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(body('Filter_array_address_name_from_address_group'))",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If",
                      "description": "condition to check the malicious IP address is present in the predefined address group"
                    },
                    "Filter_array_address_name_from_address_group": {
                      "type": "Query",
                      "inputs": {
                        "from": "@body('Parse_JSON_for_address_group_dynamic_content')?[0]?['member']",
                        "where": "@equals(item()?['name'], body('Parse_JSON_for_address_object_dynamic_content')?[0]?['name'])"
                      },
                      "description": "This filters the address name of address object from address group"
                    }
                  },
                  "runAfter": {
                    "Set_variable_address_group_members": [
                      "Succeeded"
                    ]
                  },
                  "else": {
                    "actions": {
                      "Append_to_adaptive_card_body_if_IP_is_not_a_member_of_blocked_address_group": {
                        "type": "AppendToArrayVariable",
                        "inputs": {
                          "name": "adaptivecardBody",
                          "value": {
                            "text": "The IP @{items('For_each_malicious_IP')?['Address']} is not a member of the blocked address group ",
                            "type": "TextBlock",
                            "wrap": true
                          }
                        },
                        "description": "This appends the text to display If Ip is not a member of blocked address group"
                      },
                      "For_each_new_IP": {
                        "foreach": "@body('Parse_JSON_for_address_object_dynamic_content')",
                        "actions": {
                          "Append_to_address_group_members_in_case_of_new_IP": {
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "memberCollection",
                              "value": {
                                "name": "@items('For_each_new_IP')['name']",
                                "q_origin_key": "@items('For_each_new_IP')['name']"
                              }
                            },
                            "description": "Appends address objects to existing object"
                          }
                        },
                        "runAfter": {
                          "Set_variable_address_group_members_in_case_of_new_address_object": [
                            "Succeeded"
                          ]
                        },
                        "type": "Foreach",
                        "description": "iterates on address object body for each new IP"
                      },
                      "Set_variable_action_name_to_Block_Ip": {
                        "runAfter": {
                          "Append_to_adaptive_card_body_if_IP_is_not_a_member_of_blocked_address_group": [
                            "Succeeded"
                          ]
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "actionName",
                          "value": "Block IP"
                        },
                        "description": "This sets the variable block IP"
                      },
                      "Set_variable_address_group_members_in_case_of_new_address_object": {
                        "runAfter": {
                          "Set_variable_action_name_to_Block_Ip": [
                            "Succeeded"
                          ]
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "memberCollection",
                          "value": "@body('Parse_JSON_for_address_group_dynamic_content')?[0]?['member']"
                        },
                        "description": "This sets address group members"
                      }
                    }
                  },
                  "expression": {
                    "and": [
                      {
                        "greater": [
                          "@length(body('Parse_JSON_for_address_object_dynamic_content'))",
                          0
                        ]
                      }
                    ]
                  },
                  "type": "If",
                  "description": "This checks if Ip is a member of any of the list of address objects"
                },
                "Parse_JSON_for_address_group_dynamic_content": {
                  "runAfter": {
                    "Parse_address_group_JSON": [
                      "Succeeded"
                    ]
                  },
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Parse_address_group_JSON')",
                    "schema": {
                      "items": {
                        "properties": {
                          "allow-routing": {
                            "description": "allow-routing of  of an address group",
                            "type": "string"
                          },
                          "color": {
                            "description": "color of  of an address group",
                            "type": "integer"
                          },
                          "comment": {
                            "description": "comment of  of an address group",
                            "type": "string"
                          },
                          "exclude": {
                            "description": "exclude of  of an address group",
                            "type": "string"
                          },
                          "exclude-member": {
                            "type": "array"
                          },
                          "fabric-object": {
                            "description": "fabric-object of  of an address group",
                            "type": "string"
                          },
                          "member": {
                            "items": {
                              "properties": {
                                "name": {
                                  "description": "member name",
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "description": "member q_origin_key",
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key"
                              ],
                              "type": "object"
                            },
                            "type": "array"
                          },
                          "name": {
                            "description": "name of an address group",
                            "type": "string"
                          },
                          "q_origin_key": {
                            "description": "q_origin_key of an address group",
                            "type": "string"
                          },
                          "tagging": {
                            "description": "tagging of an address group",
                            "type": "array"
                          },
                          "type": {
                            "description": "type of an address group",
                            "type": "string"
                          },
                          "uuid": {
                            "description": "uuid of an address group",
                            "type": "string"
                          }
                        },
                        "required": [
                          "name",
                          "q_origin_key",
                          "type",
                          "uuid",
                          "member",
                          "comment",
                          "exclude",
                          "exclude-member",
                          "color",
                          "tagging",
                          "allow-routing",
                          "fabric-object"
                        ],
                        "type": "object"
                      },
                      "type": "array"
                    }
                  }
                },
                "Parse_JSON_for_address_object_dynamic_content": {
                  "runAfter": {
                    "Parse_address_object_JSON": [
                      "Succeeded"
                    ]
                  },
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Parse_address_object_JSON')",
                    "schema": {
                      "items": {
                        "properties": {
                          "allow-routing": {
                            "description": "Allow routing enabling and disabling",
                            "type": "string"
                          },
                          "associated-interface": {
                            "description": "Associated interface",
                            "type": "string"
                          },
                          "cache-ttl": {
                            "description": "cache-ttl of an address object",
                            "type": "integer"
                          },
                          "clearpass-spt": {
                            "description": "clearpass-spt of an address object",
                            "type": "string"
                          },
                          "color": {
                            "description": "color of an adddress object",
                            "type": "integer"
                          },
                          "comment": {
                            "description": "comment of an address object",
                            "type": "string"
                          },
                          "country": {
                            "description": "comment of an address object",
                            "type": "string"
                          },
                          "end-ip": {
                            "description": "end-ip of an address object",
                            "type": "string"
                          },
                          "end-mac": {
                            "description": "end-mac of an address object",
                            "type": "string"
                          },
                          "fabric-object": {
                            "description": "fabric-object of an address object",
                            "type": "string"
                          },
                          "filter": {
                            "description": "filter of an address object",
                            "type": "string"
                          },
                          "fsso-group": {
                            "description": "fsso of an address object",
                            "type": "array"
                          },
                          "interface": {
                            "description": "type of an address object",
                            "type": "string"
                          },
                          "list": {
                            "description": "List of an address object",
                            "type": "array"
                          },
                          "name": {
                            "description": "Name of an address object",
                            "type": "string"
                          },
                          "obj-id": {
                            "description": "obj-id of an address object",
                            "type": "string"
                          },
                          "obj-type": {
                            "description": "obj-type of an address object",
                            "type": "string"
                          },
                          "q_origin_key": {
                            "description": "q_origin_key of an address object",
                            "type": "string"
                          },
                          "sdn": {
                            "description": "sdn of an address object",
                            "type": "string"
                          },
                          "sdn-addr-type": {
                            "description": "sdn-addr-type of an address object",
                            "type": "string"
                          },
                          "start-ip": {
                            "description": "start-ip of an address object",
                            "type": "string"
                          },
                          "start-mac": {
                            "description": "start-mac of an address object",
                            "type": "string"
                          },
                          "sub-type": {
                            "description": "sub-type of an address object",
                            "type": "string"
                          },
                          "tagging": {
                            "description": "tagging of an address object",
                            "type": "array"
                          },
                          "type": {
                            "description": "type of an address object",
                            "type": "string"
                          },
                          "uuid": {
                            "description": "UUid of an address object",
                            "type": "string"
                          }
                        },
                        "required": [
                          "name",
                          "q_origin_key"
                        ],
                        "type": "object"
                      },
                      "type": "array"
                    }
                  },
                  "description": "Parse body content and create dynamic content"
                },
                "Parse_address_group_JSON": {
                  "runAfter": {
                    "Address_group_details": [
                      "Succeeded"
                    ]
                  },
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Address_group_details')",
                    "schema": {
                      "$schema": "http://json-schema.org/draft-04/schema#",
                      "items": [
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "exclude": {
                              "type": "string"
                            },
                            "exclude-member": {
                              "type": "array"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "member": {
                              "items": [
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                },
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                },
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                },
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                }
                              ],
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "type",
                            "uuid",
                            "member",
                            "comment",
                            "exclude",
                            "exclude-member",
                            "color",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        }
                      ],
                      "type": "array"
                    }
                  },
                  "description": "To parse the output of the function address group in to JSON"
                },
                "Parse_address_object_JSON": {
                  "runAfter": {
                    "Check_address_object_is_already_exist_in_firewall": [
                      "Succeeded"
                    ]
                  },
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Check_address_object_is_already_exist_in_firewall')",
                    "schema": {
                      "$schema": "http://json-schema.org/draft-04/schema#",
                      "items": [
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-tag": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-tag",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-ip": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-ip": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "start-ip",
                            "end-ip",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "subnet": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "subnet",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        },
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "associated-interface": {
                              "type": "string"
                            },
                            "cache-ttl": {
                              "type": "integer"
                            },
                            "clearpass-spt": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "country": {
                              "type": "string"
                            },
                            "end-mac": {
                              "type": "string"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "filter": {
                              "type": "string"
                            },
                            "fqdn": {
                              "type": "string"
                            },
                            "fsso-group": {
                              "type": "array"
                            },
                            "interface": {
                              "type": "string"
                            },
                            "list": {
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "obj-id": {
                              "type": "string"
                            },
                            "obj-type": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "sdn": {
                              "type": "string"
                            },
                            "sdn-addr-type": {
                              "type": "string"
                            },
                            "start-mac": {
                              "type": "string"
                            },
                            "sub-type": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "uuid",
                            "type",
                            "sub-type",
                            "clearpass-spt",
                            "start-mac",
                            "end-mac",
                            "fqdn",
                            "country",
                            "cache-ttl",
                            "sdn",
                            "fsso-group",
                            "interface",
                            "obj-type",
                            "comment",
                            "associated-interface",
                            "color",
                            "filter",
                            "sdn-addr-type",
                            "obj-id",
                            "list",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        }
                      ],
                      "type": "array"
                    }
                  },
                  "description": "To parse the output of the function address object in to JSON"
                },
                "Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3": {
                  "runAfter": {
                    "Condition_to_check_if_Ip_address_already_present_in_list_of_address_objects": [
                      "Succeeded"
                    ]
                  },
                  "type": "ApiConnectionWebhook",
                  "inputs": {
                    "body": {
                      "body": {
                        "messageBody": "{     \"type\": \"AdaptiveCard\",     \"body\":@{variables('adaptivecardBody')} ,      \"actions\": [   {     \"title\": \"@{variables('actionName')}\",     \"type\": \"Action.Submit\"   },   {     \"title\": \"Ignore\",     \"type\": \"Action.Submit\"   } ],     \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",     \"version\": \"1.2\" }",
                        "recipient": {
                          "channelId": "19:7abc1180c1d84a3fba83770e34231132@thread.tacv2"
                        },
                        "shouldUpdateCard": true
                      },
                      "notificationUrl": "@{listCallbackUrl()}"
                    },
                    "host": {
                      "connection": {
                        "name": "@parameters('$connections')['teams']['connectionId']"
                      }
                    },
                    "path": "/flowbot/actions/flowcontinuation/recipienttypes/channel/$subscriptions",
                    "queries": {
                      "groupId": "18de1100-ab2e-4505-be42-8263b915b221"
                    }
                  }
                },
                "Set_variable_adaptive_card_body": {
                  "type": "SetVariable",
                  "inputs": {
                    "name": "adaptivecardBody",
                    "value": [
                      {
                        "size": "Large",
                        "text": "Suspicious IP - Azure Sentinel",
                        "type": "TextBlock",
                        "weight": "Bolder",
                        "wrap": true
                      },
                      {
                        "text": "Possible Comprised IP  detected by the provider ",
                        "type": "TextBlock",
                        "wrap": true
                      },
                      {
                        "text": " @{triggerBody()?['object']?['properties']?['severity']} Incident  @{triggerBody()?['object']?['properties']?['title']}",
                        "type": "TextBlock",
                        "weight": "Bolder",
                        "wrap": true
                      },
                      {
                        "text": " Incident No :  @{triggerBody()?['object']?['properties']?['incidentNumber']} ",
                        "type": "TextBlock",
                        "weight": "Bolder",
                        "wrap": true
                      },
                      {
                        "text": "Incident description",
                        "type": "TextBlock",
                        "weight": "Bolder",
                        "wrap": true
                      },
                      {
                        "text": "@{triggerBody()?['object']?['properties']?['description']}",
                        "type": "TextBlock",
                        "wrap": true
                      },
                      {
                        "text": "[[[Click here to view the Incident](@{triggerBody()?['object']?['properties']?['incidentUrl']})",
                        "type": "TextBlock",
                        "wrap": true
                      },
                      {
                        "size": "Medium",
                        "text": "Response in Fortinet-Fortigate",
                        "type": "TextBlock",
                        "weight": "Bolder"
                      },
                      {
                        "size": "Small",
                        "style": "Person",
                        "type": "Image",
                        "url": "https://www.fortinet.com/content/dam/fortinet-blog/article-images/individual-images/logo.png"
                      }
                    ]
                  },
                  "description": "variable to hold adaptive card body"
                },
                "Set_variable_address_group_members": {
                  "runAfter": {
                    "Parse_JSON_for_address_group_dynamic_content": [
                      "Succeeded"
                    ]
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "memberCollection",
                    "value": "@body('Parse_JSON_for_address_group_dynamic_content')?[0]?['member']"
                  },
                  "description": "assign list of address group members"
                },
                "Set_variable_filter_for_address_group_function_call": {
                  "runAfter": {
                    "Parse_JSON_for_address_object_dynamic_content": [
                      "Succeeded"
                    ]
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "filter",
                    "value": "filter=name=@{concat('@',variables('Pre-definedGroupName'))}"
                  },
                  "description": "This sets the variable filter for address group azure function"
                },
                "Set_variable_filter_for_address_object_function_call": {
                  "runAfter": {
                    "Set_variable_adaptive_card_body": [
                      "Succeeded"
                    ]
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "filter",
                    "value": "filter=start-ip=@{concat('@',items('For_each_malicious_IP')?['Address'])}"
                  },
                  "description": "This sets the variable filter for address object azure function"
                }
              },
              "runAfter": {
                "Initialize_variable_comments": [
                  "Succeeded"
                ]
              },
              "type": "Foreach",
              "description": "For each IP which incident contains",
              "runtimeConfiguration": {
                "concurrency": {
                  "repetitions": 1
                }
              }
            },
            "Initialize_variable_IP_address_action": {
              "runAfter": {
                "Initialize_variable_adaptive_card_body": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "IPAddressAction",
                    "type": "array"
                  }
                ]
              },
              "description": "This holds the action taken on each IP "
            },
            "Initialize_variable_action_name": {
              "runAfter": {
                "Entities_-_Get_IPs": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "actionName",
                    "type": "string"
                  }
                ]
              },
              "description": "variable to store action name to be displayed on adaptive card"
            },
            "Initialize_variable_adaptive_card_body": {
              "runAfter": {
                "Initialize_variable_address_group_members": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "adaptivecardBody",
                    "type": "array"
                  }
                ]
              },
              "description": "variable to store adaptive card body json"
            },
            "Initialize_variable_address_group_members": {
              "runAfter": {
                "Initialize_variable_action_name": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "memberCollection",
                    "type": "array"
                  }
                ]
              },
              "description": "Array variable to assign member collection of pre-defined address group"
            },
            "Initialize_variable_comments": {
              "runAfter": {
                "Initialize_variable_pre-defined_group": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "Comments",
                    "type": "string"
                  }
                ]
              }
            },
            "Initialize_variable_filter": {
              "runAfter": {
                "Initialize_variable_IP_address_action": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "filter",
                    "type": "string"
                  }
                ]
              },
              "description": "This is used to hold the filter condition to use in the azure function"
            },
            "Initialize_variable_pre-defined_group": {
              "runAfter": {
                "Initialize_variable_filter": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "Pre-definedGroupName",
                    "type": "string",
                    "value": "Sentinel IP Block"
                  }
                ]
              },
              "description": "Pre-defined group name"
            },
            "Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2": {
              "runAfter": {
                "Set_variable_actions_on_IP_to_be_displayed_on_adaptive_card": [
                  "Succeeded"
                ]
              },
              "type": "ApiConnectionWebhook",
              "inputs": {
                "body": {
                  "body": {
                    "messageBody": "{     \"type\": \"AdaptiveCard\",     \"body\": [         {             \"type\": \"TextBlock\",                         \"weight\": \"Bolder\",             \"text\": \"Below is the summary of actions taken on IP's by SOC\",             \"wrap\": true         },   {     \"size\": \"Small\",     \"style\": \"Person\",     \"type\": \"Image\",     \"url\": \"https://www.fortinet.com/content/dam/fortinet-blog/article-images/individual-images/logo.png\"   },      {   \"columns\": [     {       \"items\":@{body('Set_variable_actions_on_IP_to_be_displayed_on_adaptive_card')} ,       \"type\": \"Column\",       \"wrap\": true     }   ],   \"separator\": \"true\",   \"type\": \"ColumnSet\",   \"width\": \"stretch\" },  {     \"text\": \" Incident No :  @{triggerBody()?['object']?['properties']?['incidentNumber']} \",     \"type\": \"TextBlock\",     \"weight\": \"Bolder\",     \"wrap\": true   },         {             \"type\": \"TextBlock\",             \"text\": \"[Click here to view the Incident](@{triggerBody()?['object']?['properties']?['incidentUrl']})\",             \"wrap\": true         },         {             \"type\": \"ColumnSet\",             \"columns\": [                 {                     \"type\": \"Column\",                     \"items\": [                         {                             \"type\": \"TextBlock\",                             \"size\": \"Medium\",                             \"weight\": \"Bolder\",                             \"text\": \"Incident configuration :\",                             \"wrap\": true                         }                     ],                     \"width\": \"auto\"                 }             ]         },         {             \"type\": \"ColumnSet\",             \"columns\": [                 {                     \"type\": \"Column\",                     \"items\": [                         {                             \"type\": \"Image\",                             \"style\": \"Person\",                             \"url\": \"https://connectoricons-prod.azureedge.net/releases/v1.0.1391/1.0.1391.2130/azuresentinel/icon.png\",                             \"size\": \"Small\"                         }                     ],                     \"width\": \"auto\"                 }             ]         },         {             \"type\": \"TextBlock\",             \"text\": \"Close Azure Sentinal incident?\"         },         {             \"choices\": [                 {                     \"isSelected\": true,                     \"title\": \"False Positive - Inaccurate Data\",                     \"value\": \"False Positive - Inaccurate Data\"                 },                 {                     \"isSelected\": true,                     \"title\": \"False Positive - Incorrect Alert Logic\",                     \"value\": \"False Positive - Incorrect Alert Logic\"                 },                 {                     \"title\": \"True Positive - Suspicious Activity\",                     \"value\": \"True Positive - Suspicious Activity\"                 },                 {                     \"title\": \"Benign Positive - Suspicious But Expected\",                     \"value\": \"Benign Positive - Suspicious But Expected\"                 },                 {                     \"title\": \"Undetermined\",                     \"value\": \"Undetermined\"                 }             ],             \"id\": \"incidentStatus\",             \"style\": \"compact\",             \"type\": \"Input.ChoiceSet\",             \"value\": \"Benign Positive - Suspicious But Expected\"         },         {             \"type\": \"TextBlock\",             \"text\": \"Change Azure Sentinel Incident Severity?\"         },         {             \"choices\": [                 {                                        \"title\": \"High\",                     \"value\": \"High\"                 },                 {                     \"title\": \"Medium\",                     \"value\": \"Medium\"                 },                 {                     \"title\": \"Low\",                     \"value\": \"Low\"                 },                 {                     \"title\": \"Don't change\",                     \"value\": \"same\"                 }             ],             \"id\": \"incidentSeverity\",             \"style\": \"compact\",             \"type\": \"Input.ChoiceSet\",             \"value\": \"@{triggerBody()?['object']?['properties']?['severity']}\"         }                            ], \"width\":\"auto\",    \"actions\": [                     {                         \"type\": \"Action.Submit\",                         \"title\": \"Change incident configuration\"                     },  {                         \"type\": \"Action.Submit\",                         \"title\": \"Ignore\"                     }    ],     \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",     \"version\": \"1.2\" }",
                    "recipient": {
                      "channelId": "19:7abc1180c1d84a3fba83770e34231132@thread.tacv2"
                    },
                    "shouldUpdateCard": true
                  },
                  "notificationUrl": "@{listCallbackUrl()}"
                },
                "host": {
                  "connection": {
                    "name": "@parameters('$connections')['teams']['connectionId']"
                  }
                },
                "path": "/flowbot/actions/flowcontinuation/recipienttypes/channel/$subscriptions",
                "queries": {
                  "groupId": "18de1100-ab2e-4505-be42-8263b915b221"
                }
              }
            },
            "Set_variable_actions_on_IP_to_be_displayed_on_adaptive_card": {
              "runAfter": {
                "For_each_malicious_IP": [
                  "Succeeded"
                ]
              },
              "type": "Select",
              "inputs": {
                "from": "@variables('IPAddressAction')",
                "select": {
                  "text": "@item()",
                  "type": "TextBlock"
                }
              }
            }
          }
        },
        "parameters": {
          "$connections": {
            "value": {
              "FortinetConnector": {
                "connectionId": "[resourceId('Microsoft.Web/connections', variables('playbook4-FortinetConnectorConnectionName'))]",
                "connectionName": "[variables('playbook4-FortinetConnectorConnectionName')]",
                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/FortinetConnector')]"
              },
              "azuresentinel": {
                "connectionId": "[resourceId('Microsoft.Web/connections', variables('playbook4-AzureSentinelConnectionName'))]",
                "connectionName": "[variables('playbook4-AzureSentinelConnectionName')]",
                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('workspace-location'), '/managedApis/azuresentinel')]"
              },
              "teams": {
                "connectionId": "[resourceId('Microsoft.Web/connections', variables('playbook4-TeamsConnectionName'))]",
                "connectionName": "[variables('playbook4-TeamsConnectionName')]",
                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('workspace-location'), '/managedApis/teams')]"
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Web/connections",
      "apiVersion": "2018-07-01-preview",
      "name": "[variables('playbook5-FortinetConnectorConnectionName')]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "api": {
          "id": "[variables('_playbook-4-connection-1')]"
        }
      }
    },
    {
      "type": "Microsoft.Web/connections",
      "apiVersion": "2018-07-01-preview",
      "name": "[variables('playbook5-AzureSentinelConnectionName')]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "api": {
          "id": "[variables('_playbook-3-connection-2')]"
        }
      }
    },
    {
      "type": "Microsoft.Web/connections",
      "apiVersion": "2018-07-01-preview",
      "name": "[variables('playbook5-TeamsConnectionName')]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "api": {
          "id": "[variables('_playbook-4-connection-3')]"
        }
      }
    },
    {
      "type": "Microsoft.Logic/workflows",
      "apiVersion": "2019-05-01",
      "name": "[parameters('playbook5-PlayBook Name')]",
      "location": "[parameters('workspace-location')]",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', variables('playbook5-UserIdentifier'))]": {}
        }
      },
      "dependsOn": [
        "[resourceId('Microsoft.Web/connections', variables('playbook5-FortinetConnectorConnectionName'))]",
        "[resourceId('Microsoft.Web/connections', variables('playbook5-AzureSentinelConnectionName'))]",
        "[resourceId('Microsoft.Web/connections', variables('playbook5-TeamsConnectionName'))]"
      ],
      "properties": {
        "state": "Enabled",
        "definition": {
          "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
          "contentVersion": "1.0.0.0",
          "parameters": {
            "$connections": {
              "type": "Object"
            }
          },
          "triggers": {
            "When_Azure_Sentinel_incident_creation_rule_was_triggered_(Private_Preview_only)": {
              "type": "ApiConnectionWebhook",
              "inputs": {
                "body": {
                  "callback_url": "@{listCallbackUrl()}"
                },
                "host": {
                  "connection": {
                    "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                  }
                },
                "path": "/incident-creation"
              }
            }
          },
          "actions": {
            "Compose_actions_on_URL_to_be_displayed_on_adaptive_card": {
              "runAfter": {
                "For_each_malicious_URL": [
                  "Succeeded"
                ]
              },
              "type": "Select",
              "inputs": {
                "from": "@variables('URLAddressAction')",
                "select": {
                  "text": "@item()",
                  "type": "TextBlock"
                }
              },
              "description": "This is used to compose the list of actions taken by SOC on respective URL addresses"
            },
            "Condition_based_on_the_incident_configuration_from_adaptive_card": {
              "actions": {
                "Add_comment_to_incident_(V3)_3": {
                  "type": "ApiConnection",
                  "inputs": {
                    "body": {
                      "incidentArmId": "@triggerBody()?['object']?['id']",
                      "message": "<p>Fortinet Playbook ran and performed the following actions:<br> @{variables('Comment')}<br> Actions taken on Sentinel : Add comment to incident and closure with classification reason &nbsp;: @{body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2')['data']['incidentStatus']}</p>"
                    },
                    "host": {
                      "connection": {
                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                      }
                    },
                    "method": "post",
                    "path": "/Incidents/Comment"
                  }
                },
                "Update_incident": {
                  "runAfter": {
                    "Add_comment_to_incident_(V3)_3": [
                      "Succeeded"
                    ]
                  },
                  "type": "ApiConnection",
                  "inputs": {
                    "body": {
                      "classification": {
                        "ClassificationAndReason": "@{body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2')['data']['incidentStatus']}"
                      },
                      "incidentArmId": "@triggerBody()?['object']?['id']",
                      "severity": "@{body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2')['data']['incidentSeverity']}",
                      "status": "Closed"
                    },
                    "host": {
                      "connection": {
                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                      }
                    },
                    "method": "put",
                    "path": "/Incidents"
                  }
                }
              },
              "runAfter": {
                "For_each": [
                  "Succeeded"
                ]
              },
              "else": {
                "actions": {
                  "Add_comment_to_incident_(V3)": {
                    "type": "ApiConnection",
                    "inputs": {
                      "body": {
                        "incidentArmId": "@triggerBody()?['object']?['id']",
                        "message": "<p>Fortinet Playbook ran and performed the following actions:<br> @{variables('Comment')}<br> Actions taken on Sentinel : Add comment to incident&nbsp;</p>"
                      },
                      "host": {
                        "connection": {
                          "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                        }
                      },
                      "method": "post",
                      "path": "/Incidents/Comment"
                    }
                  }
                }
              },
              "expression": {
                "and": [
                  {
                    "equals": [
                      "@body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2')?['submitActionId']",
                      "Change incident configuration"
                    ]
                  }
                ]
              },
              "type": "If",
              "description": "This decides the action taken on the summarized adaptive card"
            },
            "Entities_-_Get_URLs": {
              "type": "ApiConnection",
              "inputs": {
                "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                "host": {
                  "connection": {
                    "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                  }
                },
                "method": "post",
                "path": "/entities/url"
              }
            },
            "For_each": {
              "foreach": "@body('Entities_-_Get_URLs')?['URLs']",
              "actions": {
                "Append_to_string_variable": {
                  "runAfter": {
                    "Create_HTML_table_for_Comment": [
                      "Succeeded"
                    ]
                  },
                  "type": "AppendToStringVariable",
                  "inputs": {
                    "name": "Comment",
                    "value": "@body('Create_HTML_table_for_Comment')"
                  }
                },
                "Create_HTML_table_for_Comment": {
                  "type": "Table",
                  "inputs": {
                    "columns": [
                      {
                        "header": "URL_Address",
                        "value": "@items('For_each')?['Url']"
                      },
                      {
                        "header": "Action_Taken",
                        "value": "@variables('actionName')"
                      }
                    ],
                    "format": "HTML",
                    "from": "@variables('URLAddressAction')"
                  },
                  "description": "Construct HTML table for the comment"
                }
              },
              "runAfter": {
                "Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2": [
                  "Succeeded"
                ]
              },
              "type": "Foreach"
            },
            "For_each_malicious_URL": {
              "foreach": "@body('Entities_-_Get_URLs')?['URLs']",
              "actions": {
                "Address_group_details": {
                  "runAfter": {
                    "Set_variable_filter_for_address_group_function_call": [
                      "Succeeded"
                    ]
                  },
                  "type": "Function",
                  "inputs": {
                    "authentication": {
                      "audience": "[environment().resourceManager]",
                      "identity": "[variables('playbook5-UserIdentifier')]",
                      "type": "ManagedServiceIdentity"
                    },
                    "function": {
                      "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/sites/',variables('playbook5-functionappname'),'/functions/Fortinet-GetEntityDetails')]"
                    },
                    "queries": {
                      "entity": "addrgrp",
                      "filter": "@{variables('filter')}"
                    }
                  },
                  "description": "This gets the address group details from fortinet"
                },
                "Check_address_object_is_already_exist_in_firewall": {
                  "runAfter": {
                    "Set_variable_filter_for_address_object_function_call": [
                      "Succeeded"
                    ]
                  },
                  "type": "Function",
                  "inputs": {
                    "authentication": {
                      "audience": "[environment().resourceManager]",
                      "identity": "[variables('playbook5-UserIdentifier')]",
                      "type": "ManagedServiceIdentity"
                    },
                    "function": {
                      "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/sites/',variables('playbook5-functionappname'),'/functions/Fortinet-GetEntityDetails')]"
                    },
                    "method": "GET",
                    "queries": {
                      "entity": "address",
                      "filter": "@variables('filter')"
                    }
                  },
                  "description": "Getting the address object details from firewall"
                },
                "Condition_based_on_user_inputs_from_the_adaptive_card": {
                  "actions": {
                    "Append_to_array_variable_action_taken_on_URL_address": {
                      "runAfter": {
                        "Update_pre-defined_address_group": [
                          "Succeeded"
                        ]
                      },
                      "type": "AppendToArrayVariable",
                      "inputs": {
                        "name": "URLAddressAction",
                        "value": "URL Address : @{items('For_each_malicious_URL')?['Url']} ,  Action Taken :  @{body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3')['submitActionId']}  "
                      }
                    },
                    "Condition_to_check_if_user_chosen_Block_URL": {
                      "actions": {
                        "Append_to_array_variable_for_new_address_object": {
                          "runAfter": {
                            "Create_an_address_object": [
                              "Succeeded"
                            ]
                          },
                          "type": "AppendToArrayVariable",
                          "inputs": {
                            "name": "memberCollection",
                            "value": {
                              "name": "@body('Create_an_address_object')?['mkey']",
                              "q_origin_key": "@body('Create_an_address_object')?['mkey']"
                            }
                          },
                          "description": "This appends address object to array variable for new address object"
                        },
                        "Create_an_address_object": {
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "fqdn": "@{items('For_each_malicious_URL')?['Address']}",
                              "name": "@{items('For_each_malicious_URL')?['Address']}",
                              "type": "fqdn"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['FortinetConnector']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/api/v2/cmdb/firewall/address"
                          },
                          "description": "Create an address object"
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "equals": [
                              "@body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3')['submitActionId']",
                              "Block URL"
                            ]
                          },
                          {
                            "equals": [
                              "@length(body('Parse_JSON_for_address_object_dynamic_content'))",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If",
                      "description": "This check if user chooses Block URL"
                    },
                    "Update_pre-defined_address_group": {
                      "runAfter": {
                        "Condition_to_check_if_user_chosen_Block_URL": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "body": {
                          "member": "@variables('memberCollection')",
                          "name": "@variables('Pre-definedGroupName')"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['FortinetConnector']['connectionId']"
                          }
                        },
                        "method": "put",
                        "path": "/api/v2/cmdb/firewall/addrgrp/@{encodeURIComponent(variables('Pre-definedGroupName'))}"
                      }
                    }
                  },
                  "runAfter": {
                    "Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3": [
                      "Succeeded"
                    ]
                  },
                  "else": {
                    "actions": {
                      "Append_to_array_variable_URL_address_action": {
                        "type": "AppendToArrayVariable",
                        "inputs": {
                          "name": "URLAddressAction",
                          "value": "URL Address : @{items('For_each_malicious_URL')?['Url']} ,  Action Taken :  @{body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3')['submitActionId']}"
                        },
                        "description": "This appends the array variable action taken on URL"
                      }
                    }
                  },
                  "expression": {
                    "and": [
                      {
                        "not": {
                          "equals": [
                            "@body('Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3')['submitActionId']",
                            "Ignore"
                          ]
                        }
                      }
                    ]
                  },
                  "type": "If",
                  "description": "condition to check the submit action is block / unblock or Ignore"
                },
                "Condition_to_check_if_URL_address_already_present_in_list_of_address_objects": {
                  "actions": {
                    "Condition_to_check_if_URL_already_present_in_predefined_address_group": {
                      "actions": {
                        "Append_to_adaptive_card_if_URL_is_a_member_of_blocked_address_group": {
                          "type": "AppendToArrayVariable",
                          "inputs": {
                            "name": "adaptivecardBody",
                            "value": {
                              "text": "The URL  @{items('For_each_malicious_URL')?['Address']} is already a member of the blocked address group",
                              "type": "TextBlock",
                              "wrap": true
                            }
                          },
                          "description": "This appends the text to display If URL is a member of blocked address group"
                        },
                        "For_each_address_object": {
                          "foreach": "@body('Parse_JSON_for_address_object_dynamic_content')",
                          "actions": {
                            "Filter_array_address_objects_to_remove_from_address_group": {
                              "type": "Query",
                              "inputs": {
                                "from": "@variables('memberCollection')",
                                "where": "@not(equals(item()?['name'], items('For_each_address_object')['name']))"
                              },
                              "description": "This filter is used to remove address objects if already exist"
                            },
                            "Set_variable_address_group_members_in_unblock_case": {
                              "runAfter": {
                                "Filter_array_address_objects_to_remove_from_address_group": [
                                  "Succeeded"
                                ]
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "memberCollection",
                                "value": "@body('Filter_array_address_objects_to_remove_from_address_group')"
                              },
                              "description": "This sets the address group members"
                            }
                          },
                          "runAfter": {
                            "Set_dynamic_variable_action_name_to_unblock": [
                              "Succeeded"
                            ]
                          },
                          "type": "Foreach",
                          "description": "For each address object member"
                        },
                        "Set_dynamic_variable_action_name_to_unblock": {
                          "runAfter": {
                            "Append_to_adaptive_card_if_URL_is_a_member_of_blocked_address_group": [
                              "Succeeded"
                            ]
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "actionName",
                            "value": "UnBlock URL"
                          },
                          "description": "variable to set action name dynamically"
                        }
                      },
                      "runAfter": {
                        "Filter_array_address_name_from_address_group": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Append_to_adaptive_card_text_if_URL_is_not_a_member_of_blocked_address_group": {
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "adaptivecardBody",
                              "value": {
                                "text": "The URL  @{items('For_each_malicious_URL')?['Address']} is not a member of the blocked address group ",
                                "type": "TextBlock",
                                "wrap": true
                              }
                            },
                            "description": "This appends the text to display If URL is a member of blocked address group"
                          },
                          "For_each_address_object_member": {
                            "foreach": "@body('Parse_JSON_for_address_object_dynamic_content')",
                            "actions": {
                              "Append_to_array_variable_address_object_group": {
                                "type": "AppendToArrayVariable",
                                "inputs": {
                                  "name": "memberCollection",
                                  "value": {
                                    "name": "@items('For_each_address_object_member')['name']",
                                    "q_origin_key": "@items('For_each_address_object_member')['name']"
                                  }
                                },
                                "description": "This appends address object members to existing members"
                              }
                            },
                            "runAfter": {
                              "Set_dynamic_variable_action_name_to_block": [
                                "Succeeded"
                              ]
                            },
                            "type": "Foreach"
                          },
                          "Set_dynamic_variable_action_name_to_block": {
                            "runAfter": {
                              "Append_to_adaptive_card_text_if_URL_is_not_a_member_of_blocked_address_group": [
                                "Succeeded"
                              ]
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "actionName",
                              "value": "Block URL"
                            },
                            "description": "variable to set action name dynamically"
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(body('Filter_array_address_name_from_address_group'))",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If",
                      "description": "condition to check the malicious URL address is present in the predefined address group"
                    },
                    "Filter_array_address_name_from_address_group": {
                      "type": "Query",
                      "inputs": {
                        "from": "@body('Parse_JSON_for_address_group_dynamic_content')?[0]?['member']",
                        "where": "@equals(item()?['name'], body('Parse_JSON_for_address_object_dynamic_content')?[0]?['name'])"
                      },
                      "description": "This filters the address name of address object from address group"
                    }
                  },
                  "runAfter": {
                    "Set_variable_address_group_members": [
                      "Succeeded"
                    ]
                  },
                  "else": {
                    "actions": {
                      "Append_to_adaptive_card_body_if_URL_is_not_a_member_of_blocked_address_group": {
                        "type": "AppendToArrayVariable",
                        "inputs": {
                          "name": "adaptivecardBody",
                          "value": {
                            "text": "The URL @{items('For_each_malicious_URL')?['Address']} is not a member of the blocked address group ",
                            "type": "TextBlock",
                            "wrap": true
                          }
                        },
                        "description": "This appends the text to display If URL is not a member of blocked address group"
                      },
                      "For_each_new_URL": {
                        "foreach": "@body('Parse_JSON_for_address_object_dynamic_content')",
                        "actions": {
                          "Append_to_address_group_members_in_case_of_new_URL": {
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "memberCollection",
                              "value": {
                                "name": "@items('For_each_new_URL')['name']",
                                "q_origin_key": "@items('For_each_new_URL')['name']"
                              }
                            },
                            "description": "Appends address objects to existing object"
                          }
                        },
                        "runAfter": {
                          "Set_variable_address_group_members_in_case_of_new_address_object": [
                            "Succeeded"
                          ]
                        },
                        "type": "Foreach",
                        "description": "iterates on address object body for each new URL"
                      },
                      "Set_variable_action_name_to_Block_URL": {
                        "runAfter": {
                          "Append_to_adaptive_card_body_if_URL_is_not_a_member_of_blocked_address_group": [
                            "Succeeded"
                          ]
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "actionName",
                          "value": "Block URL"
                        },
                        "description": "This sets the variable block URL"
                      },
                      "Set_variable_address_group_members_in_case_of_new_address_object": {
                        "runAfter": {
                          "Set_variable_action_name_to_Block_URL": [
                            "Succeeded"
                          ]
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "memberCollection",
                          "value": "@body('Parse_JSON_for_address_group_dynamic_content')?[0]?['member']"
                        },
                        "description": "This sets address group members"
                      }
                    }
                  },
                  "expression": {
                    "and": [
                      {
                        "greater": [
                          "@length(body('Parse_JSON_for_address_object_dynamic_content'))",
                          0
                        ]
                      }
                    ]
                  },
                  "type": "If",
                  "description": "This checks if URL is a member of any of the list of address objects"
                },
                "Parse_JSON_for_address_group_dynamic_content": {
                  "runAfter": {
                    "Parse_address_group_JSON": [
                      "Succeeded"
                    ]
                  },
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Parse_address_group_JSON')",
                    "schema": {
                      "items": {
                        "properties": {
                          "allow-routing": {
                            "description": "allow-routing of  of an address group",
                            "type": "string"
                          },
                          "color": {
                            "description": "color of  of an address group",
                            "type": "integer"
                          },
                          "comment": {
                            "description": "comment of  of an address group",
                            "type": "string"
                          },
                          "exclude": {
                            "description": "exclude of  of an address group",
                            "type": "string"
                          },
                          "exclude-member": {
                            "type": "array"
                          },
                          "fabric-object": {
                            "description": "fabric-object of  of an address group",
                            "type": "string"
                          },
                          "member": {
                            "items": {
                              "properties": {
                                "name": {
                                  "description": "member name",
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "description": "member q_origin_key",
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key"
                              ],
                              "type": "object"
                            },
                            "type": "array"
                          },
                          "name": {
                            "description": "name of an address group",
                            "type": "string"
                          },
                          "q_origin_key": {
                            "description": "q_origin_key of an address group",
                            "type": "string"
                          },
                          "tagging": {
                            "description": "tagging of an address group",
                            "type": "array"
                          },
                          "type": {
                            "description": "type of an address group",
                            "type": "string"
                          },
                          "uuid": {
                            "description": "uuid of an address group",
                            "type": "string"
                          }
                        },
                        "required": [
                          "name",
                          "q_origin_key",
                          "type",
                          "uuid",
                          "member",
                          "comment",
                          "exclude",
                          "exclude-member",
                          "color",
                          "tagging",
                          "allow-routing",
                          "fabric-object"
                        ],
                        "type": "object"
                      },
                      "type": "array"
                    }
                  }
                },
                "Parse_JSON_for_address_object_dynamic_content": {
                  "runAfter": {
                    "Parse_address_object_JSON": [
                      "Succeeded"
                    ]
                  },
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Parse_address_object_JSON')",
                    "schema": {
                      "items": {
                        "properties": {
                          "allow-routing": {
                            "description": "allow-routing of  of an address object",
                            "type": "string"
                          },
                          "associated-interface": {
                            "description": "associated-interface of  of an address address object",
                            "type": "string"
                          },
                          "cache-ttl": {
                            "description": "cache-ttl of  of an address address object",
                            "type": "integer"
                          },
                          "clearpass-spt": {
                            "description": "clearpass-spt of  of an address address object",
                            "type": "string"
                          },
                          "color": {
                            "description": "color of  of an address address object",
                            "type": "integer"
                          },
                          "comment": {
                            "description": "comment of  of an address address object",
                            "type": "string"
                          },
                          "country": {
                            "description": "country of  of an address address object",
                            "type": "string"
                          },
                          "end-mac": {
                            "description": "end-mac of  of an address address object",
                            "type": "string"
                          },
                          "fabric-object": {
                            "description": "fabric-object of  of an address address object",
                            "type": "string"
                          },
                          "filter": {
                            "description": "filter of  of an address address object",
                            "type": "string"
                          },
                          "fqdn": {
                            "description": "fqdc of  of an address address object",
                            "type": "string"
                          },
                          "fsso-group": {
                            "description": "fsso-group of  of an address address object",
                            "type": "array"
                          },
                          "interface": {
                            "description": "interface of  of an address address object",
                            "type": "string"
                          },
                          "list": {
                            "description": "list of  of an address address object",
                            "type": "array"
                          },
                          "name": {
                            "decripation": "Name of address object",
                            "type": "string"
                          },
                          "obj-id": {
                            "description": "obj-id of  of an address address object",
                            "type": "string"
                          },
                          "obj-type": {
                            "description": "obj-type of  of an address address object",
                            "type": "string"
                          },
                          "q_origin_key": {
                            "description": "q_origin_key of  of an address address object",
                            "type": "string"
                          },
                          "sdn": {
                            "description": "sdn of  of an address address object",
                            "type": "string"
                          },
                          "sdn-addr-type": {
                            "description": "sdn-addr-type of  of an address address object",
                            "type": "string"
                          },
                          "start-mac": {
                            "description": "start-mac of  of an address address object",
                            "type": "string"
                          },
                          "sub-type": {
                            "description": "sub-type of  of an address address object",
                            "type": "string"
                          },
                          "tagging": {
                            "description": "tagging of  of an address address object",
                            "type": "array"
                          },
                          "type": {
                            "description": "type of  of an address address object",
                            "type": "string"
                          },
                          "uuid": {
                            "description": "uuid of  of an address address object",
                            "type": "string"
                          }
                        },
                        "required": [
                          "name",
                          "q_origin_key",
                          "uuid",
                          "type",
                          "sub-type",
                          "clearpass-spt",
                          "start-mac",
                          "end-mac",
                          "fqdn",
                          "country",
                          "cache-ttl",
                          "sdn",
                          "fsso-group",
                          "interface",
                          "obj-type",
                          "comment",
                          "associated-interface",
                          "color",
                          "filter",
                          "sdn-addr-type",
                          "obj-id",
                          "list",
                          "tagging",
                          "allow-routing",
                          "fabric-object"
                        ],
                        "type": "object"
                      },
                      "type": "array"
                    }
                  },
                  "description": "Parse body content and create dynamic content"
                },
                "Parse_address_group_JSON": {
                  "runAfter": {
                    "Address_group_details": [
                      "Succeeded"
                    ]
                  },
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Address_group_details')",
                    "schema": {
                      "$schema": "http://json-schema.org/draft-04/schema#",
                      "items": [
                        {
                          "properties": {
                            "allow-routing": {
                              "type": "string"
                            },
                            "color": {
                              "type": "integer"
                            },
                            "comment": {
                              "type": "string"
                            },
                            "exclude": {
                              "type": "string"
                            },
                            "exclude-member": {
                              "type": "array"
                            },
                            "fabric-object": {
                              "type": "string"
                            },
                            "member": {
                              "items": [
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                },
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                },
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                },
                                {
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                }
                              ],
                              "type": "array"
                            },
                            "name": {
                              "type": "string"
                            },
                            "q_origin_key": {
                              "type": "string"
                            },
                            "tagging": {
                              "type": "array"
                            },
                            "type": {
                              "type": "string"
                            },
                            "uuid": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name",
                            "q_origin_key",
                            "type",
                            "uuid",
                            "member",
                            "comment",
                            "exclude",
                            "exclude-member",
                            "color",
                            "tagging",
                            "allow-routing",
                            "fabric-object"
                          ],
                          "type": "object"
                        }
                      ],
                      "type": "array"
                    }
                  },
                  "description": "To parse the output of the function address group in to JSON"
                },
                "Parse_address_object_JSON": {
                  "runAfter": {
                    "Check_address_object_is_already_exist_in_firewall": [
                      "Succeeded"
                    ]
                  },
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@body('Check_address_object_is_already_exist_in_firewall')",
                    "schema": {
                      "items": {
                        "properties": {
                          "allow-routing": {
                            "type": "string"
                          },
                          "associated-interface": {
                            "type": "string"
                          },
                          "cache-ttl": {
                            "type": "integer"
                          },
                          "clearpass-spt": {
                            "type": "string"
                          },
                          "color": {
                            "type": "integer"
                          },
                          "comment": {
                            "type": "string"
                          },
                          "country": {
                            "type": "string"
                          },
                          "end-mac": {
                            "type": "string"
                          },
                          "fabric-object": {
                            "type": "string"
                          },
                          "filter": {
                            "type": "string"
                          },
                          "fqdn": {
                            "type": "string"
                          },
                          "fsso-group": {
                            "type": "array"
                          },
                          "interface": {
                            "type": "string"
                          },
                          "list": {
                            "type": "array"
                          },
                          "name": {
                            "type": "string"
                          },
                          "obj-id": {
                            "type": "string"
                          },
                          "obj-type": {
                            "type": "string"
                          },
                          "q_origin_key": {
                            "type": "string"
                          },
                          "sdn": {
                            "type": "string"
                          },
                          "sdn-addr-type": {
                            "type": "string"
                          },
                          "start-mac": {
                            "type": "string"
                          },
                          "sub-type": {
                            "type": "string"
                          },
                          "tagging": {
                            "type": "array"
                          },
                          "type": {
                            "type": "string"
                          },
                          "uuid": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "name",
                          "q_origin_key",
                          "uuid",
                          "type",
                          "sub-type",
                          "clearpass-spt",
                          "start-mac",
                          "end-mac",
                          "fqdn",
                          "country",
                          "cache-ttl",
                          "sdn",
                          "fsso-group",
                          "interface",
                          "obj-type",
                          "comment",
                          "associated-interface",
                          "color",
                          "filter",
                          "sdn-addr-type",
                          "obj-id",
                          "list",
                          "tagging",
                          "allow-routing",
                          "fabric-object"
                        ],
                        "type": "object"
                      },
                      "type": "array"
                    }
                  },
                  "description": "To parse the output of the function address object in to JSON"
                },
                "Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_3": {
                  "runAfter": {
                    "Condition_to_check_if_URL_address_already_present_in_list_of_address_objects": [
                      "Succeeded"
                    ]
                  },
                  "type": "ApiConnectionWebhook",
                  "inputs": {
                    "body": {
                      "body": {
                        "messageBody": "{     \"type\": \"AdaptiveCard\",     \"body\":@{variables('adaptivecardBody')} ,      \"actions\": [   {     \"title\": \"@{variables('actionName')}\",     \"type\": \"Action.Submit\"   },   {     \"title\": \"Ignore\",     \"type\": \"Action.Submit\"   } ],     \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",     \"version\": \"1.2\" }",
                        "recipient": {
                          "channelId": "19:7abc1180c1d84a3fba83770e34231132@thread.tacv2"
                        },
                        "shouldUpdateCard": true
                      },
                      "notificationUrl": "@{listCallbackUrl()}"
                    },
                    "host": {
                      "connection": {
                        "name": "@parameters('$connections')['teams']['connectionId']"
                      }
                    },
                    "path": "/flowbot/actions/flowcontinuation/recipienttypes/channel/$subscriptions",
                    "queries": {
                      "groupId": "18de1100-ab2e-4505-be42-8263b915b221"
                    }
                  }
                },
                "Set_variable_adaptive_card_body": {
                  "type": "SetVariable",
                  "inputs": {
                    "name": "adaptivecardBody",
                    "value": [
                      {
                        "size": "Large",
                        "text": "Suspicious URL - Azure Sentinel",
                        "type": "TextBlock",
                        "weight": "Bolder",
                        "wrap": true
                      },
                      {
                        "text": "Possible Comprised URL  detected by the provider",
                        "type": "TextBlock",
                        "wrap": true
                      },
                      {
                        "text": "@{triggerBody()?['object']?['properties']?['severity']}  Incident  @{triggerBody()?['object']?['properties']?['title']} ",
                        "type": "TextBlock",
                        "weight": "Bolder",
                        "wrap": true
                      },
                      {
                        "text": " Incident No : @{triggerBody()?['object']?['properties']?['incidentNumber']}  ",
                        "type": "TextBlock",
                        "weight": "Bolder",
                        "wrap": true
                      },
                      {
                        "text": "Incident description",
                        "type": "TextBlock",
                        "weight": "Bolder",
                        "wrap": true
                      },
                      {
                        "text": "@{triggerBody()?['object']?['properties']?['description']}",
                        "type": "TextBlock",
                        "wrap": true
                      },
                      {
                        "text": "[[[Click here to view the Incident](@{triggerBody()?['object']?['properties']?['incidentUrl']})",
                        "type": "TextBlock",
                        "wrap": true
                      },
                      {
                        "size": "Medium",
                        "text": "Response in Fortinet-Fortigate",
                        "type": "TextBlock",
                        "weight": "Bolder"
                      },
                      {
                        "size": "Small",
                        "style": "Person",
                        "type": "Image",
                        "url": "https://www.fortinet.com/content/dam/fortinet-blog/article-images/individual-images/logo.png"
                      }
                    ]
                  },
                  "description": "variable to hold adaptive card body"
                },
                "Set_variable_address_group_members": {
                  "runAfter": {
                    "Parse_JSON_for_address_group_dynamic_content": [
                      "Succeeded"
                    ]
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "memberCollection",
                    "value": "@body('Parse_JSON_for_address_group_dynamic_content')?[0]?['member']"
                  },
                  "description": "assign list of address group members"
                },
                "Set_variable_filter_for_address_group_function_call": {
                  "runAfter": {
                    "Parse_JSON_for_address_object_dynamic_content": [
                      "Succeeded"
                    ]
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "filter",
                    "value": "filter=name=@{concat('@',variables('Pre-definedGroupName'))}"
                  },
                  "description": "This sets the variable filter for address group azure function"
                },
                "Set_variable_filter_for_address_object_function_call": {
                  "runAfter": {
                    "Set_variable_adaptive_card_body": [
                      "Succeeded"
                    ]
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "filter",
                    "value": "filter=fqdn=@{concat('@',items('For_each_malicious_URL')?['Url'])}"
                  },
                  "description": "This sets the variable filter for address object azure function"
                }
              },
              "runAfter": {
                "Initialize_variable_comment": [
                  "Succeeded"
                ]
              },
              "type": "Foreach",
              "description": "For each URL which incident contains",
              "runtimeConfiguration": {
                "concurrency": {
                  "repetitions": 1
                }
              }
            },
            "Initialize_variable_Pre-definedGroupName": {
              "runAfter": {
                "Initialize_variable_filter": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "Pre-definedGroupName",
                    "type": "string",
                    "value": "Sentinel URL Block"
                  }
                ]
              },
              "description": "Pre-defined group name"
            },
            "Initialize_variable_URL_address_action": {
              "runAfter": {
                "Initialize_variable_adaptive_card_body": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "URLAddressAction",
                    "type": "array"
                  }
                ]
              },
              "description": "This holds the action taken on each URL "
            },
            "Initialize_variable_action_name": {
              "runAfter": {
                "Entities_-_Get_URLs": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "actionName",
                    "type": "string"
                  }
                ]
              },
              "description": "variable to store action name to be displayed on adaptive card"
            },
            "Initialize_variable_adaptive_card_body": {
              "runAfter": {
                "Initialize_variable_address_group_members": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "adaptivecardBody",
                    "type": "array"
                  }
                ]
              },
              "description": "variable to store adaptive card body json"
            },
            "Initialize_variable_address_group_members": {
              "runAfter": {
                "Initialize_variable_action_name": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "memberCollection",
                    "type": "array"
                  }
                ]
              },
              "description": "Array variable to assign member collection of pre-defined address group"
            },
            "Initialize_variable_comment": {
              "runAfter": {
                "Initialize_variable_Pre-definedGroupName": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "Comment",
                    "type": "string"
                  }
                ]
              }
            },
            "Initialize_variable_filter": {
              "runAfter": {
                "Initialize_variable_URL_address_action": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "filter",
                    "type": "string"
                  }
                ]
              },
              "description": "This is used to hold the filter condition to use in the azure function"
            },
            "Post_an_Adaptive_Card_to_a_Teams_channel_and_wait_for_a_response_2": {
              "runAfter": {
                "Compose_actions_on_URL_to_be_displayed_on_adaptive_card": [
                  "Succeeded"
                ]
              },
              "type": "ApiConnectionWebhook",
              "inputs": {
                "body": {
                  "body": {
                    "messageBody": "{     \"type\": \"AdaptiveCard\",     \"body\": [         {             \"type\": \"TextBlock\",                         \"weight\": \"Bolder\",             \"text\": \"Below is the summary of actions taken on URL's by SOC\",             \"wrap\": true         },  {     \"size\": \"Small\",     \"style\": \"Person\",     \"type\": \"Image\",     \"url\": \"https://www.fortinet.com/content/dam/fortinet-blog/article-images/individual-images/logo.png\"   },        {   \"columns\": [     {       \"items\":@{body('Compose_actions_on_URL_to_be_displayed_on_adaptive_card')} ,       \"type\": \"Column\",       \"wrap\": true     }   ],   \"separator\": \"true\",   \"type\": \"ColumnSet\",   \"width\": \"stretch\" },         {             \"type\": \"TextBlock\",             \"text\": \"[Click here to view the Incident]()\",             \"wrap\": true         },          {             \"type\": \"ColumnSet\",             \"columns\": [                 {                     \"type\": \"Column\",                     \"items\": [                         {                             \"type\": \"TextBlock\",                             \"size\": \"Medium\",                             \"weight\": \"Bolder\",                             \"text\": \"Incident configuration :\",                             \"wrap\": true                         }                     ],                     \"width\": \"auto\"                 }             ]         },         {             \"type\": \"ColumnSet\",             \"columns\": [                 {                     \"type\": \"Column\",                     \"items\": [                         {                             \"type\": \"Image\",                             \"style\": \"Person\",                             \"url\": \"https://connectoricons-prod.azureedge.net/releases/v1.0.1391/1.0.1391.2130/azuresentinel/icon.png\",                             \"size\": \"Small\"                         }                     ],                     \"width\": \"auto\"                 }             ]         },         {             \"type\": \"TextBlock\",             \"text\": \"Close Azure Sentinal incident?\"         },         {             \"choices\": [                 {                     \"isSelected\": true,                     \"title\": \"False Positive - Inaccurate Data\",                     \"value\": \"False Positive - Inaccurate Data\"                 },                 {                     \"isSelected\": true,                     \"title\": \"False Positive - Incorrect Alert Logic\",                     \"value\": \"False Positive - Incorrect Alert Logic\"                 },                 {                     \"title\": \"True Positive - Suspicious Activity\",                     \"value\": \"True Positive - Suspicious Activity\"                 },                 {                     \"title\": \"Benign Positive - Suspicious But Expected\",                     \"value\": \"Benign Positive - Suspicious But Expected\"                 },                 {                     \"title\": \"Undetermined\",                     \"value\": \"Undetermined\"                 }             ],             \"id\": \"incidentStatus\",             \"style\": \"compact\",             \"type\": \"Input.ChoiceSet\",             \"value\": \"Benign Positive - Suspicious But Expected\"         },         {             \"type\": \"TextBlock\",             \"text\": \"Change Azure Sentinel Incident Severity?\"         },         {             \"choices\": [                 {                                        \"title\": \"High\",                     \"value\": \"High\"                 },                 {                     \"title\": \"Medium\",                     \"value\": \"Medium\"                 },                 {                     \"title\": \"Low\",                     \"value\": \"Low\"                 },                 {                     \"title\": \"Don't change\",                     \"value\": \"same\"                 }             ],             \"id\": \"incidentSeverity\",             \"style\": \"compact\",             \"type\": \"Input.ChoiceSet\",             \"value\": \"@{triggerBody()?['object']?['properties']?['severity']}\"         }                            ], \"width\":\"auto\",    \"actions\": [                     {                         \"type\": \"Action.Submit\",                         \"title\": \"Change incident configuration\"                     },  {                         \"type\": \"Action.Submit\",                         \"title\": \"Ignore\"                     }    ],     \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",     \"version\": \"1.2\" }",
                    "recipient": {
                      "channelId": "19:7abc1180c1d84a3fba83770e34231132@thread.tacv2"
                    },
                    "shouldUpdateCard": true
                  },
                  "notificationUrl": "@{listCallbackUrl()}"
                },
                "host": {
                  "connection": {
                    "name": "@parameters('$connections')['teams']['connectionId']"
                  }
                },
                "path": "/flowbot/actions/flowcontinuation/recipienttypes/channel/$subscriptions",
                "queries": {
                  "groupId": "18de1100-ab2e-4505-be42-8263b915b221"
                }
              }
            }
          }
        },
        "parameters": {
          "$connections": {
            "value": {
              "FortinetConnector": {
                "connectionId": "[resourceId('Microsoft.Web/connections', variables('playbook5-FortinetConnectorConnectionName'))]",
                "connectionName": "[variables('playbook5-FortinetConnectorConnectionName')]",
                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/FortinetConnector')]"
              },
              "azuresentinel": {
                "connectionId": "[resourceId('Microsoft.Web/connections', variables('playbook5-AzureSentinelConnectionName'))]",
                "connectionName": "[variables('playbook5-AzureSentinelConnectionName')]",
                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('workspace-location'), '/managedApis/azuresentinel')]"
              },
              "teams": {
                "connectionId": "[resourceId('Microsoft.Web/connections', variables('playbook5-TeamsConnectionName'))]",
                "connectionName": "[variables('playbook5-TeamsConnectionName')]",
                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('workspace-location'), '/managedApis/teams')]"
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Web/connections",
      "apiVersion": "2018-07-01-preview",
      "name": "[variables('playbook6-FortinetConnectorConnectionName')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[resourceId('Microsoft.Web/customApis', variables('playbook1-FortinetConnectorname'))]"
      ],
      "properties": {
        "api": {
          "id": "[variables('_playbook-4-connection-1')]"
        }
      }
    },
    {
      "type": "Microsoft.Logic/workflows",
      "apiVersion": "2019-05-01",
      "name": "[parameters('playbook6-PlaybookName')]",
      "location": "[parameters('workspace-location')]",
      "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
          "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', variables('playbook6-UserIdentifier'))]": {}
        }
      },
      "dependsOn": [
        "[resourceId('Microsoft.Web/customApis', variables('playbook1-FortinetConnectorname'))]",
        "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', variables('playbook6-UserIdentifier'))]",
        "[resourceId('Microsoft.Web/connections', variables('playbook6-FortinetConnectorConnectionName'))]"
      ],
      "properties": {
        "state": "Enabled",
        "definition": {
          "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
          "contentVersion": "1.0.0.0",
          "parameters": {
            "$connections": {
              "type": "Object"
            },
            "PredefinedGroupName": {
              "defaultValue": "[parameters('playbook6-AddressGroup')]",
              "type": "String"
            }
          },
          "triggers": {
            "manual": {
              "type": "Request",
              "kind": "Http",
              "inputs": {
                "method": "POST",
                "schema": {
                  "properties": {
                    "IPs": {
                      "items": {
                        "properties": {
                          "Address": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "Address"
                        ],
                        "type": "object"
                      },
                      "type": "array"
                    }
                  },
                  "type": "object"
                }
              },
              "runtimeConfiguration": {
                "concurrency": {
                  "runs": 1
                }
              }
            }
          },
          "actions": {
            "Catch_Scope": {
              "actions": {
                "Create_HTML_table_for_error": {
                  "runAfter": {
                    "Filter_array": [
                      "Succeeded"
                    ]
                  },
                  "type": "Table",
                  "inputs": {
                    "columns": [
                      {
                        "header": "IP Address",
                        "value": "@item()['Address']"
                      },
                      {
                        "header": "Action Name",
                        "value": "@body('Filter_array')[0]?['name']"
                      },
                      {
                        "header": "Message",
                        "value": "@body('Filter_array')[0]?['outputs']?['body']?['error']?['message']"
                      }
                    ],
                    "format": "HTML",
                    "from": "@triggerBody()?['IPs']"
                  }
                },
                "Error_Response": {
                  "runAfter": {
                    "Create_HTML_table_for_error": [
                      "Succeeded"
                    ]
                  },
                  "type": "Response",
                  "kind": "Http",
                  "inputs": {
                    "body": "@{outputs('Compose_Image_to_add_the_incident')}Fortinet FortiGate Block IP Address Remidiation Playbook Error @{body('Create_HTML_table_for_error')}",
                    "statusCode": 500
                  },
                  "operationOptions": "Asynchronous"
                },
                "Filter_array": {
                  "type": "Query",
                  "inputs": {
                    "from": "@result('Try_Scope')",
                    "where": "@equals(item()?['status'], 'Failed')"
                  }
                }
              },
              "runAfter": {
                "Try_Scope": [
                  "Failed",
                  "Skipped",
                  "TimedOut"
                ]
              },
              "type": "Scope"
            },
            "Initialize_variable_IP_action": {
              "runAfter": {
                "Initialize_variable_address_group_members": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "IPAction",
                    "type": "object"
                  }
                ]
              },
              "description": "This holds the action taken on each IP"
            },
            "Initialize_variable_IP_address_action": {
              "runAfter": {
                "Initialize_variable_IP_action": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "IPAddressAction",
                    "type": "array"
                  }
                ]
              },
              "description": "This holds the action taken on each IP "
            },
            "Initialize_variable_action_name": {
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "ActionName",
                    "type": "string"
                  }
                ]
              },
              "description": " variable to store action name"
            },
            "Initialize_variable_address_group_members": {
              "runAfter": {
                "Initialize_variable_action_name": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "MemberCollection",
                    "type": "array"
                  }
                ]
              },
              "description": "Array variable to assign member collection of pre-defined address group"
            },
            "Try_Scope": {
              "actions": {
                "Compose_Image_to_add_the_incident": {
                  "runAfter": {
                    "Create_HTML_table_comment": [
                      "Succeeded"
                    ]
                  },
                  "type": "Compose",
                  "inputs": "<img src=\"https://yt3.ggpht.com/a-/AN66SAyqZAl4ouiyzA4Imk60EVe-ifOdHRfb4NUnoA=s900-mo-c-c0xffffffff-rj-k-no\", alt=\"Logo\" width=\"32\" height=\"32\" />",
                  "description": "Compose the Fortinet Logo"
                },
                "Create_HTML_table_comment": {
                  "runAfter": {
                    "For_each_malicious_IP": [
                      "Succeeded"
                    ]
                  },
                  "type": "Table",
                  "inputs": {
                    "columns": [
                      {
                        "header": "IP_Address",
                        "value": "@item()?['IPAddress']"
                      },
                      {
                        "header": "Action_Taken",
                        "value": "@item()?['Action']"
                      }
                    ],
                    "format": "HTML",
                    "from": "@variables('IPAddressAction')"
                  },
                  "description": "Construct HTML table for the comment"
                },
                "For_each_malicious_IP": {
                  "foreach": "@triggerBody()?['IPs']",
                  "actions": {
                    "Address_group_details": {
                      "runAfter": {
                        "Set_filter_for_address_group": [
                          "Succeeded"
                        ]
                      },
                      "type": "Function",
                      "inputs": {
                        "authentication": {
                          "audience": "[environment().resourceManager]",
                          "identity": "[variables('playbook6-UserIdentifier')]",
                          "type": "ManagedServiceIdentity"
                        },
                        "function": {
                          "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/sites/',variables('playbook6-Functionappname'),'/functions/Fortinet-GetEntityDetails')]"
                        },
                        "method": "GET",
                        "queries": {
                          "entity": "addrgrp",
                          "filter": "@{outputs('Set_filter_for_address_group')}"
                        }
                      },
                      "description": "This gets the address group details from fortinet"
                    },
                    "Append_to_variable_action_taken_on_IP_address": {
                      "runAfter": {
                        "Set_variable_IP_action": [
                          "Succeeded"
                        ]
                      },
                      "type": "AppendToArrayVariable",
                      "inputs": {
                        "name": "IPAddressAction",
                        "value": "@variables('IPAction')"
                      },
                      "description": "Append action taken and IP details to IPAddressAction"
                    },
                    "Check_address_object_is_already_exist_in_firewall": {
                      "runAfter": {
                        "Set_filter_for_address_object": [
                          "Succeeded"
                        ]
                      },
                      "type": "Function",
                      "inputs": {
                        "authentication": {
                          "audience": "[environment().resourceManager]",
                          "identity": "[variables('playbook6-UserIdentifier')]",
                          "type": "ManagedServiceIdentity"
                        },
                        "function": {
                          "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/sites/',variables('playbook6-Functionappname'),'/functions/Fortinet-GetEntityDetails')]"
                        },
                        "method": "GET",
                        "queries": {
                          "entity": "address",
                          "filter": "@{outputs('Set_filter_for_address_object')}"
                        }
                      },
                      "description": "Getting the address object details from firewall"
                    },
                    "Condition_to_check_if_Ip_address_already_present_in_list_of_address_objects": {
                      "actions": {
                        "Condition_to_check_if_Ip_already_present_in_predefined_address_group": {
                          "actions": {
                            "For_each_address_object": {
                              "foreach": "@body('Parse_JSON_for_address_object_dynamic_content')",
                              "actions": {
                                "Filter_array_address_objects_to_remove_from_address_group": {
                                  "type": "Query",
                                  "inputs": {
                                    "from": "@variables('memberCollection')",
                                    "where": "@not(equals(item()?['name'], items('For_each_address_object')['name']))"
                                  },
                                  "description": "This filter is used to remove address objects if already exist"
                                },
                                "Set_variable_address_group_members_in_unblock_case": {
                                  "runAfter": {
                                    "Filter_array_address_objects_to_remove_from_address_group": [
                                      "Succeeded"
                                    ]
                                  },
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "memberCollection",
                                    "value": "@body('Filter_array_address_objects_to_remove_from_address_group')"
                                  },
                                  "description": "This sets the address group members"
                                }
                              },
                              "runAfter": {
                                "Set_dynamic_action_name_variable_for_unblock": [
                                  "Succeeded"
                                ]
                              },
                              "type": "Foreach",
                              "description": "For each address object member"
                            },
                            "Set_dynamic_action_name_variable_for_unblock": {
                              "type": "SetVariable",
                              "inputs": {
                                "name": "ActionName",
                                "value": "Unblock IP"
                              },
                              "description": " variable to set action name dynamically"
                            }
                          },
                          "runAfter": {
                            "Filter_array_address_name_from_address_group": [
                              "Succeeded"
                            ]
                          },
                          "else": {
                            "actions": {
                              "For_each_address_object_member": {
                                "foreach": "@body('Parse_JSON_for_address_object_dynamic_content')",
                                "actions": {
                                  "Append_to_array_variable_address_object_group": {
                                    "type": "AppendToArrayVariable",
                                    "inputs": {
                                      "name": "memberCollection",
                                      "value": {
                                        "name": "@items('For_each_address_object_member')['name']",
                                        "q_origin_key": "@items('For_each_address_object_member')['name']"
                                      }
                                    },
                                    "description": "This appends address object members to existing members"
                                  }
                                },
                                "runAfter": {
                                  "Set_dynamic_action_name_variable_to_unblock": [
                                    "Succeeded"
                                  ]
                                },
                                "type": "Foreach"
                              },
                              "Set_dynamic_action_name_variable_to_unblock": {
                                "type": "SetVariable",
                                "inputs": {
                                  "name": "ActionName",
                                  "value": "Block IP"
                                },
                                "description": " variable to set action name dynamically"
                              }
                            }
                          },
                          "expression": {
                            "and": [
                              {
                                "greater": [
                                  "@length(body('Filter_array_address_name_from_address_group'))",
                                  0
                                ]
                              }
                            ]
                          },
                          "type": "If",
                          "description": "condition to check the malicious IP address is present in the predefined address group"
                        },
                        "Filter_array_address_name_from_address_group": {
                          "type": "Query",
                          "inputs": {
                            "from": "@body('Parse_JSON_for_address_group_dynamic_content')?[0]?['member']",
                            "where": "@equals(item()?['name'], body('Parse_JSON_for_address_object_dynamic_content')?[0]?['name'])"
                          },
                          "description": "This filters the address name of address object from address group"
                        }
                      },
                      "runAfter": {
                        "Set_variable_address_group_members": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Append_to_array_variable_for_new_address_object": {
                            "runAfter": {
                              "Create_an_address_object": [
                                "Succeeded"
                              ]
                            },
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "memberCollection",
                              "value": {
                                "name": "@body('Create_an_address_object')?['mkey']",
                                "q_origin_key": "@body('Create_an_address_object')?['mkey']"
                              }
                            },
                            "description": "This appends address object to array variable for new address object"
                          },
                          "Create_an_address_object": {
                            "runAfter": {
                              "For_each_new_IP": [
                                "Succeeded"
                              ]
                            },
                            "type": "ApiConnection",
                            "inputs": {
                              "body": {
                                "end-ip": "@items('For_each_malicious_IP')?['Address']",
                                "name": "Fortinet_@{items('For_each_malicious_IP')?['Address']}",
                                "start-ip": "@items('For_each_malicious_IP')?['Address']",
                                "type": "iprange"
                              },
                              "host": {
                                "connection": {
                                  "name": "@parameters('$connections')['FortinetConnector']['connectionId']"
                                }
                              },
                              "method": "post",
                              "path": "/api/v2/cmdb/firewall/address"
                            },
                            "description": "Create an address object to add an address in to firewall"
                          },
                          "For_each_new_IP": {
                            "foreach": "@body('Parse_JSON_for_address_object_dynamic_content')",
                            "actions": {
                              "Append_to_address_group_members_in_case_of_new_IP": {
                                "type": "AppendToArrayVariable",
                                "inputs": {
                                  "name": "memberCollection",
                                  "value": {
                                    "name": "@items('For_each_new_IP')['name']",
                                    "q_origin_key": "@items('For_each_new_IP')['name']"
                                  }
                                },
                                "description": "Appends address objects to existing object"
                              }
                            },
                            "runAfter": {
                              "Set_variable_address_group_members_in_case_of_new_address_object": [
                                "Succeeded"
                              ]
                            },
                            "type": "Foreach",
                            "description": "iterates on address object body for each new IP"
                          },
                          "Set_variable_action_name_to_block_Ip": {
                            "type": "SetVariable",
                            "inputs": {
                              "name": "ActionName",
                              "value": "Block IP"
                            },
                            "description": " This sets the variable block IP"
                          },
                          "Set_variable_address_group_members_in_case_of_new_address_object": {
                            "runAfter": {
                              "Set_variable_action_name_to_block_Ip": [
                                "Succeeded"
                              ]
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "memberCollection",
                              "value": "@body('Parse_JSON_for_address_group_dynamic_content')?[0]?['member']"
                            },
                            "description": "This sets address group members"
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(body('Parse_JSON_for_address_object_dynamic_content'))",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If",
                      "description": "This checks if Ip is a member of any of the list of address objects"
                    },
                    "Parse_JSON_for_address_group_dynamic_content": {
                      "runAfter": {
                        "Parse_address_group_JSON": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('Parse_address_group_JSON')",
                        "schema": {
                          "items": {
                            "properties": {
                              "allow-routing": {
                                "description": "allow-routing of  of an address group",
                                "type": "string"
                              },
                              "color": {
                                "description": "color of  of an address group",
                                "type": "integer"
                              },
                              "comment": {
                                "description": "comment of  of an address group",
                                "type": "string"
                              },
                              "exclude": {
                                "description": "exclude of  of an address group",
                                "type": "string"
                              },
                              "exclude-member": {
                                "type": "array"
                              },
                              "fabric-object": {
                                "description": "fabric-object of  of an address group",
                                "type": "string"
                              },
                              "member": {
                                "items": {
                                  "properties": {
                                    "name": {
                                      "description": "member name",
                                      "type": "string"
                                    },
                                    "q_origin_key": {
                                      "description": "member q_origin_key",
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name",
                                    "q_origin_key"
                                  ],
                                  "type": "object"
                                },
                                "type": "array"
                              },
                              "name": {
                                "description": "name of an address group",
                                "type": "string"
                              },
                              "q_origin_key": {
                                "description": "q_origin_key of an address group",
                                "type": "string"
                              },
                              "tagging": {
                                "description": "tagging of an address group",
                                "type": "array"
                              },
                              "type": {
                                "description": "type of an address group",
                                "type": "string"
                              },
                              "uuid": {
                                "description": "uuid of an address group",
                                "type": "string"
                              }
                            },
                            "required": [
                              "name",
                              "q_origin_key",
                              "type",
                              "uuid",
                              "member",
                              "comment",
                              "exclude",
                              "exclude-member",
                              "color",
                              "tagging",
                              "allow-routing",
                              "fabric-object"
                            ],
                            "type": "object"
                          },
                          "type": "array"
                        }
                      }
                    },
                    "Parse_JSON_for_address_object_dynamic_content": {
                      "runAfter": {
                        "Parse_address_object_JSON": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('Parse_address_object_JSON')",
                        "schema": {
                          "items": {
                            "properties": {
                              "allow-routing": {
                                "description": "Allow routing enabling and disabling",
                                "type": "string"
                              },
                              "associated-interface": {
                                "description": "Associated interface",
                                "type": "string"
                              },
                              "cache-ttl": {
                                "description": "cache-ttl of an address object",
                                "type": "integer"
                              },
                              "clearpass-spt": {
                                "description": "clearpass-spt of an address object",
                                "type": "string"
                              },
                              "color": {
                                "description": "color of an adddress object",
                                "type": "integer"
                              },
                              "comment": {
                                "description": "comment of an address object",
                                "type": "string"
                              },
                              "country": {
                                "description": "comment of an address object",
                                "type": "string"
                              },
                              "end-ip": {
                                "description": "end-ip of an address object",
                                "type": "string"
                              },
                              "end-mac": {
                                "description": "end-mac of an address object",
                                "type": "string"
                              },
                              "fabric-object": {
                                "description": "fabric-object of an address object",
                                "type": "string"
                              },
                              "filter": {
                                "description": "filter of an address object",
                                "type": "string"
                              },
                              "fsso-group": {
                                "description": "fsso of an address object",
                                "type": "array"
                              },
                              "interface": {
                                "description": "type of an address object",
                                "type": "string"
                              },
                              "list": {
                                "description": "List of an address object",
                                "type": "array"
                              },
                              "name": {
                                "description": "Name of an address object",
                                "type": "string"
                              },
                              "obj-id": {
                                "description": "obj-id of an address object",
                                "type": "string"
                              },
                              "obj-type": {
                                "description": "obj-type of an address object",
                                "type": "string"
                              },
                              "q_origin_key": {
                                "description": "q_origin_key of an address object",
                                "type": "string"
                              },
                              "sdn": {
                                "description": "sdn of an address object",
                                "type": "string"
                              },
                              "sdn-addr-type": {
                                "description": "sdn-addr-type of an address object",
                                "type": "string"
                              },
                              "start-ip": {
                                "description": "start-ip of an address object",
                                "type": "string"
                              },
                              "start-mac": {
                                "description": "start-mac of an address object",
                                "type": "string"
                              },
                              "sub-type": {
                                "description": "sub-type of an address object",
                                "type": "string"
                              },
                              "tagging": {
                                "description": "tagging of an address object",
                                "type": "array"
                              },
                              "type": {
                                "description": "type of an address object",
                                "type": "string"
                              },
                              "uuid": {
                                "description": "UUid of an address object",
                                "type": "string"
                              }
                            },
                            "required": [
                              "name",
                              "q_origin_key"
                            ],
                            "type": "object"
                          },
                          "type": "array"
                        }
                      },
                      "description": "Parse body content and create dynamic content"
                    },
                    "Parse_address_group_JSON": {
                      "runAfter": {
                        "Address_group_details": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('Address_group_details')",
                        "schema": {
                          "$schema": "http://json-schema.org/draft-04/schema#",
                          "items": [
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "exclude": {
                                  "type": "string"
                                },
                                "exclude-member": {
                                  "type": "array"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "member": {
                                  "items": [
                                    {
                                      "properties": {
                                        "name": {
                                          "type": "string"
                                        },
                                        "q_origin_key": {
                                          "type": "string"
                                        }
                                      },
                                      "required": [
                                        "name",
                                        "q_origin_key"
                                      ],
                                      "type": "object"
                                    },
                                    {
                                      "properties": {
                                        "name": {
                                          "type": "string"
                                        },
                                        "q_origin_key": {
                                          "type": "string"
                                        }
                                      },
                                      "required": [
                                        "name",
                                        "q_origin_key"
                                      ],
                                      "type": "object"
                                    },
                                    {
                                      "properties": {
                                        "name": {
                                          "type": "string"
                                        },
                                        "q_origin_key": {
                                          "type": "string"
                                        }
                                      },
                                      "required": [
                                        "name",
                                        "q_origin_key"
                                      ],
                                      "type": "object"
                                    },
                                    {
                                      "properties": {
                                        "name": {
                                          "type": "string"
                                        },
                                        "q_origin_key": {
                                          "type": "string"
                                        }
                                      },
                                      "required": [
                                        "name",
                                        "q_origin_key"
                                      ],
                                      "type": "object"
                                    }
                                  ],
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "type",
                                "uuid",
                                "member",
                                "comment",
                                "exclude",
                                "exclude-member",
                                "color",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            }
                          ],
                          "type": "array"
                        }
                      },
                      "description": "To parse the output of the function address group in to JSON"
                    },
                    "Parse_address_object_JSON": {
                      "runAfter": {
                        "Check_address_object_is_already_exist_in_firewall": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('Check_address_object_is_already_exist_in_firewall')",
                        "schema": {
                          "$schema": "http://json-schema.org/draft-04/schema#",
                          "items": [
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-ip": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-ip": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "start-ip",
                                "end-ip",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "subnet": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "subnet",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-tag": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-tag",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "subnet": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "subnet",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fqdn": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "fqdn",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "subnet": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "subnet",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "subnet": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "subnet",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "subnet": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "subnet",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-ip": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-ip": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "start-ip",
                                "end-ip",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-ip": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-ip": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "start-ip",
                                "end-ip",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-ip": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-ip": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "start-ip",
                                "end-ip",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-ip": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-ip": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "start-ip",
                                "end-ip",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-ip": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-ip": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "start-ip",
                                "end-ip",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fqdn": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "fqdn",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-ip": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-ip": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "start-ip",
                                "end-ip",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "subnet": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "subnet",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "subnet": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "subnet",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fqdn": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "fqdn",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fqdn": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "fqdn",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fqdn": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "fqdn",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fqdn": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "fqdn",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "subnet": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "subnet",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fqdn": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "fqdn",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            },
                            {
                              "properties": {
                                "allow-routing": {
                                  "type": "string"
                                },
                                "associated-interface": {
                                  "type": "string"
                                },
                                "cache-ttl": {
                                  "type": "integer"
                                },
                                "clearpass-spt": {
                                  "type": "string"
                                },
                                "color": {
                                  "type": "integer"
                                },
                                "comment": {
                                  "type": "string"
                                },
                                "country": {
                                  "type": "string"
                                },
                                "end-mac": {
                                  "type": "string"
                                },
                                "fabric-object": {
                                  "type": "string"
                                },
                                "filter": {
                                  "type": "string"
                                },
                                "fqdn": {
                                  "type": "string"
                                },
                                "fsso-group": {
                                  "type": "array"
                                },
                                "interface": {
                                  "type": "string"
                                },
                                "list": {
                                  "type": "array"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "obj-id": {
                                  "type": "string"
                                },
                                "obj-type": {
                                  "type": "string"
                                },
                                "q_origin_key": {
                                  "type": "string"
                                },
                                "sdn": {
                                  "type": "string"
                                },
                                "sdn-addr-type": {
                                  "type": "string"
                                },
                                "start-mac": {
                                  "type": "string"
                                },
                                "sub-type": {
                                  "type": "string"
                                },
                                "tagging": {
                                  "type": "array"
                                },
                                "type": {
                                  "type": "string"
                                },
                                "uuid": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "name",
                                "q_origin_key",
                                "uuid",
                                "type",
                                "sub-type",
                                "clearpass-spt",
                                "start-mac",
                                "end-mac",
                                "fqdn",
                                "country",
                                "cache-ttl",
                                "sdn",
                                "fsso-group",
                                "interface",
                                "obj-type",
                                "comment",
                                "associated-interface",
                                "color",
                                "filter",
                                "sdn-addr-type",
                                "obj-id",
                                "list",
                                "tagging",
                                "allow-routing",
                                "fabric-object"
                              ],
                              "type": "object"
                            }
                          ],
                          "type": "array"
                        }
                      },
                      "description": "To parse the output of the function address object in to JSON"
                    },
                    "Set_filter_for_address_group": {
                      "runAfter": {
                        "Parse_JSON_for_address_object_dynamic_content": [
                          "Succeeded"
                        ]
                      },
                      "type": "Compose",
                      "inputs": "filter=name=@{concat('@',parameters('playbook6-PredefinedGroupName'))}",
                      "description": " This sets the variable filter for address group azure function"
                    },
                    "Set_filter_for_address_object": {
                      "type": "Compose",
                      "inputs": "filter=start-ip=@{concat('@',items('For_each_malicious_IP')?['Address'])}",
                      "description": "This sets the variable filter for address object azure function"
                    },
                    "Set_variable_IP_action": {
                      "runAfter": {
                        "Update_address_group": [
                          "Succeeded"
                        ]
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "IPAction",
                        "value": {
                          "Action": " @{variables('ActionName')}",
                          "IPAddress": " @{items('For_each_malicious_IP')?['Address']} "
                        }
                      },
                      "description": "To store action item"
                    },
                    "Set_variable_address_group_members": {
                      "runAfter": {
                        "Parse_JSON_for_address_group_dynamic_content": [
                          "Succeeded"
                        ]
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "memberCollection",
                        "value": "@body('Parse_JSON_for_address_group_dynamic_content')?[0]?['member']"
                      },
                      "description": "assign list of address group members"
                    },
                    "Update_address_group": {
                      "runAfter": {
                        "Condition_to_check_if_Ip_address_already_present_in_list_of_address_objects": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "body": {
                          "member": "@variables('memberCollection')",
                          "name": "@parameters('playbook6-PredefinedGroupName')"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['FortinetConnector']['connectionId']"
                          }
                        },
                        "method": "put",
                        "path": "/api/v2/cmdb/firewall/addrgrp/@{encodeURIComponent(parameters('playbook6-PredefinedGroupName'))}"
                      }
                    }
                  },
                  "type": "Foreach",
                  "description": "For each IP which incident contains",
                  "runtimeConfiguration": {
                    "concurrency": {
                      "repetitions": 1
                    }
                  }
                },
                "Response": {
                  "runAfter": {
                    "Compose_Image_to_add_the_incident": [
                      "Succeeded"
                    ]
                  },
                  "type": "Response",
                  "kind": "Http",
                  "inputs": {
                    "body": "@{outputs('Compose_Image_to_add_the_incident')}Fortinet FortiGate Block IP Address Remidiation Playbook ran and performed the following actions: @{body('Create_HTML_table_comment')}",
                    "statusCode": 200
                  },
                  "operationOptions": "Asynchronous"
                }
              },
              "runAfter": {
                "Initialize_variable_IP_address_action": [
                  "Succeeded"
                ]
              },
              "type": "Scope"
            }
          }
        },
        "parameters": {
          "$connections": {
            "value": {
              "FortinetConnector": {
                "connectionId": "[resourceId('Microsoft.Web/connections', variables('playbook6-FortinetConnectorConnectionName'))]",
                "connectionName": "[variables('playbook6-FortinetConnectorConnectionName')]",
                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/',parameters('playbook6-ConnectorName'))]"
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2021-03-01-preview",
      "properties": {
        "version": "1.0.4",
        "kind": "Solution",
        "contentId": "[variables('_sourceId')]",
        "parentId": "[variables('_sourceId')]",
        "source": {
          "kind": "Solution",
          "name": "Fortinet FortiGate",
          "sourceId": "[variables('_sourceId')]"
        },
        "author": {
          "name": "Eli Forbes",
          "email": "v-eliforbes@microsoft.com"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "Playbook",
              "contentId": "[variables('_CustomConnector')]",
              "version": "1.0.4"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_FunctionApp')]",
              "version": "1.0.4"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_Fortinet_IncidentEnrichment')]",
              "version": "1.0.4"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_Fortinet_ResponseOnIP')]",
              "version": "1.0.4"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_Fortinet_ResponseOnURL')]",
              "version": "1.0.4"
            }
          ]
        },
        "firstPublishDate": "2021-08-13",
        "lastPublishDate": "2022-01-12",
        "providers": [
          "Fortinet"
        ],
        "categories": {
          "domains": [
            "Security - Automation (SOAR)"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_sourceId'))]"
    }

  ],
  "outputs": {}
}
